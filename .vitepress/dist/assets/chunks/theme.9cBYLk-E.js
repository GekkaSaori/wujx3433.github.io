const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunks/VPLocalSearchBox.DNhkFJ1r.js","assets/chunks/framework.B7LVFeGL.js"])))=>i.map(i=>d[i]);
var fv=Object.defineProperty;var mp=h=>{throw TypeError(h)};var pv=(h,e,t)=>e in h?fv(h,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):h[e]=t;var U=(h,e,t)=>pv(h,typeof e!="symbol"?e+"":e,t),hu=(h,e,t)=>e.has(h)||mp("Cannot "+t);var a=(h,e,t)=>(hu(h,e,"read from private field"),t?t.call(h):e.get(h)),b=(h,e,t)=>e.has(h)?mp("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(h):e.set(h,t),g=(h,e,t,s)=>(hu(h,e,"write to private field"),s?s.call(h,t):e.set(h,t),t),w=(h,e,t)=>(hu(h,e,"access private method"),t);var ce=(h,e,t,s)=>({set _(n){g(h,e,n,t)},get _(){return a(h,e,s)}});import{d as tt,c as O,r as _,n as Rt,o as I,a as Si,t as Tt,b as rt,w as $,T as zf,e as Y,_ as at,u as gv,i as mv,f as vv,g as Wf,h as dt,j as N,k as M,l as Na,m as Au,p as wt,q as Cn,s as Yd,v as Rn,x as Kd,y as Xf,z as yv,A as bv,F as Ut,B as Be,C as Va,D as Gp,E as Jd,G as st,H as xn,I as zp,J as Qd,K as Ar,L as Zd,M as Av,N as Wp,O as wu,P as Yf,Q as Xp,R as qd,S as wv,U as Sv,V as Ev,W as Yp,X as Kp,Y as Tv,Z as xv,$ as Cv,a0 as Pv,a1 as Iv,a2 as Rv,a3 as kv,a4 as vp}from"./framework.B7LVFeGL.js";const Mv=tt({__name:"VPBadge",props:{text:{},type:{default:"tip"}},setup(h){return(e,t)=>(I(),O("span",{class:Rt(["VPBadge",e.type])},[_(e.$slots,"default",{},()=>[Si(Tt(e.text),1)])],2))}}),Lv={key:0,class:"VPBackdrop"},Dv=tt({__name:"VPBackdrop",props:{show:{type:Boolean}},setup(h){return(e,t)=>(I(),rt(zf,{name:"fade"},{default:$(()=>[e.show?(I(),O("div",Lv)):Y("",!0)]),_:1}))}}),Ov=at(Dv,[["__scopeId","data-v-54a304ca"]]),yt=gv;function _v(h,e){let t,s=!1;return()=>{t&&clearTimeout(t),s?t=setTimeout(h,e):(h(),(s=!0)&&setTimeout(()=>s=!1,e))}}function Su(h){return h.startsWith("/")?h:`/${h}`}function Kf(h){const{pathname:e,search:t,hash:s,protocol:n}=new URL(h,"http://a.com");if(mv(h)||h.startsWith("#")||!n.startsWith("http")||!vv(e))return h;const{site:i}=yt(),r=e.endsWith("/")||e.endsWith(".html")?h:h.replace(/(?:(^\.+)\/)?.*$/,`$1${e.replace(/(\.md)?$/,i.value.cleanUrls?"":".html")}${t}${s}`);return Wf(r)}function Th({correspondingLink:h=!1}={}){const{site:e,localeIndex:t,page:s,theme:n,hash:i}=yt(),r=dt(()=>{var l,c;return{label:(l=e.value.locales[t.value])==null?void 0:l.label,link:((c=e.value.locales[t.value])==null?void 0:c.link)||(t.value==="root"?"/":`/${t.value}/`)}});return{localeLinks:dt(()=>Object.entries(e.value.locales).flatMap(([l,c])=>r.value.label===c.label?[]:{text:c.label,link:Nv(c.link||(l==="root"?"/":`/${l}/`),n.value.i18nRouting!==!1&&h,s.value.relativePath.slice(r.value.link.length-1),!e.value.cleanUrls)+i.value})),currentLang:r}}function Nv(h,e,t,s){return e?h.replace(/\/$/,"")+Su(t.replace(/(^|\/)index\.md$/,"$1").replace(/\.md$/,s?".html":"")):h}const Fv={class:"NotFound"},Bv={class:"code"},$v={class:"title"},Hv={class:"quote"},Vv={class:"action"},Uv=["href","aria-label"],jv=tt({__name:"NotFound",setup(h){const{theme:e}=yt(),{currentLang:t}=Th();return(s,n)=>{var i,r,o,l,c;return I(),O("div",Fv,[N("p",Bv,Tt(((i=M(e).notFound)==null?void 0:i.code)??"404"),1),N("h1",$v,Tt(((r=M(e).notFound)==null?void 0:r.title)??"PAGE NOT FOUND"),1),n[0]||(n[0]=N("div",{class:"divider"},null,-1)),N("blockquote",Hv,Tt(((o=M(e).notFound)==null?void 0:o.quote)??"But if you don't change your direction, and if you keep looking, you may end up where you are heading."),1),N("div",Vv,[N("a",{class:"link",href:M(Wf)(M(t).link),"aria-label":((l=M(e).notFound)==null?void 0:l.linkLabel)??"go to home"},Tt(((c=M(e).notFound)==null?void 0:c.linkText)??"Take me home"),9,Uv)])])}}}),Gv=at(jv,[["__scopeId","data-v-6ff51ddd"]]);function Jp(h,e){if(Array.isArray(h))return Hh(h);if(h==null)return[];e=Su(e);const t=Object.keys(h).sort((n,i)=>i.split("/").length-n.split("/").length).find(n=>e.startsWith(Su(n))),s=t?h[t]:[];return Array.isArray(s)?Hh(s):Hh(s.items,s.base)}function zv(h){const e=[];let t=0;for(const s in h){const n=h[s];if(n.items){t=e.push(n);continue}e[t]||e.push({items:[]}),e[t].items.push(n)}return e}function Wv(h){const e=[];function t(s){for(const n of s)n.text&&n.link&&e.push({text:n.text,link:n.link,docFooterText:n.docFooterText}),n.items&&t(n.items)}return t(h),e}function Eu(h,e){return Array.isArray(e)?e.some(t=>Eu(h,t)):Na(h,e.link)?!0:e.items?Eu(h,e.items):!1}function Hh(h,e){return[...h].map(t=>{const s={...t},n=s.base||e;return n&&s.link&&(s.link=n+s.link),s.items&&(s.items=Hh(s.items,n)),s})}function xi(){const{frontmatter:h,page:e,theme:t}=yt(),s=Au("(min-width: 960px)"),n=wt(!1),i=dt(()=>{const v=t.value.sidebar,y=e.value.relativePath;return v?Jp(v,y):[]}),r=wt(i.value);Cn(i,(v,y)=>{JSON.stringify(v)!==JSON.stringify(y)&&(r.value=i.value)});const o=dt(()=>h.value.sidebar!==!1&&r.value.length>0&&h.value.layout!=="home"),l=dt(()=>c?h.value.aside==null?t.value.aside==="left":h.value.aside==="left":!1),c=dt(()=>h.value.layout==="home"?!1:h.value.aside!=null?!!h.value.aside:t.value.aside!==!1),d=dt(()=>o.value&&s.value),u=dt(()=>o.value?zv(r.value):[]);function f(){n.value=!0}function p(){n.value=!1}function m(){n.value?p():f()}return{isOpen:n,sidebar:r,sidebarGroups:u,hasSidebar:o,hasAside:c,leftAside:l,isSidebarEnabled:d,open:f,close:p,toggle:m}}function Xv(h,e){let t;Yd(()=>{t=h.value?document.activeElement:void 0}),Rn(()=>{window.addEventListener("keyup",s)}),Kd(()=>{window.removeEventListener("keyup",s)});function s(n){n.key==="Escape"&&h.value&&(e(),t==null||t.focus())}}function Yv(h){const{page:e,hash:t}=yt(),s=wt(!1),n=dt(()=>h.value.collapsed!=null),i=dt(()=>!!h.value.link),r=wt(!1),o=()=>{r.value=Na(e.value.relativePath,h.value.link)};Cn([e,h,t],o),Rn(o);const l=dt(()=>r.value?!0:h.value.items?Eu(e.value.relativePath,h.value.items):!1),c=dt(()=>!!(h.value.items&&h.value.items.length));Yd(()=>{s.value=!!(n.value&&h.value.collapsed)}),Xf(()=>{(r.value||l.value)&&(s.value=!1)});function d(){n.value&&(s.value=!s.value)}return{collapsed:s,collapsible:n,isLink:i,isActiveLink:r,hasActiveLink:l,hasChildren:c,toggle:d}}function Kv(){const{hasSidebar:h}=xi(),e=Au("(min-width: 960px)"),t=Au("(min-width: 1280px)");return{isAsideEnabled:dt(()=>!t.value&&!e.value?!1:h.value?t.value:e.value)}}const Jv=/\b(?:VPBadge|header-anchor|footnote-ref|ignore-header)\b/,Tu=[];function Qp(h){return typeof h.outline=="object"&&!Array.isArray(h.outline)&&h.outline.label||h.outlineTitle||"On this page"}function Jf(h){const e=[...document.querySelectorAll(".VPDoc :where(h1,h2,h3,h4,h5,h6)")].filter(t=>t.id&&t.hasChildNodes()).map(t=>{const s=Number(t.tagName[1]);return{element:t,title:Qv(t),link:"#"+t.id,level:s}});return Zv(e,h)}function Qv(h){let e="";for(const t of h.childNodes)if(t.nodeType===1){if(Jv.test(t.className))continue;e+=t.textContent}else t.nodeType===3&&(e+=t.textContent);return e.trim()}function Zv(h,e){if(e===!1)return[];const t=(typeof e=="object"&&!Array.isArray(e)?e.level:e)||2,[s,n]=typeof t=="number"?[t,t]:t==="deep"?[2,6]:t;return ey(h,s,n)}function qv(h,e){const{isAsideEnabled:t}=Kv(),s=_v(i,100);let n=null;Rn(()=>{requestAnimationFrame(i),window.addEventListener("scroll",s)}),yv(()=>{r(location.hash)}),Kd(()=>{window.removeEventListener("scroll",s)});function i(){if(!t.value)return;const o=window.scrollY,l=window.innerHeight,c=document.body.offsetHeight,d=Math.abs(o+l-c)<1,u=Tu.map(({element:p,link:m})=>({link:m,top:ty(p)})).filter(({top:p})=>!Number.isNaN(p)).sort((p,m)=>p.top-m.top);if(!u.length){r(null);return}if(o<1){r(null);return}if(d){r(u[u.length-1].link);return}let f=null;for(const{link:p,top:m}of u){if(m>o+bv()+4)break;f=p}r(f)}function r(o){n&&n.classList.remove("active"),o==null?n=null:n=h.value.querySelector(`a[href="${decodeURIComponent(o)}"]`);const l=n;l?(l.classList.add("active"),e.value.style.top=l.offsetTop+39+"px",e.value.style.opacity="1"):(e.value.style.top="33px",e.value.style.opacity="0")}}function ty(h){let e=0;for(;h!==document.body;){if(h===null)return NaN;e+=h.offsetTop,h=h.offsetParent}return e}function ey(h,e,t){Tu.length=0;const s=[],n=[];return h.forEach(i=>{const r={...i,children:[]};let o=n[n.length-1];for(;o&&o.level>=r.level;)n.pop(),o=n[n.length-1];if(r.element.classList.contains("ignore-header")||o&&"shouldIgnore"in o){n.push({level:r.level,shouldIgnore:!0});return}r.level>t||r.level<e||(Tu.push({element:r.element,link:r.link}),o?o.children.push(r):s.push(r),n.push(r))}),s}const sy=["href","title"],ny=tt({__name:"VPDocOutlineItem",props:{headers:{},root:{type:Boolean}},setup(h){function e({target:t}){const s=t.href.split("#")[1],n=document.getElementById(decodeURIComponent(s));n==null||n.focus({preventScroll:!0})}return(t,s)=>{const n=Va("VPDocOutlineItem",!0);return I(),O("ul",{class:Rt(["VPDocOutlineItem",t.root?"root":"nested"])},[(I(!0),O(Ut,null,Be(t.headers,({children:i,link:r,title:o})=>(I(),O("li",null,[N("a",{class:"outline-link",href:r,onClick:e,title:o},Tt(o),9,sy),i!=null&&i.length?(I(),rt(n,{key:0,headers:i},null,8,["headers"])):Y("",!0)]))),256))],2)}}}),Zp=at(ny,[["__scopeId","data-v-53c99d69"]]),iy={class:"content"},ry={"aria-level":"2",class:"outline-title",id:"doc-outline-aria-label",role:"heading"},ay=tt({__name:"VPDocAsideOutline",setup(h){const{frontmatter:e,theme:t}=yt(),s=Gp([]);Jd(()=>{s.value=Jf(e.value.outline??t.value.outline)});const n=wt(),i=wt();return qv(n,i),(r,o)=>(I(),O("nav",{"aria-labelledby":"doc-outline-aria-label",class:Rt(["VPDocAsideOutline",{"has-outline":s.value.length>0}]),ref_key:"container",ref:n},[N("div",iy,[N("div",{class:"outline-marker",ref_key:"marker",ref:i},null,512),N("div",ry,Tt(M(Qp)(M(t))),1),st(Zp,{headers:s.value,root:!0},null,8,["headers"])])],2))}}),oy=at(ay,[["__scopeId","data-v-f610f197"]]),ly={class:"VPDocAsideCarbonAds"},cy=tt({__name:"VPDocAsideCarbonAds",props:{carbonAds:{}},setup(h){const e=()=>null;return(t,s)=>(I(),O("div",ly,[st(M(e),{"carbon-ads":t.carbonAds},null,8,["carbon-ads"])]))}}),hy={class:"VPDocAside"},dy=tt({__name:"VPDocAside",setup(h){const{theme:e}=yt();return(t,s)=>(I(),O("div",hy,[_(t.$slots,"aside-top",{},void 0,!0),_(t.$slots,"aside-outline-before",{},void 0,!0),st(oy),_(t.$slots,"aside-outline-after",{},void 0,!0),s[0]||(s[0]=N("div",{class:"spacer"},null,-1)),_(t.$slots,"aside-ads-before",{},void 0,!0),M(e).carbonAds?(I(),rt(cy,{key:0,"carbon-ads":M(e).carbonAds},null,8,["carbon-ads"])):Y("",!0),_(t.$slots,"aside-ads-after",{},void 0,!0),_(t.$slots,"aside-bottom",{},void 0,!0)]))}}),uy=at(dy,[["__scopeId","data-v-cb998dce"]]);function fy(){const{theme:h,page:e}=yt();return dt(()=>{const{text:t="Edit this page",pattern:s=""}=h.value.editLink||{};let n;return typeof s=="function"?n=s(e.value):n=s.replace(/:path/g,e.value.filePath),{url:n,text:t}})}function py(){const{page:h,theme:e,frontmatter:t}=yt();return dt(()=>{var c,d,u,f,p,m,v,y;const s=Jp(e.value.sidebar,h.value.relativePath),n=Wv(s),i=gy(n,A=>A.link.replace(/[?#].*$/,"")),r=i.findIndex(A=>Na(h.value.relativePath,A.link)),o=((c=e.value.docFooter)==null?void 0:c.prev)===!1&&!t.value.prev||t.value.prev===!1,l=((d=e.value.docFooter)==null?void 0:d.next)===!1&&!t.value.next||t.value.next===!1;return{prev:o?void 0:{text:(typeof t.value.prev=="string"?t.value.prev:typeof t.value.prev=="object"?t.value.prev.text:void 0)??((u=i[r-1])==null?void 0:u.docFooterText)??((f=i[r-1])==null?void 0:f.text),link:(typeof t.value.prev=="object"?t.value.prev.link:void 0)??((p=i[r-1])==null?void 0:p.link)},next:l?void 0:{text:(typeof t.value.next=="string"?t.value.next:typeof t.value.next=="object"?t.value.next.text:void 0)??((m=i[r+1])==null?void 0:m.docFooterText)??((v=i[r+1])==null?void 0:v.text),link:(typeof t.value.next=="object"?t.value.next.link:void 0)??((y=i[r+1])==null?void 0:y.link)}}})}function gy(h,e){const t=new Set;return h.filter(s=>{const n=e(s);return t.has(n)?!1:t.add(n)})}const Fs=tt({__name:"VPLink",props:{tag:{},href:{},noIcon:{type:Boolean},target:{},rel:{}},setup(h){const e=h,t=dt(()=>e.tag??(e.href?"a":"span")),s=dt(()=>e.href&&zp.test(e.href)||e.target==="_blank");return(n,i)=>(I(),rt(xn(t.value),{class:Rt(["VPLink",{link:n.href,"vp-external-link-icon":s.value,"no-icon":n.noIcon}]),href:n.href?M(Kf)(n.href):void 0,target:n.target??(s.value?"_blank":void 0),rel:n.rel??(s.value?"noreferrer":void 0)},{default:$(()=>[_(n.$slots,"default")]),_:3},8,["class","href","target","rel"]))}}),my={class:"VPLastUpdated"},vy=["datetime"],yy=tt({__name:"VPDocFooterLastUpdated",setup(h){const{theme:e,page:t,lang:s}=yt(),n=dt(()=>new Date(t.value.lastUpdated)),i=dt(()=>n.value.toISOString()),r=wt("");return Rn(()=>{Yd(()=>{var o,l,c;r.value=new Intl.DateTimeFormat((l=(o=e.value.lastUpdated)==null?void 0:o.formatOptions)!=null&&l.forceLocale?s.value:void 0,((c=e.value.lastUpdated)==null?void 0:c.formatOptions)??{dateStyle:"short",timeStyle:"short"}).format(n.value)})}),(o,l)=>{var c;return I(),O("p",my,[Si(Tt(((c=M(e).lastUpdated)==null?void 0:c.text)||M(e).lastUpdatedText||"Last updated")+": ",1),N("time",{datetime:i.value},Tt(r.value),9,vy)])}}}),by=at(yy,[["__scopeId","data-v-1bb0c8a8"]]),Ay={key:0,class:"VPDocFooter"},wy={key:0,class:"edit-info"},Sy={key:0,class:"edit-link"},Ey={key:1,class:"last-updated"},Ty={key:1,class:"prev-next","aria-labelledby":"doc-footer-aria-label"},xy={class:"pager"},Cy=["innerHTML"],Py=["innerHTML"],Iy={class:"pager"},Ry=["innerHTML"],ky=["innerHTML"],My=tt({__name:"VPDocFooter",setup(h){const{theme:e,page:t,frontmatter:s}=yt(),n=fy(),i=py(),r=dt(()=>e.value.editLink&&s.value.editLink!==!1),o=dt(()=>t.value.lastUpdated),l=dt(()=>r.value||o.value||i.value.prev||i.value.next);return(c,d)=>{var u,f,p,m;return l.value?(I(),O("footer",Ay,[_(c.$slots,"doc-footer-before",{},void 0,!0),r.value||o.value?(I(),O("div",wy,[r.value?(I(),O("div",Sy,[st(Fs,{class:"edit-link-button",href:M(n).url,"no-icon":!0},{default:$(()=>[d[0]||(d[0]=N("span",{class:"vpi-square-pen edit-link-icon"},null,-1)),Si(" "+Tt(M(n).text),1)]),_:1},8,["href"])])):Y("",!0),o.value?(I(),O("div",Ey,[st(by)])):Y("",!0)])):Y("",!0),(u=M(i).prev)!=null&&u.link||(f=M(i).next)!=null&&f.link?(I(),O("nav",Ty,[d[1]||(d[1]=N("span",{class:"visually-hidden",id:"doc-footer-aria-label"},"Pager",-1)),N("div",xy,[(p=M(i).prev)!=null&&p.link?(I(),rt(Fs,{key:0,class:"pager-link prev",href:M(i).prev.link},{default:$(()=>{var v;return[N("span",{class:"desc",innerHTML:((v=M(e).docFooter)==null?void 0:v.prev)||"Previous page"},null,8,Cy),N("span",{class:"title",innerHTML:M(i).prev.text},null,8,Py)]}),_:1},8,["href"])):Y("",!0)]),N("div",Iy,[(m=M(i).next)!=null&&m.link?(I(),rt(Fs,{key:0,class:"pager-link next",href:M(i).next.link},{default:$(()=>{var v;return[N("span",{class:"desc",innerHTML:((v=M(e).docFooter)==null?void 0:v.next)||"Next page"},null,8,Ry),N("span",{class:"title",innerHTML:M(i).next.text},null,8,ky)]}),_:1},8,["href"])):Y("",!0)])])):Y("",!0)])):Y("",!0)}}}),Ly=at(My,[["__scopeId","data-v-1bcd8184"]]),Dy={class:"container"},Oy={class:"aside-container"},_y={class:"aside-content"},Ny={class:"content"},Fy={class:"content-container"},By={class:"main"},$y=tt({__name:"VPDoc",setup(h){const{theme:e}=yt(),t=Qd(),{hasSidebar:s,hasAside:n,leftAside:i}=xi(),r=dt(()=>t.path.replace(/[./]+/g,"_").replace(/_html$/,""));return(o,l)=>{const c=Va("Content");return I(),O("div",{class:Rt(["VPDoc",{"has-sidebar":M(s),"has-aside":M(n)}])},[_(o.$slots,"doc-top",{},void 0,!0),N("div",Dy,[M(n)?(I(),O("div",{key:0,class:Rt(["aside",{"left-aside":M(i)}])},[l[0]||(l[0]=N("div",{class:"aside-curtain"},null,-1)),N("div",Oy,[N("div",_y,[st(uy,null,{"aside-top":$(()=>[_(o.$slots,"aside-top",{},void 0,!0)]),"aside-bottom":$(()=>[_(o.$slots,"aside-bottom",{},void 0,!0)]),"aside-outline-before":$(()=>[_(o.$slots,"aside-outline-before",{},void 0,!0)]),"aside-outline-after":$(()=>[_(o.$slots,"aside-outline-after",{},void 0,!0)]),"aside-ads-before":$(()=>[_(o.$slots,"aside-ads-before",{},void 0,!0)]),"aside-ads-after":$(()=>[_(o.$slots,"aside-ads-after",{},void 0,!0)]),_:3})])])],2)):Y("",!0),N("div",Ny,[N("div",Fy,[_(o.$slots,"doc-before",{},void 0,!0),N("main",By,[st(c,{class:Rt(["vp-doc",[r.value,M(e).externalLinkIcon&&"external-link-icon-enabled"]])},null,8,["class"])]),st(Ly,null,{"doc-footer-before":$(()=>[_(o.$slots,"doc-footer-before",{},void 0,!0)]),_:3}),_(o.$slots,"doc-after",{},void 0,!0)])])]),_(o.$slots,"doc-bottom",{},void 0,!0)],2)}}}),Hy=at($y,[["__scopeId","data-v-e6f2a212"]]),Vy=tt({__name:"VPButton",props:{tag:{},size:{default:"medium"},theme:{default:"brand"},text:{},href:{},target:{},rel:{}},setup(h){const e=h,t=dt(()=>e.href&&zp.test(e.href)),s=dt(()=>e.tag||(e.href?"a":"button"));return(n,i)=>(I(),rt(xn(s.value),{class:Rt(["VPButton",[n.size,n.theme]]),href:n.href?M(Kf)(n.href):void 0,target:e.target??(t.value?"_blank":void 0),rel:e.rel??(t.value?"noreferrer":void 0)},{default:$(()=>[Si(Tt(n.text),1)]),_:1},8,["class","href","target","rel"]))}}),Uy=at(Vy,[["__scopeId","data-v-93dc4167"]]),jy=["src","alt"],Gy=tt({inheritAttrs:!1,__name:"VPImage",props:{image:{},alt:{}},setup(h){return(e,t)=>{const s=Va("VPImage",!0);return e.image?(I(),O(Ut,{key:0},[typeof e.image=="string"||"src"in e.image?(I(),O("img",Ar({key:0,class:"VPImage"},typeof e.image=="string"?e.$attrs:{...e.image,...e.$attrs},{src:M(Wf)(typeof e.image=="string"?e.image:e.image.src),alt:e.alt??(typeof e.image=="string"?"":e.image.alt||"")}),null,16,jy)):(I(),O(Ut,{key:1},[st(s,Ar({class:"dark",image:e.image.dark,alt:e.image.alt},e.$attrs),null,16,["image","alt"]),st(s,Ar({class:"light",image:e.image.light,alt:e.image.alt},e.$attrs),null,16,["image","alt"])],64))],64)):Y("",!0)}}}),vd=at(Gy,[["__scopeId","data-v-ab19afbb"]]),zy={class:"container"},Wy={class:"main"},Xy={class:"heading"},Yy=["innerHTML"],Ky=["innerHTML"],Jy=["innerHTML"],Qy={key:0,class:"actions"},Zy={key:0,class:"image"},qy={class:"image-container"},tb=tt({__name:"VPHero",props:{name:{},text:{},tagline:{},image:{},actions:{}},setup(h){const e=Zd("hero-image-slot-exists");return(t,s)=>(I(),O("div",{class:Rt(["VPHero",{"has-image":t.image||M(e)}])},[N("div",zy,[N("div",Wy,[_(t.$slots,"home-hero-info-before",{},void 0,!0),_(t.$slots,"home-hero-info",{},()=>[N("h1",Xy,[t.name?(I(),O("span",{key:0,innerHTML:t.name,class:"name clip"},null,8,Yy)):Y("",!0),t.text?(I(),O("span",{key:1,innerHTML:t.text,class:"text"},null,8,Ky)):Y("",!0)]),t.tagline?(I(),O("p",{key:0,innerHTML:t.tagline,class:"tagline"},null,8,Jy)):Y("",!0)],!0),_(t.$slots,"home-hero-info-after",{},void 0,!0),t.actions?(I(),O("div",Qy,[(I(!0),O(Ut,null,Be(t.actions,n=>(I(),O("div",{key:n.link,class:"action"},[st(Uy,{tag:"a",size:"medium",theme:n.theme,text:n.text,href:n.link,target:n.target,rel:n.rel},null,8,["theme","text","href","target","rel"])]))),128))])):Y("",!0),_(t.$slots,"home-hero-actions-after",{},void 0,!0)]),t.image||M(e)?(I(),O("div",Zy,[N("div",qy,[s[0]||(s[0]=N("div",{class:"image-bg"},null,-1)),_(t.$slots,"home-hero-image",{},()=>[t.image?(I(),rt(vd,{key:0,class:"image-src",image:t.image},null,8,["image"])):Y("",!0)],!0)])])):Y("",!0)])],2))}}),eb=at(tb,[["__scopeId","data-v-dd8814ff"]]),sb=tt({__name:"VPHomeHero",setup(h){const{frontmatter:e}=yt();return(t,s)=>M(e).hero?(I(),rt(eb,{key:0,class:"VPHomeHero",name:M(e).hero.name,text:M(e).hero.text,tagline:M(e).hero.tagline,image:M(e).hero.image,actions:M(e).hero.actions},{"home-hero-info-before":$(()=>[_(t.$slots,"home-hero-info-before")]),"home-hero-info":$(()=>[_(t.$slots,"home-hero-info")]),"home-hero-info-after":$(()=>[_(t.$slots,"home-hero-info-after")]),"home-hero-actions-after":$(()=>[_(t.$slots,"home-hero-actions-after")]),"home-hero-image":$(()=>[_(t.$slots,"home-hero-image")]),_:3},8,["name","text","tagline","image","actions"])):Y("",!0)}}),nb={class:"box"},ib={key:0,class:"icon"},rb=["innerHTML"],ab=["innerHTML"],ob=["innerHTML"],lb={key:4,class:"link-text"},cb={class:"link-text-value"},hb=tt({__name:"VPFeature",props:{icon:{},title:{},details:{},link:{},linkText:{},rel:{},target:{}},setup(h){return(e,t)=>(I(),rt(Fs,{class:"VPFeature",href:e.link,rel:e.rel,target:e.target,"no-icon":!0,tag:e.link?"a":"div"},{default:$(()=>[N("article",nb,[typeof e.icon=="object"&&e.icon.wrap?(I(),O("div",ib,[st(vd,{image:e.icon,alt:e.icon.alt,height:e.icon.height||48,width:e.icon.width||48},null,8,["image","alt","height","width"])])):typeof e.icon=="object"?(I(),rt(vd,{key:1,image:e.icon,alt:e.icon.alt,height:e.icon.height||48,width:e.icon.width||48},null,8,["image","alt","height","width"])):e.icon?(I(),O("div",{key:2,class:"icon",innerHTML:e.icon},null,8,rb)):Y("",!0),N("h2",{class:"title",innerHTML:e.title},null,8,ab),e.details?(I(),O("p",{key:3,class:"details",innerHTML:e.details},null,8,ob)):Y("",!0),e.linkText?(I(),O("div",lb,[N("p",cb,[Si(Tt(e.linkText)+" ",1),t[0]||(t[0]=N("span",{class:"vpi-arrow-right link-text-icon"},null,-1))])])):Y("",!0)])]),_:1},8,["href","rel","target","tag"]))}}),db=at(hb,[["__scopeId","data-v-bd37d1a2"]]),ub={key:0,class:"VPFeatures"},fb={class:"container"},pb={class:"items"},gb=tt({__name:"VPFeatures",props:{features:{}},setup(h){const e=h,t=dt(()=>{const s=e.features.length;if(s){if(s===2)return"grid-2";if(s===3)return"grid-3";if(s%3===0)return"grid-6";if(s>3)return"grid-4"}else return});return(s,n)=>s.features?(I(),O("div",ub,[N("div",fb,[N("div",pb,[(I(!0),O(Ut,null,Be(s.features,i=>(I(),O("div",{key:i.title,class:Rt(["item",[t.value]])},[st(db,{icon:i.icon,title:i.title,details:i.details,link:i.link,"link-text":i.linkText,rel:i.rel,target:i.target},null,8,["icon","title","details","link","link-text","rel","target"])],2))),128))])])])):Y("",!0)}}),mb=at(gb,[["__scopeId","data-v-b1eea84a"]]),vb=tt({__name:"VPHomeFeatures",setup(h){const{frontmatter:e}=yt();return(t,s)=>M(e).features?(I(),rt(mb,{key:0,class:"VPHomeFeatures",features:M(e).features},null,8,["features"])):Y("",!0)}}),yb=tt({__name:"VPHomeContent",setup(h){const{width:e}=Av({initialWidth:0,includeScrollbar:!1});return(t,s)=>(I(),O("div",{class:"vp-doc container",style:Wp(M(e)?{"--vp-offset":`calc(50% - ${M(e)/2}px)`}:{})},[_(t.$slots,"default",{},void 0,!0)],4))}}),bb=at(yb,[["__scopeId","data-v-c141a4bd"]]),Ab=tt({__name:"VPHome",setup(h){const{frontmatter:e,theme:t}=yt();return(s,n)=>{const i=Va("Content");return I(),O("div",{class:Rt(["VPHome",{"external-link-icon-enabled":M(t).externalLinkIcon}])},[_(s.$slots,"home-hero-before",{},void 0,!0),st(sb,null,{"home-hero-info-before":$(()=>[_(s.$slots,"home-hero-info-before",{},void 0,!0)]),"home-hero-info":$(()=>[_(s.$slots,"home-hero-info",{},void 0,!0)]),"home-hero-info-after":$(()=>[_(s.$slots,"home-hero-info-after",{},void 0,!0)]),"home-hero-actions-after":$(()=>[_(s.$slots,"home-hero-actions-after",{},void 0,!0)]),"home-hero-image":$(()=>[_(s.$slots,"home-hero-image",{},void 0,!0)]),_:3}),_(s.$slots,"home-hero-after",{},void 0,!0),_(s.$slots,"home-features-before",{},void 0,!0),st(vb),_(s.$slots,"home-features-after",{},void 0,!0),M(e).markdownStyles!==!1?(I(),rt(bb,{key:0},{default:$(()=>[st(i)]),_:1})):(I(),rt(i,{key:1}))],2)}}}),wb=at(Ab,[["__scopeId","data-v-e07eaea7"]]),Sb={},Eb={class:"VPPage"};function Tb(h,e){const t=Va("Content");return I(),O("div",Eb,[_(h.$slots,"page-top"),st(t),_(h.$slots,"page-bottom")])}const xb=at(Sb,[["render",Tb]]),Cb=tt({__name:"VPContent",setup(h){const{page:e,frontmatter:t}=yt(),{hasSidebar:s}=xi();return(n,i)=>(I(),O("div",{class:Rt(["VPContent",{"has-sidebar":M(s),"is-home":M(t).layout==="home"}]),id:"VPContent"},[M(e).isNotFound?_(n.$slots,"not-found",{key:0},()=>[st(Gv)],!0):M(t).layout==="page"?(I(),rt(xb,{key:1},{"page-top":$(()=>[_(n.$slots,"page-top",{},void 0,!0)]),"page-bottom":$(()=>[_(n.$slots,"page-bottom",{},void 0,!0)]),_:3})):M(t).layout==="home"?(I(),rt(wb,{key:2},{"home-hero-before":$(()=>[_(n.$slots,"home-hero-before",{},void 0,!0)]),"home-hero-info-before":$(()=>[_(n.$slots,"home-hero-info-before",{},void 0,!0)]),"home-hero-info":$(()=>[_(n.$slots,"home-hero-info",{},void 0,!0)]),"home-hero-info-after":$(()=>[_(n.$slots,"home-hero-info-after",{},void 0,!0)]),"home-hero-actions-after":$(()=>[_(n.$slots,"home-hero-actions-after",{},void 0,!0)]),"home-hero-image":$(()=>[_(n.$slots,"home-hero-image",{},void 0,!0)]),"home-hero-after":$(()=>[_(n.$slots,"home-hero-after",{},void 0,!0)]),"home-features-before":$(()=>[_(n.$slots,"home-features-before",{},void 0,!0)]),"home-features-after":$(()=>[_(n.$slots,"home-features-after",{},void 0,!0)]),_:3})):M(t).layout&&M(t).layout!=="doc"?(I(),rt(xn(M(t).layout),{key:3})):(I(),rt(Hy,{key:4},{"doc-top":$(()=>[_(n.$slots,"doc-top",{},void 0,!0)]),"doc-bottom":$(()=>[_(n.$slots,"doc-bottom",{},void 0,!0)]),"doc-footer-before":$(()=>[_(n.$slots,"doc-footer-before",{},void 0,!0)]),"doc-before":$(()=>[_(n.$slots,"doc-before",{},void 0,!0)]),"doc-after":$(()=>[_(n.$slots,"doc-after",{},void 0,!0)]),"aside-top":$(()=>[_(n.$slots,"aside-top",{},void 0,!0)]),"aside-outline-before":$(()=>[_(n.$slots,"aside-outline-before",{},void 0,!0)]),"aside-outline-after":$(()=>[_(n.$slots,"aside-outline-after",{},void 0,!0)]),"aside-ads-before":$(()=>[_(n.$slots,"aside-ads-before",{},void 0,!0)]),"aside-ads-after":$(()=>[_(n.$slots,"aside-ads-after",{},void 0,!0)]),"aside-bottom":$(()=>[_(n.$slots,"aside-bottom",{},void 0,!0)]),_:3}))],2))}}),Pb=at(Cb,[["__scopeId","data-v-9a6c75ad"]]),Ib={class:"container"},Rb=["innerHTML"],kb=["innerHTML"],Mb=tt({__name:"VPFooter",setup(h){const{theme:e,frontmatter:t}=yt(),{hasSidebar:s}=xi();return(n,i)=>M(e).footer&&M(t).footer!==!1?(I(),O("footer",{key:0,class:Rt(["VPFooter",{"has-sidebar":M(s)}])},[N("div",Ib,[M(e).footer.message?(I(),O("p",{key:0,class:"message",innerHTML:M(e).footer.message},null,8,Rb)):Y("",!0),M(e).footer.copyright?(I(),O("p",{key:1,class:"copyright",innerHTML:M(e).footer.copyright},null,8,kb)):Y("",!0)])],2)):Y("",!0)}}),Lb=at(Mb,[["__scopeId","data-v-566314d4"]]);function Db(){const{theme:h,frontmatter:e}=yt(),t=Gp([]),s=dt(()=>t.value.length>0);return Jd(()=>{t.value=Jf(e.value.outline??h.value.outline)}),{headers:t,hasLocalNav:s}}const Ob={class:"menu-text"},_b={class:"header"},Nb={class:"outline"},Fb=tt({__name:"VPLocalNavOutlineDropdown",props:{headers:{},navHeight:{}},setup(h){const e=h,{theme:t}=yt(),s=wt(!1),n=wt(0),i=wt(),r=wt();function o(u){var f;(f=i.value)!=null&&f.contains(u.target)||(s.value=!1)}Cn(s,u=>{if(u){document.addEventListener("click",o);return}document.removeEventListener("click",o)}),wu("Escape",()=>{s.value=!1}),Jd(()=>{s.value=!1});function l(){s.value=!s.value,n.value=window.innerHeight+Math.min(window.scrollY-e.navHeight,0)}function c(u){u.target.classList.contains("outline-link")&&(r.value&&(r.value.style.transition="none"),Yf(()=>{s.value=!1}))}function d(){s.value=!1,window.scrollTo({top:0,left:0,behavior:"smooth"})}return(u,f)=>(I(),O("div",{class:"VPLocalNavOutlineDropdown",style:Wp({"--vp-vh":n.value+"px"}),ref_key:"main",ref:i},[u.headers.length>0?(I(),O("button",{key:0,onClick:l,class:Rt({open:s.value})},[N("span",Ob,Tt(M(Qp)(M(t))),1),f[0]||(f[0]=N("span",{class:"vpi-chevron-right icon"},null,-1))],2)):(I(),O("button",{key:1,onClick:d},Tt(M(t).returnToTopLabel||"Return to top"),1)),st(zf,{name:"flyout"},{default:$(()=>[s.value?(I(),O("div",{key:0,ref_key:"items",ref:r,class:"items",onClick:c},[N("div",_b,[N("a",{class:"top-link",href:"#",onClick:d},Tt(M(t).returnToTopLabel||"Return to top"),1)]),N("div",Nb,[st(Zp,{headers:u.headers},null,8,["headers"])])],512)):Y("",!0)]),_:1})],4))}}),Bb=at(Fb,[["__scopeId","data-v-6b867909"]]),$b={class:"container"},Hb=["aria-expanded"],Vb={class:"menu-text"},Ub=tt({__name:"VPLocalNav",props:{open:{type:Boolean}},emits:["open-menu"],setup(h){const{theme:e,frontmatter:t}=yt(),{hasSidebar:s}=xi(),{headers:n}=Db(),{y:i}=Xp(),r=wt(0);Rn(()=>{r.value=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--vp-nav-height"))}),Jd(()=>{n.value=Jf(t.value.outline??e.value.outline)});const o=dt(()=>n.value.length===0),l=dt(()=>o.value&&!s.value),c=dt(()=>({VPLocalNav:!0,"has-sidebar":s.value,empty:o.value,fixed:l.value}));return(d,u)=>M(t).layout!=="home"&&(!l.value||M(i)>=r.value)?(I(),O("div",{key:0,class:Rt(c.value)},[N("div",$b,[M(s)?(I(),O("button",{key:0,class:"menu","aria-expanded":d.open,"aria-controls":"VPSidebarNav",onClick:u[0]||(u[0]=f=>d.$emit("open-menu"))},[u[1]||(u[1]=N("span",{class:"vpi-align-left menu-icon"},null,-1)),N("span",Vb,Tt(M(e).sidebarMenuLabel||"Menu"),1)],8,Hb)):Y("",!0),st(Bb,{headers:M(n),navHeight:r.value},null,8,["headers","navHeight"])])],2)):Y("",!0)}}),jb=at(Ub,[["__scopeId","data-v-2488c25a"]]);function Gb(){const h=wt(!1);function e(){h.value=!0,window.addEventListener("resize",n)}function t(){h.value=!1,window.removeEventListener("resize",n)}function s(){h.value?t():e()}function n(){window.outerWidth>=768&&t()}const i=Qd();return Cn(()=>i.path,t),{isScreenOpen:h,openScreen:e,closeScreen:t,toggleScreen:s}}const zb={},Wb={class:"VPSwitch",type:"button",role:"switch"},Xb={class:"check"},Yb={key:0,class:"icon"};function Kb(h,e){return I(),O("button",Wb,[N("span",Xb,[h.$slots.default?(I(),O("span",Yb,[_(h.$slots,"default",{},void 0,!0)])):Y("",!0)])])}const Jb=at(zb,[["render",Kb],["__scopeId","data-v-b4ccac88"]]),Qb=tt({__name:"VPSwitchAppearance",setup(h){const{isDark:e,theme:t}=yt(),s=Zd("toggle-appearance",()=>{e.value=!e.value}),n=wt("");return Xf(()=>{n.value=e.value?t.value.lightModeSwitchTitle||"Switch to light theme":t.value.darkModeSwitchTitle||"Switch to dark theme"}),(i,r)=>(I(),rt(Jb,{title:n.value,class:"VPSwitchAppearance","aria-checked":M(e),onClick:M(s)},{default:$(()=>[...r[0]||(r[0]=[N("span",{class:"vpi-sun sun"},null,-1),N("span",{class:"vpi-moon moon"},null,-1)])]),_:1},8,["title","aria-checked","onClick"]))}}),Qf=at(Qb,[["__scopeId","data-v-be9742d9"]]),Zb={key:0,class:"VPNavBarAppearance"},qb=tt({__name:"VPNavBarAppearance",setup(h){const{site:e}=yt();return(t,s)=>M(e).appearance&&M(e).appearance!=="force-dark"&&M(e).appearance!=="force-auto"?(I(),O("div",Zb,[st(Qf)])):Y("",!0)}}),tA=at(qb,[["__scopeId","data-v-3f90c1a5"]]),Zf=wt();let qp=!1,du=0;function eA(h){const e=wt(!1);if(qd){!qp&&sA(),du++;const t=Cn(Zf,s=>{var n,i,r;s===h.el.value||(n=h.el.value)!=null&&n.contains(s)?(e.value=!0,(i=h.onFocus)==null||i.call(h)):(e.value=!1,(r=h.onBlur)==null||r.call(h))});Kd(()=>{t(),du--,du||nA()})}return wv(e)}function sA(){document.addEventListener("focusin",tg),qp=!0,Zf.value=document.activeElement}function nA(){document.removeEventListener("focusin",tg)}function tg(){Zf.value=document.activeElement}const iA={class:"VPMenuLink"},rA=["innerHTML"],aA=tt({__name:"VPMenuLink",props:{item:{}},setup(h){const{page:e}=yt();return(t,s)=>(I(),O("div",iA,[st(Fs,{class:Rt({active:M(Na)(M(e).relativePath,t.item.activeMatch||t.item.link,!!t.item.activeMatch)}),href:t.item.link,target:t.item.target,rel:t.item.rel,"no-icon":t.item.noIcon},{default:$(()=>[N("span",{innerHTML:t.item.text},null,8,rA)]),_:1},8,["class","href","target","rel","no-icon"])]))}}),tu=at(aA,[["__scopeId","data-v-7eeeb2dc"]]),oA={class:"VPMenuGroup"},lA={key:0,class:"title"},cA=tt({__name:"VPMenuGroup",props:{text:{},items:{}},setup(h){return(e,t)=>(I(),O("div",oA,[e.text?(I(),O("p",lA,Tt(e.text),1)):Y("",!0),(I(!0),O(Ut,null,Be(e.items,s=>(I(),O(Ut,null,["link"in s?(I(),rt(tu,{key:0,item:s},null,8,["item"])):Y("",!0)],64))),256))]))}}),hA=at(cA,[["__scopeId","data-v-a6b0397c"]]),dA={class:"VPMenu"},uA={key:0,class:"items"},fA=tt({__name:"VPMenu",props:{items:{}},setup(h){return(e,t)=>(I(),O("div",dA,[e.items?(I(),O("div",uA,[(I(!0),O(Ut,null,Be(e.items,s=>(I(),O(Ut,{key:JSON.stringify(s)},["link"in s?(I(),rt(tu,{key:0,item:s},null,8,["item"])):"component"in s?(I(),rt(xn(s.component),Ar({key:1,ref_for:!0},s.props),null,16)):(I(),rt(hA,{key:2,text:s.text,items:s.items},null,8,["text","items"]))],64))),128))])):Y("",!0),_(e.$slots,"default",{},void 0,!0)]))}}),pA=at(fA,[["__scopeId","data-v-20ed86d6"]]),gA=["aria-expanded","aria-label"],mA={key:0,class:"text"},vA=["innerHTML"],yA={key:1,class:"vpi-more-horizontal icon"},bA={class:"menu"},AA=tt({__name:"VPFlyout",props:{icon:{},button:{},label:{},items:{}},setup(h){const e=wt(!1),t=wt();eA({el:t,onBlur:s});function s(){e.value=!1}return(n,i)=>(I(),O("div",{class:"VPFlyout",ref_key:"el",ref:t,onMouseenter:i[1]||(i[1]=r=>e.value=!0),onMouseleave:i[2]||(i[2]=r=>e.value=!1)},[N("button",{type:"button",class:"button","aria-haspopup":"true","aria-expanded":e.value,"aria-label":n.label,onClick:i[0]||(i[0]=r=>e.value=!e.value)},[n.button||n.icon?(I(),O("span",mA,[n.icon?(I(),O("span",{key:0,class:Rt([n.icon,"option-icon"])},null,2)):Y("",!0),n.button?(I(),O("span",{key:1,innerHTML:n.button},null,8,vA)):Y("",!0),i[3]||(i[3]=N("span",{class:"vpi-chevron-down text-icon"},null,-1))])):(I(),O("span",yA))],8,gA),N("div",bA,[st(pA,{items:n.items},{default:$(()=>[_(n.$slots,"default",{},void 0,!0)]),_:3},8,["items"])])],544))}}),qf=at(AA,[["__scopeId","data-v-bfe7971f"]]),wA=["href","aria-label","innerHTML"],SA=tt({__name:"VPSocialLink",props:{icon:{},link:{},ariaLabel:{}},setup(h){const e=h,t=wt();Rn(async()=>{var i;await Yf();const n=(i=t.value)==null?void 0:i.children[0];n instanceof HTMLElement&&n.className.startsWith("vpi-social-")&&(getComputedStyle(n).maskImage||getComputedStyle(n).webkitMaskImage)==="none"&&n.style.setProperty("--icon",`url('https://api.iconify.design/simple-icons/${e.icon}.svg')`)});const s=dt(()=>typeof e.icon=="object"?e.icon.svg:`<span class="vpi-social-${e.icon}"></span>`);return(n,i)=>(I(),O("a",{ref_key:"el",ref:t,class:"VPSocialLink no-icon",href:n.link,"aria-label":n.ariaLabel??(typeof n.icon=="string"?n.icon:""),target:"_blank",rel:"noopener",innerHTML:s.value},null,8,wA))}}),EA=at(SA,[["__scopeId","data-v-60a9a2d3"]]),TA={class:"VPSocialLinks"},xA=tt({__name:"VPSocialLinks",props:{links:{}},setup(h){return(e,t)=>(I(),O("div",TA,[(I(!0),O(Ut,null,Be(e.links,({link:s,icon:n,ariaLabel:i})=>(I(),rt(EA,{key:s,icon:n,link:s,ariaLabel:i},null,8,["icon","link","ariaLabel"]))),128))]))}}),eu=at(xA,[["__scopeId","data-v-e71e869c"]]),CA={key:0,class:"group translations"},PA={class:"trans-title"},IA={key:1,class:"group"},RA={class:"item appearance"},kA={class:"label"},MA={class:"appearance-action"},LA={key:2,class:"group"},DA={class:"item social-links"},OA=tt({__name:"VPNavBarExtra",setup(h){const{site:e,theme:t}=yt(),{localeLinks:s,currentLang:n}=Th({correspondingLink:!0}),i=dt(()=>s.value.length&&n.value.label||e.value.appearance||t.value.socialLinks);return(r,o)=>i.value?(I(),rt(qf,{key:0,class:"VPNavBarExtra",label:"extra navigation"},{default:$(()=>[M(s).length&&M(n).label?(I(),O("div",CA,[N("p",PA,Tt(M(n).label),1),(I(!0),O(Ut,null,Be(M(s),l=>(I(),rt(tu,{key:l.link,item:l},null,8,["item"]))),128))])):Y("",!0),M(e).appearance&&M(e).appearance!=="force-dark"&&M(e).appearance!=="force-auto"?(I(),O("div",IA,[N("div",RA,[N("p",kA,Tt(M(t).darkModeSwitchLabel||"Appearance"),1),N("div",MA,[st(Qf)])])])):Y("",!0),M(t).socialLinks?(I(),O("div",LA,[N("div",DA,[st(eu,{class:"social-links-list",links:M(t).socialLinks},null,8,["links"])])])):Y("",!0)]),_:1})):Y("",!0)}}),_A=at(OA,[["__scopeId","data-v-f953d92f"]]),NA=["aria-expanded"],FA=tt({__name:"VPNavBarHamburger",props:{active:{type:Boolean}},emits:["click"],setup(h){return(e,t)=>(I(),O("button",{type:"button",class:Rt(["VPNavBarHamburger",{active:e.active}]),"aria-label":"mobile navigation","aria-expanded":e.active,"aria-controls":"VPNavScreen",onClick:t[0]||(t[0]=s=>e.$emit("click"))},[...t[1]||(t[1]=[N("span",{class:"container"},[N("span",{class:"top"}),N("span",{class:"middle"}),N("span",{class:"bottom"})],-1)])],10,NA))}}),BA=at(FA,[["__scopeId","data-v-6bee1efd"]]),$A=["innerHTML"],HA=tt({__name:"VPNavBarMenuLink",props:{item:{}},setup(h){const{page:e}=yt();return(t,s)=>(I(),rt(Fs,{class:Rt({VPNavBarMenuLink:!0,active:M(Na)(M(e).relativePath,t.item.activeMatch||t.item.link,!!t.item.activeMatch)}),href:t.item.link,target:t.item.target,rel:t.item.rel,"no-icon":t.item.noIcon,tabindex:"0"},{default:$(()=>[N("span",{innerHTML:t.item.text},null,8,$A)]),_:1},8,["class","href","target","rel","no-icon"]))}}),VA=at(HA,[["__scopeId","data-v-815115f5"]]),UA=tt({__name:"VPNavBarMenuGroup",props:{item:{}},setup(h){const e=h,{page:t}=yt(),s=i=>"component"in i?!1:"link"in i?Na(t.value.relativePath,i.link,!!e.item.activeMatch):i.items.some(s),n=dt(()=>s(e.item));return(i,r)=>(I(),rt(qf,{class:Rt({VPNavBarMenuGroup:!0,active:M(Na)(M(t).relativePath,i.item.activeMatch,!!i.item.activeMatch)||n.value}),button:i.item.text,items:i.item.items},null,8,["class","button","items"]))}}),jA={key:0,"aria-labelledby":"main-nav-aria-label",class:"VPNavBarMenu"},GA=tt({__name:"VPNavBarMenu",setup(h){const{theme:e}=yt();return(t,s)=>M(e).nav?(I(),O("nav",jA,[s[0]||(s[0]=N("span",{id:"main-nav-aria-label",class:"visually-hidden"}," Main Navigation ",-1)),(I(!0),O(Ut,null,Be(M(e).nav,n=>(I(),O(Ut,{key:JSON.stringify(n)},["link"in n?(I(),rt(VA,{key:0,item:n},null,8,["item"])):"component"in n?(I(),rt(xn(n.component),Ar({key:1,ref_for:!0},n.props),null,16)):(I(),rt(UA,{key:2,item:n},null,8,["item"]))],64))),128))])):Y("",!0)}}),zA=at(GA,[["__scopeId","data-v-afb2845e"]]);function WA(h){const{localeIndex:e,theme:t}=yt();function s(n){var m,v,y;const i=n.split("."),r=(m=t.value.search)==null?void 0:m.options,o=r&&typeof r=="object",l=o&&((y=(v=r.locales)==null?void 0:v[e.value])==null?void 0:y.translations)||null,c=o&&r.translations||null;let d=l,u=c,f=h;const p=i.pop();for(const A of i){let E=null;const S=f==null?void 0:f[A];S&&(E=f=S);const x=u==null?void 0:u[A];x&&(E=u=x);const T=d==null?void 0:d[A];T&&(E=d=T),S||(f=E),x||(u=E),T||(d=E)}return(d==null?void 0:d[p])??(u==null?void 0:u[p])??(f==null?void 0:f[p])??""}return s}const XA=["aria-label"],YA={class:"DocSearch-Button-Container"},KA={class:"DocSearch-Button-Placeholder"},yp=tt({__name:"VPNavBarSearchButton",setup(h){const t=WA({button:{buttonText:"Search",buttonAriaLabel:"Search"}});return(s,n)=>(I(),O("button",{type:"button",class:"DocSearch DocSearch-Button","aria-label":M(t)("button.buttonAriaLabel")},[N("span",YA,[n[0]||(n[0]=N("span",{class:"vp-icon DocSearch-Search-Icon"},null,-1)),N("span",KA,Tt(M(t)("button.buttonText")),1)]),n[1]||(n[1]=N("span",{class:"DocSearch-Button-Keys"},[N("kbd",{class:"DocSearch-Button-Key"}),N("kbd",{class:"DocSearch-Button-Key"},"K")],-1))],8,XA))}}),JA={class:"VPNavBarSearch"},QA={id:"local-search"},ZA={key:1,id:"docsearch"},qA=tt({__name:"VPNavBarSearch",setup(h){const e=Sv(()=>Ev(()=>import("./VPLocalSearchBox.DNhkFJ1r.js"),__vite__mapDeps([0,1]))),t=()=>null,{theme:s}=yt(),n=wt(!1),i=wt(!1);Rn(()=>{});function r(){n.value||(n.value=!0,setTimeout(o,16))}function o(){const u=new Event("keydown");u.key="k",u.metaKey=!0,window.dispatchEvent(u),setTimeout(()=>{document.querySelector(".DocSearch-Modal")||o()},16)}function l(u){const f=u.target,p=f.tagName;return f.isContentEditable||p==="INPUT"||p==="SELECT"||p==="TEXTAREA"}const c=wt(!1);wu("k",u=>{(u.ctrlKey||u.metaKey)&&(u.preventDefault(),c.value=!0)}),wu("/",u=>{l(u)||(u.preventDefault(),c.value=!0)});const d="local";return(u,f)=>{var p;return I(),O("div",JA,[M(d)==="local"?(I(),O(Ut,{key:0},[c.value?(I(),rt(M(e),{key:0,onClose:f[0]||(f[0]=m=>c.value=!1)})):Y("",!0),N("div",QA,[st(yp,{onClick:f[1]||(f[1]=m=>c.value=!0)})])],64)):M(d)==="algolia"?(I(),O(Ut,{key:1},[n.value?(I(),rt(M(t),{key:0,algolia:((p=M(s).search)==null?void 0:p.options)??M(s).algolia,onVnodeBeforeMount:f[2]||(f[2]=m=>i.value=!0)},null,8,["algolia"])):Y("",!0),i.value?Y("",!0):(I(),O("div",ZA,[st(yp,{onClick:r})]))],64)):Y("",!0)])}}}),t0=tt({__name:"VPNavBarSocialLinks",setup(h){const{theme:e}=yt();return(t,s)=>M(e).socialLinks?(I(),rt(eu,{key:0,class:"VPNavBarSocialLinks",links:M(e).socialLinks},null,8,["links"])):Y("",!0)}}),e0=at(t0,[["__scopeId","data-v-ef6192dc"]]),s0=["href","rel","target"],n0=["innerHTML"],i0={key:2},r0=tt({__name:"VPNavBarTitle",setup(h){const{site:e,theme:t}=yt(),{hasSidebar:s}=xi(),{currentLang:n}=Th(),i=dt(()=>{var l;return typeof t.value.logoLink=="string"?t.value.logoLink:(l=t.value.logoLink)==null?void 0:l.link}),r=dt(()=>{var l;return typeof t.value.logoLink=="string"||(l=t.value.logoLink)==null?void 0:l.rel}),o=dt(()=>{var l;return typeof t.value.logoLink=="string"||(l=t.value.logoLink)==null?void 0:l.target});return(l,c)=>(I(),O("div",{class:Rt(["VPNavBarTitle",{"has-sidebar":M(s)}])},[N("a",{class:"title",href:i.value??M(Kf)(M(n).link),rel:r.value,target:o.value},[_(l.$slots,"nav-bar-title-before",{},void 0,!0),M(t).logo?(I(),rt(vd,{key:0,class:"logo",image:M(t).logo},null,8,["image"])):Y("",!0),M(t).siteTitle?(I(),O("span",{key:1,innerHTML:M(t).siteTitle},null,8,n0)):M(t).siteTitle===void 0?(I(),O("span",i0,Tt(M(e).title),1)):Y("",!0),_(l.$slots,"nav-bar-title-after",{},void 0,!0)],8,s0)],2))}}),a0=at(r0,[["__scopeId","data-v-9f43907a"]]),o0={class:"items"},l0={class:"title"},c0=tt({__name:"VPNavBarTranslations",setup(h){const{theme:e}=yt(),{localeLinks:t,currentLang:s}=Th({correspondingLink:!0});return(n,i)=>M(t).length&&M(s).label?(I(),rt(qf,{key:0,class:"VPNavBarTranslations",icon:"vpi-languages",label:M(e).langMenuLabel||"Change language"},{default:$(()=>[N("div",o0,[N("p",l0,Tt(M(s).label),1),(I(!0),O(Ut,null,Be(M(t),r=>(I(),rt(tu,{key:r.link,item:r},null,8,["item"]))),128))])]),_:1},8,["label"])):Y("",!0)}}),h0=at(c0,[["__scopeId","data-v-acee064b"]]),d0={class:"wrapper"},u0={class:"container"},f0={class:"title"},p0={class:"content"},g0={class:"content-body"},m0=tt({__name:"VPNavBar",props:{isScreenOpen:{type:Boolean}},emits:["toggle-screen"],setup(h){const e=h,{y:t}=Xp(),{hasSidebar:s}=xi(),{frontmatter:n}=yt(),i=wt({});return Xf(()=>{i.value={"has-sidebar":s.value,home:n.value.layout==="home",top:t.value===0,"screen-open":e.isScreenOpen}}),(r,o)=>(I(),O("div",{class:Rt(["VPNavBar",i.value])},[N("div",d0,[N("div",u0,[N("div",f0,[st(a0,null,{"nav-bar-title-before":$(()=>[_(r.$slots,"nav-bar-title-before",{},void 0,!0)]),"nav-bar-title-after":$(()=>[_(r.$slots,"nav-bar-title-after",{},void 0,!0)]),_:3})]),N("div",p0,[N("div",g0,[_(r.$slots,"nav-bar-content-before",{},void 0,!0),st(qA,{class:"search"}),st(zA,{class:"menu"}),st(h0,{class:"translations"}),st(tA,{class:"appearance"}),st(e0,{class:"social-links"}),st(_A,{class:"extra"}),_(r.$slots,"nav-bar-content-after",{},void 0,!0),st(BA,{class:"hamburger",active:r.isScreenOpen,onClick:o[0]||(o[0]=l=>r.$emit("toggle-screen"))},null,8,["active"])])])])]),o[1]||(o[1]=N("div",{class:"divider"},[N("div",{class:"divider-line"})],-1))],2))}}),v0=at(m0,[["__scopeId","data-v-9fd4d1dd"]]),y0={key:0,class:"VPNavScreenAppearance"},b0={class:"text"},A0=tt({__name:"VPNavScreenAppearance",setup(h){const{site:e,theme:t}=yt();return(s,n)=>M(e).appearance&&M(e).appearance!=="force-dark"&&M(e).appearance!=="force-auto"?(I(),O("div",y0,[N("p",b0,Tt(M(t).darkModeSwitchLabel||"Appearance"),1),st(Qf)])):Y("",!0)}}),w0=at(A0,[["__scopeId","data-v-a3e2920d"]]),S0=["innerHTML"],E0=tt({__name:"VPNavScreenMenuLink",props:{item:{}},setup(h){const e=Zd("close-screen");return(t,s)=>(I(),rt(Fs,{class:"VPNavScreenMenuLink",href:t.item.link,target:t.item.target,rel:t.item.rel,"no-icon":t.item.noIcon,onClick:M(e)},{default:$(()=>[N("span",{innerHTML:t.item.text},null,8,S0)]),_:1},8,["href","target","rel","no-icon","onClick"]))}}),T0=at(E0,[["__scopeId","data-v-fa963d97"]]),x0=["innerHTML"],C0=tt({__name:"VPNavScreenMenuGroupLink",props:{item:{}},setup(h){const e=Zd("close-screen");return(t,s)=>(I(),rt(Fs,{class:"VPNavScreenMenuGroupLink",href:t.item.link,target:t.item.target,rel:t.item.rel,"no-icon":t.item.noIcon,onClick:M(e)},{default:$(()=>[N("span",{innerHTML:t.item.text},null,8,x0)]),_:1},8,["href","target","rel","no-icon","onClick"]))}}),eg=at(C0,[["__scopeId","data-v-e04f3e85"]]),P0={class:"VPNavScreenMenuGroupSection"},I0={key:0,class:"title"},R0=tt({__name:"VPNavScreenMenuGroupSection",props:{text:{},items:{}},setup(h){return(e,t)=>(I(),O("div",P0,[e.text?(I(),O("p",I0,Tt(e.text),1)):Y("",!0),(I(!0),O(Ut,null,Be(e.items,s=>(I(),rt(eg,{key:s.text,item:s},null,8,["item"]))),128))]))}}),k0=at(R0,[["__scopeId","data-v-f60dbfa7"]]),M0=["aria-controls","aria-expanded"],L0=["innerHTML"],D0=["id"],O0={key:0,class:"item"},_0={key:1,class:"item"},N0={key:2,class:"group"},F0=tt({__name:"VPNavScreenMenuGroup",props:{text:{},items:{}},setup(h){const e=h,t=wt(!1),s=dt(()=>`NavScreenGroup-${e.text.replace(" ","-").toLowerCase()}`);function n(){t.value=!t.value}return(i,r)=>(I(),O("div",{class:Rt(["VPNavScreenMenuGroup",{open:t.value}])},[N("button",{class:"button","aria-controls":s.value,"aria-expanded":t.value,onClick:n},[N("span",{class:"button-text",innerHTML:i.text},null,8,L0),r[0]||(r[0]=N("span",{class:"vpi-plus button-icon"},null,-1))],8,M0),N("div",{id:s.value,class:"items"},[(I(!0),O(Ut,null,Be(i.items,o=>(I(),O(Ut,{key:JSON.stringify(o)},["link"in o?(I(),O("div",O0,[st(eg,{item:o},null,8,["item"])])):"component"in o?(I(),O("div",_0,[(I(),rt(xn(o.component),Ar({ref_for:!0},o.props,{"screen-menu":""}),null,16))])):(I(),O("div",N0,[st(k0,{text:o.text,items:o.items},null,8,["text","items"])]))],64))),128))],8,D0)],2))}}),B0=at(F0,[["__scopeId","data-v-d99bfeec"]]),$0={key:0,class:"VPNavScreenMenu"},H0=tt({__name:"VPNavScreenMenu",setup(h){const{theme:e}=yt();return(t,s)=>M(e).nav?(I(),O("nav",$0,[(I(!0),O(Ut,null,Be(M(e).nav,n=>(I(),O(Ut,{key:JSON.stringify(n)},["link"in n?(I(),rt(T0,{key:0,item:n},null,8,["item"])):"component"in n?(I(),rt(xn(n.component),Ar({key:1,ref_for:!0},n.props,{"screen-menu":""}),null,16)):(I(),rt(B0,{key:2,text:n.text||"",items:n.items},null,8,["text","items"]))],64))),128))])):Y("",!0)}}),V0=tt({__name:"VPNavScreenSocialLinks",setup(h){const{theme:e}=yt();return(t,s)=>M(e).socialLinks?(I(),rt(eu,{key:0,class:"VPNavScreenSocialLinks",links:M(e).socialLinks},null,8,["links"])):Y("",!0)}}),U0={class:"list"},j0=tt({__name:"VPNavScreenTranslations",setup(h){const{localeLinks:e,currentLang:t}=Th({correspondingLink:!0}),s=wt(!1);function n(){s.value=!s.value}return(i,r)=>M(e).length&&M(t).label?(I(),O("div",{key:0,class:Rt(["VPNavScreenTranslations",{open:s.value}])},[N("button",{class:"title",onClick:n},[r[0]||(r[0]=N("span",{class:"vpi-languages icon lang"},null,-1)),Si(" "+Tt(M(t).label)+" ",1),r[1]||(r[1]=N("span",{class:"vpi-chevron-down icon chevron"},null,-1))]),N("ul",U0,[(I(!0),O(Ut,null,Be(M(e),o=>(I(),O("li",{key:o.link,class:"item"},[st(Fs,{class:"link",href:o.link},{default:$(()=>[Si(Tt(o.text),1)]),_:2},1032,["href"])]))),128))])],2)):Y("",!0)}}),G0=at(j0,[["__scopeId","data-v-516e4bc3"]]),z0={class:"container"},W0=tt({__name:"VPNavScreen",props:{open:{type:Boolean}},setup(h){const e=wt(null),t=Yp(qd?document.body:null);return(s,n)=>(I(),rt(zf,{name:"fade",onEnter:n[0]||(n[0]=i=>t.value=!0),onAfterLeave:n[1]||(n[1]=i=>t.value=!1)},{default:$(()=>[s.open?(I(),O("div",{key:0,class:"VPNavScreen",ref_key:"screen",ref:e,id:"VPNavScreen"},[N("div",z0,[_(s.$slots,"nav-screen-content-before",{},void 0,!0),st(H0,{class:"menu"}),st(G0,{class:"translations"}),st(w0,{class:"appearance"}),st(V0,{class:"social-links"}),_(s.$slots,"nav-screen-content-after",{},void 0,!0)])],512)):Y("",!0)]),_:3}))}}),X0=at(W0,[["__scopeId","data-v-2dd6d0c7"]]),Y0={key:0,class:"VPNav"},K0=tt({__name:"VPNav",setup(h){const{isScreenOpen:e,closeScreen:t,toggleScreen:s}=Gb(),{frontmatter:n}=yt(),i=dt(()=>n.value.navbar!==!1);return Kp("close-screen",t),Yd(()=>{qd&&document.documentElement.classList.toggle("hide-nav",!i.value)}),(r,o)=>i.value?(I(),O("header",Y0,[st(v0,{"is-screen-open":M(e),onToggleScreen:M(s)},{"nav-bar-title-before":$(()=>[_(r.$slots,"nav-bar-title-before",{},void 0,!0)]),"nav-bar-title-after":$(()=>[_(r.$slots,"nav-bar-title-after",{},void 0,!0)]),"nav-bar-content-before":$(()=>[_(r.$slots,"nav-bar-content-before",{},void 0,!0)]),"nav-bar-content-after":$(()=>[_(r.$slots,"nav-bar-content-after",{},void 0,!0)]),_:3},8,["is-screen-open","onToggleScreen"]),st(X0,{open:M(e)},{"nav-screen-content-before":$(()=>[_(r.$slots,"nav-screen-content-before",{},void 0,!0)]),"nav-screen-content-after":$(()=>[_(r.$slots,"nav-screen-content-after",{},void 0,!0)]),_:3},8,["open"])])):Y("",!0)}}),J0=at(K0,[["__scopeId","data-v-7ad780c2"]]),Q0=["role","tabindex"],Z0={key:1,class:"items"},q0=tt({__name:"VPSidebarItem",props:{item:{},depth:{}},setup(h){const e=h,{collapsed:t,collapsible:s,isLink:n,isActiveLink:i,hasActiveLink:r,hasChildren:o,toggle:l}=Yv(dt(()=>e.item)),c=dt(()=>o.value?"section":"div"),d=dt(()=>n.value?"a":"div"),u=dt(()=>o.value?e.depth+2===7?"p":`h${e.depth+2}`:"p"),f=dt(()=>n.value?void 0:"button"),p=dt(()=>[[`level-${e.depth}`],{collapsible:s.value},{collapsed:t.value},{"is-link":n.value},{"is-active":i.value},{"has-active":r.value}]);function m(y){"key"in y&&y.key!=="Enter"||!e.item.link&&l()}function v(){e.item.link&&l()}return(y,A)=>{const E=Va("VPSidebarItem",!0);return I(),rt(xn(c.value),{class:Rt(["VPSidebarItem",p.value])},{default:$(()=>[y.item.text?(I(),O("div",Ar({key:0,class:"item",role:f.value},Tv(y.item.items?{click:m,keydown:m}:{},!0),{tabindex:y.item.items&&0}),[A[1]||(A[1]=N("div",{class:"indicator"},null,-1)),y.item.link?(I(),rt(Fs,{key:0,tag:d.value,class:"link",href:y.item.link,rel:y.item.rel,target:y.item.target},{default:$(()=>[(I(),rt(xn(u.value),{class:"text",innerHTML:y.item.text},null,8,["innerHTML"]))]),_:1},8,["tag","href","rel","target"])):(I(),rt(xn(u.value),{key:1,class:"text",innerHTML:y.item.text},null,8,["innerHTML"])),y.item.collapsed!=null&&y.item.items&&y.item.items.length?(I(),O("div",{key:2,class:"caret",role:"button","aria-label":"toggle section",onClick:v,onKeydown:xv(v,["enter"]),tabindex:"0"},[...A[0]||(A[0]=[N("span",{class:"vpi-chevron-right caret-icon"},null,-1)])],32)):Y("",!0)],16,Q0)):Y("",!0),y.item.items&&y.item.items.length?(I(),O("div",Z0,[y.depth<5?(I(!0),O(Ut,{key:0},Be(y.item.items,S=>(I(),rt(E,{key:S.text,item:S,depth:y.depth+1},null,8,["item","depth"]))),128)):Y("",!0)])):Y("",!0)]),_:1},8,["class"])}}}),tw=at(q0,[["__scopeId","data-v-0009425e"]]),ew=tt({__name:"VPSidebarGroup",props:{items:{}},setup(h){const e=wt(!0);let t=null;return Rn(()=>{t=setTimeout(()=>{t=null,e.value=!1},300)}),Cv(()=>{t!=null&&(clearTimeout(t),t=null)}),(s,n)=>(I(!0),O(Ut,null,Be(s.items,i=>(I(),O("div",{key:i.text,class:Rt(["group",{"no-transition":e.value}])},[st(tw,{item:i,depth:0},null,8,["item"])],2))),128))}}),sw=at(ew,[["__scopeId","data-v-51288d80"]]),nw={class:"nav",id:"VPSidebarNav","aria-labelledby":"sidebar-aria-label",tabindex:"-1"},iw=tt({__name:"VPSidebar",props:{open:{type:Boolean}},setup(h){const{sidebarGroups:e,hasSidebar:t}=xi(),s=h,n=wt(null),i=Yp(qd?document.body:null);Cn([s,n],()=>{var o;s.open?(i.value=!0,(o=n.value)==null||o.focus()):i.value=!1},{immediate:!0,flush:"post"});const r=wt(0);return Cn(e,()=>{r.value+=1},{deep:!0}),(o,l)=>M(t)?(I(),O("aside",{key:0,class:Rt(["VPSidebar",{open:o.open}]),ref_key:"navEl",ref:n,onClick:l[0]||(l[0]=Pv(()=>{},["stop"]))},[l[2]||(l[2]=N("div",{class:"curtain"},null,-1)),N("nav",nw,[l[1]||(l[1]=N("span",{class:"visually-hidden",id:"sidebar-aria-label"}," Sidebar Navigation ",-1)),_(o.$slots,"sidebar-nav-before",{},void 0,!0),(I(),rt(sw,{items:M(e),key:r.value},null,8,["items"])),_(o.$slots,"sidebar-nav-after",{},void 0,!0)])],2)):Y("",!0)}}),rw=at(iw,[["__scopeId","data-v-42c4c606"]]),aw=tt({__name:"VPSkipLink",setup(h){const{theme:e}=yt(),t=Qd(),s=wt();Cn(()=>t.path,()=>s.value.focus());function n({target:i}){const r=document.getElementById(decodeURIComponent(i.hash).slice(1));if(r){const o=()=>{r.removeAttribute("tabindex"),r.removeEventListener("blur",o)};r.setAttribute("tabindex","-1"),r.addEventListener("blur",o),r.focus(),window.scrollTo(0,0)}}return(i,r)=>(I(),O(Ut,null,[N("span",{ref_key:"backToTop",ref:s,tabindex:"-1"},null,512),N("a",{href:"#VPContent",class:"VPSkipLink visually-hidden",onClick:n},Tt(M(e).skipToContentLabel||"Skip to content"),1)],64))}}),ow=at(aw,[["__scopeId","data-v-fcbfc0e0"]]),lw=tt({__name:"Layout",setup(h){const{isOpen:e,open:t,close:s}=xi(),n=Qd();Cn(()=>n.path,s),Xv(e,s);const{frontmatter:i}=yt(),r=Iv(),o=dt(()=>!!r["home-hero-image"]);return Kp("hero-image-slot-exists",o),(l,c)=>{const d=Va("Content");return M(i).layout!==!1?(I(),O("div",{key:0,class:Rt(["Layout",M(i).pageClass])},[_(l.$slots,"layout-top",{},void 0,!0),st(ow),st(Ov,{class:"backdrop",show:M(e),onClick:M(s)},null,8,["show","onClick"]),st(J0,null,{"nav-bar-title-before":$(()=>[_(l.$slots,"nav-bar-title-before",{},void 0,!0)]),"nav-bar-title-after":$(()=>[_(l.$slots,"nav-bar-title-after",{},void 0,!0)]),"nav-bar-content-before":$(()=>[_(l.$slots,"nav-bar-content-before",{},void 0,!0)]),"nav-bar-content-after":$(()=>[_(l.$slots,"nav-bar-content-after",{},void 0,!0)]),"nav-screen-content-before":$(()=>[_(l.$slots,"nav-screen-content-before",{},void 0,!0)]),"nav-screen-content-after":$(()=>[_(l.$slots,"nav-screen-content-after",{},void 0,!0)]),_:3}),st(jb,{open:M(e),onOpenMenu:M(t)},null,8,["open","onOpenMenu"]),st(rw,{open:M(e)},{"sidebar-nav-before":$(()=>[_(l.$slots,"sidebar-nav-before",{},void 0,!0)]),"sidebar-nav-after":$(()=>[_(l.$slots,"sidebar-nav-after",{},void 0,!0)]),_:3},8,["open"]),st(Pb,null,{"page-top":$(()=>[_(l.$slots,"page-top",{},void 0,!0)]),"page-bottom":$(()=>[_(l.$slots,"page-bottom",{},void 0,!0)]),"not-found":$(()=>[_(l.$slots,"not-found",{},void 0,!0)]),"home-hero-before":$(()=>[_(l.$slots,"home-hero-before",{},void 0,!0)]),"home-hero-info-before":$(()=>[_(l.$slots,"home-hero-info-before",{},void 0,!0)]),"home-hero-info":$(()=>[_(l.$slots,"home-hero-info",{},void 0,!0)]),"home-hero-info-after":$(()=>[_(l.$slots,"home-hero-info-after",{},void 0,!0)]),"home-hero-actions-after":$(()=>[_(l.$slots,"home-hero-actions-after",{},void 0,!0)]),"home-hero-image":$(()=>[_(l.$slots,"home-hero-image",{},void 0,!0)]),"home-hero-after":$(()=>[_(l.$slots,"home-hero-after",{},void 0,!0)]),"home-features-before":$(()=>[_(l.$slots,"home-features-before",{},void 0,!0)]),"home-features-after":$(()=>[_(l.$slots,"home-features-after",{},void 0,!0)]),"doc-footer-before":$(()=>[_(l.$slots,"doc-footer-before",{},void 0,!0)]),"doc-before":$(()=>[_(l.$slots,"doc-before",{},void 0,!0)]),"doc-after":$(()=>[_(l.$slots,"doc-after",{},void 0,!0)]),"doc-top":$(()=>[_(l.$slots,"doc-top",{},void 0,!0)]),"doc-bottom":$(()=>[_(l.$slots,"doc-bottom",{},void 0,!0)]),"aside-top":$(()=>[_(l.$slots,"aside-top",{},void 0,!0)]),"aside-bottom":$(()=>[_(l.$slots,"aside-bottom",{},void 0,!0)]),"aside-outline-before":$(()=>[_(l.$slots,"aside-outline-before",{},void 0,!0)]),"aside-outline-after":$(()=>[_(l.$slots,"aside-outline-after",{},void 0,!0)]),"aside-ads-before":$(()=>[_(l.$slots,"aside-ads-before",{},void 0,!0)]),"aside-ads-after":$(()=>[_(l.$slots,"aside-ads-after",{},void 0,!0)]),_:3}),st(Lb),_(l.$slots,"layout-bottom",{},void 0,!0)],2)):(I(),rt(d,{key:1}))}}}),cw=at(lw,[["__scopeId","data-v-d8b57b2d"]]),hw={class:"profile"},dw={class:"avatar"},uw=["src","alt"],fw={class:"data"},pw={class:"name"},gw={key:0,class:"affiliation"},mw={key:0,class:"title"},vw={key:1,class:"at"},yw=["innerHTML"],bw={key:2,class:"links"},Aw={key:0,class:"sp"},ww=tt({__name:"VPTeamMembersItem",props:{size:{default:"medium"},member:{}},setup(h){return(e,t)=>(I(),O("article",{class:Rt(["VPTeamMembersItem",[e.size]])},[N("div",hw,[N("figure",dw,[N("img",{class:"avatar-img",src:e.member.avatar,alt:e.member.name},null,8,uw)]),N("div",fw,[N("h1",pw,Tt(e.member.name),1),e.member.title||e.member.org?(I(),O("p",gw,[e.member.title?(I(),O("span",mw,Tt(e.member.title),1)):Y("",!0),e.member.title&&e.member.org?(I(),O("span",vw," @ ")):Y("",!0),e.member.org?(I(),rt(Fs,{key:2,class:Rt(["org",{link:e.member.orgLink}]),href:e.member.orgLink,"no-icon":""},{default:$(()=>[Si(Tt(e.member.org),1)]),_:1},8,["class","href"])):Y("",!0)])):Y("",!0),e.member.desc?(I(),O("p",{key:1,class:"desc",innerHTML:e.member.desc},null,8,yw)):Y("",!0),e.member.links?(I(),O("div",bw,[st(eu,{links:e.member.links},null,8,["links"])])):Y("",!0)])]),e.member.sponsor?(I(),O("div",Aw,[st(Fs,{class:"sp-link",href:e.member.sponsor,"no-icon":""},{default:$(()=>[t[0]||(t[0]=N("span",{class:"vpi-heart sp-icon"},null,-1)),Si(" "+Tt(e.member.actionText||"Sponsor"),1)]),_:1},8,["href"])])):Y("",!0)],2))}}),Sw=at(ww,[["__scopeId","data-v-acff304e"]]),Ew={class:"container"},Tw=tt({__name:"VPTeamMembers",props:{size:{default:"medium"},members:{}},setup(h){const e=h,t=dt(()=>[e.size,`count-${e.members.length}`]);return(s,n)=>(I(),O("div",{class:Rt(["VPTeamMembers",t.value])},[N("div",Ew,[(I(!0),O(Ut,null,Be(s.members,i=>(I(),O("div",{key:i.name,class:"item"},[st(Sw,{size:s.size,member:i},null,8,["size","member"])]))),128))])],2))}}),RE=at(Tw,[["__scopeId","data-v-bf782009"]]),bp={Layout:cw,enhanceApp:({app:h})=>{h.component("Badge",Mv)}},xw={__name:"BackToTop",setup(h){const e=wt(!1),t=()=>{e.value=window.scrollY>300};Rn(()=>{window.addEventListener("scroll",t)}),Kd(()=>{window.removeEventListener("scroll",t)});const s=()=>{window.scrollTo({top:0,behavior:"smooth"})};return(n,i)=>Rv((I(),O("button",{onClick:s,class:"back-to-top"}," ⬆ 回到顶部 ",512)),[[kv,e.value]])}},Cw=at(xw,[["__scopeId","data-v-e8347ad8"]]);var Pw={34:(h,e,t)=>{var s=t(4901);h.exports=function(n){return typeof n=="object"?n!==null:s(n)}},81:(h,e,t)=>{var s=t(9565),n=t(9306),i=t(8551),r=t(6823),o=t(851),l=TypeError;h.exports=function(c,d){var u=arguments.length<2?o(c):d;if(n(u))return i(s(u,c));throw new l(r(c)+" is not iterable")}},116:(h,e,t)=>{var s=t(6518),n=t(9565),i=t(2652),r=t(9306),o=t(8551),l=t(1767),c=t(9539),d=t(4549),u=d("find",TypeError);s({target:"Iterator",proto:!0,real:!0,forced:u},{find:function(p){o(this);try{r(p)}catch(y){c(this,"throw",y)}if(u)return n(u,this,p);var m=l(this),v=0;return i(m,function(y,A){if(p(y,v++))return A(y)},{IS_RECORD:!0,INTERRUPTED:!0}).result}})},283:(h,e,t)=>{var s=t(9504),n=t(9039),i=t(4901),r=t(9297),o=t(3724),l=t(350).CONFIGURABLE,c=t(3706),d=t(1181),u=d.enforce,f=d.get,p=String,m=Object.defineProperty,v=s("".slice),y=s("".replace),A=s([].join),E=o&&!n(function(){return m(function(){},"length",{value:8}).length!==8}),S=String(String).split("String"),x=h.exports=function(T,C,P){v(p(C),0,7)==="Symbol("&&(C="["+y(p(C),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),P&&P.getter&&(C="get "+C),P&&P.setter&&(C="set "+C),(!r(T,"name")||l&&T.name!==C)&&(o?m(T,"name",{value:C,configurable:!0}):T.name=C),E&&P&&r(P,"arity")&&T.length!==P.arity&&m(T,"length",{value:P.arity});try{P&&r(P,"constructor")&&P.constructor?o&&m(T,"prototype",{writable:!1}):T.prototype&&(T.prototype=void 0)}catch{}var k=u(T);return r(k,"source")||(k.source=A(S,typeof C=="string"?C:"")),T};Function.prototype.toString=x(function(){return i(this)&&f(this).source||c(this)},"toString")},350:(h,e,t)=>{var s=t(3724),n=t(9297),i=Function.prototype,r=s&&Object.getOwnPropertyDescriptor,o=n(i,"name"),l=o&&(function(){}).name==="something",c=o&&(!s||s&&r(i,"name").configurable);h.exports={EXISTS:o,PROPER:l,CONFIGURABLE:c}},397:(h,e,t)=>{var s=t(7751);h.exports=s("document","documentElement")},421:h=>{h.exports={}},456:(h,e,t)=>{var s=t(6518),n=t(4576),i=t(9504),r=t(4154),o=t(5169),l=i(1.1.toString),c=n.Uint8Array,d=!c||!c.prototype.toHex||!function(){try{var u=new c([255,255,255,255,255,255,255,255]);return u.toHex()==="ffffffffffffffff"}catch{return!1}}();c&&s({target:"Uint8Array",proto:!0,forced:d},{toHex:function(){r(this),o(this.buffer);for(var f="",p=0,m=this.length;p<m;p++){var v=l(this[p],16);f+=v.length===1?"0"+v:v}return f}})},507:(h,e,t)=>{var s=t(9565);h.exports=function(n,i,r){for(var o=r?n:n.iterator,l=n.next,c,d;!(c=s(l,o)).done;)if(d=i(c.value),d!==void 0)return d}},531:(h,e,t)=>{var s=t(6518),n=t(9565),i=t(9306),r=t(8551),o=t(1767),l=t(8646),c=t(9462),d=t(9539),u=t(6395),f=t(684),p=t(4549),m=!u&&!f("flatMap",function(){}),v=!u&&!m&&p("flatMap",TypeError),y=u||m||v,A=c(function(){for(var E=this.iterator,S=this.mapper,x,T;;){if(T=this.inner)try{if(x=r(n(T.next,T.iterator)),!x.done)return x.value;this.inner=null}catch(C){d(E,"throw",C)}if(x=r(n(this.next,E)),this.done=!!x.done)return;try{this.inner=l(S(x.value,this.counter++),!1)}catch(C){d(E,"throw",C)}}});s({target:"Iterator",proto:!0,real:!0,forced:y},{flatMap:function(S){r(this);try{i(S)}catch(x){d(this,"throw",x)}return v?n(v,this,S):new A(o(this),{mapper:S,inner:null})}})},616:(h,e,t)=>{var s=t(9039);h.exports=!s(function(){var n=(function(){}).bind();return typeof n!="function"||n.hasOwnProperty("prototype")})},655:(h,e,t)=>{var s=t(6955),n=String;h.exports=function(i){if(s(i)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return n(i)}},679:(h,e,t)=>{var s=t(1625),n=TypeError;h.exports=function(i,r){if(s(r,i))return i;throw new n("Incorrect invocation")}},684:h=>{h.exports=function(e,t){var s=typeof Iterator=="function"&&Iterator.prototype[e];if(s)try{s.call({next:null},t).next()}catch{return!0}}},741:h=>{var e=Math.ceil,t=Math.floor;h.exports=Math.trunc||function(n){var i=+n;return(i>0?t:e)(i)}},757:(h,e,t)=>{var s=t(7751),n=t(4901),i=t(1625),r=t(7040),o=Object;h.exports=r?function(l){return typeof l=="symbol"}:function(l){var c=s("Symbol");return n(c)&&i(c.prototype,o(l))}},851:(h,e,t)=>{var s=t(6955),n=t(5966),i=t(4117),r=t(6269),o=t(8227),l=o("iterator");h.exports=function(c){if(!i(c))return n(c,l)||n(c,"@@iterator")||r[s(c)]}},944:h=>{var e=TypeError;h.exports=function(t){var s=t&&t.alphabet;if(s===void 0||s==="base64"||s==="base64url")return s||"base64";throw new e("Incorrect `alphabet` option")}},1072:(h,e,t)=>{var s=t(1828),n=t(8727);h.exports=Object.keys||function(r){return s(r,n)}},1103:h=>{h.exports=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}}},1108:(h,e,t)=>{var s=t(6955);h.exports=function(n){var i=s(n);return i==="BigInt64Array"||i==="BigUint64Array"}},1148:(h,e,t)=>{var s=t(6518),n=t(9565),i=t(2652),r=t(9306),o=t(8551),l=t(1767),c=t(9539),d=t(4549),u=d("every",TypeError);s({target:"Iterator",proto:!0,real:!0,forced:u},{every:function(p){o(this);try{r(p)}catch(y){c(this,"throw",y)}if(u)return n(u,this,p);var m=l(this),v=0;return!i(m,function(y,A){if(!p(y,v++))return A()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},1181:(h,e,t)=>{var s=t(8622),n=t(4576),i=t(34),r=t(6699),o=t(9297),l=t(7629),c=t(6119),d=t(421),u="Object already initialized",f=n.TypeError,p=n.WeakMap,m,v,y,A=function(T){return y(T)?v(T):m(T,{})},E=function(T){return function(C){var P;if(!i(C)||(P=v(C)).type!==T)throw new f("Incompatible receiver, "+T+" required");return P}};if(s||l.state){var S=l.state||(l.state=new p);S.get=S.get,S.has=S.has,S.set=S.set,m=function(T,C){if(S.has(T))throw new f(u);return C.facade=T,S.set(T,C),C},v=function(T){return S.get(T)||{}},y=function(T){return S.has(T)}}else{var x=c("state");d[x]=!0,m=function(T,C){if(o(T,x))throw new f(u);return C.facade=T,r(T,x,C),C},v=function(T){return o(T,x)?T[x]:{}},y=function(T){return o(T,x)}}h.exports={set:m,get:v,has:y,enforce:A,getterFor:E}},1291:(h,e,t)=>{var s=t(741);h.exports=function(n){var i=+n;return i!==i||i===0?0:s(i)}},1385:(h,e,t)=>{var s=t(9539);h.exports=function(n,i,r){for(var o=n.length-1;o>=0;o--)if(n[o]!==void 0)try{r=s(n[o].iterator,i,r)}catch(l){i="throw",r=l}if(i==="throw")throw r;return r}},1548:(h,e,t)=>{var s=t(4576),n=t(9039),i=t(9519),r=t(4215),o=s.structuredClone;h.exports=!!o&&!n(function(){if(r==="DENO"&&i>92||r==="NODE"&&i>94||r==="BROWSER"&&i>97)return!1;var l=new ArrayBuffer(8),c=o(l,{transfer:[l]});return l.byteLength!==0||c.byteLength!==8})},1549:(h,e,t)=>{t(6632)},1625:(h,e,t)=>{var s=t(9504);h.exports=s({}.isPrototypeOf)},1689:(h,e,t)=>{var s=t(6518),n=t(4576),i=t(8745),r=t(7680),o=t(6043),l=t(9306),c=t(1103),d=n.Promise,u=!1,f=!d||!d.try||c(function(){d.try(function(p){u=p===8},8)}).error||!u;s({target:"Promise",stat:!0,forced:f},{try:function(p){var m=arguments.length>1?r(arguments,1):[],v=o.f(this),y=c(function(){return i(l(p),void 0,m)});return(y.error?v.reject:v.resolve)(y.value),v.promise}})},1698:(h,e,t)=>{var s=t(6518),n=t(4204),i=t(9835),r=t(4916),o=!r("union")||!i("union");s({target:"Set",proto:!0,real:!0,forced:o},{union:n})},1701:(h,e,t)=>{var s=t(6518),n=t(9565),i=t(9306),r=t(8551),o=t(1767),l=t(9462),c=t(6319),d=t(9539),u=t(684),f=t(4549),p=t(6395),m=!p&&!u("map",function(){}),v=!p&&!m&&f("map",TypeError),y=p||m||v,A=l(function(){var E=this.iterator,S=r(n(this.next,E)),x=this.done=!!S.done;if(!x)return c(E,this.mapper,[S.value,this.counter++],!0)});s({target:"Iterator",proto:!0,real:!0,forced:y},{map:function(S){r(this);try{i(S)}catch(x){d(this,"throw",x)}return v?n(v,this,S):new A(o(this),{mapper:S})}})},1767:h=>{h.exports=function(e){return{iterator:e,next:e.next,done:!1}}},1828:(h,e,t)=>{var s=t(9504),n=t(9297),i=t(5397),r=t(9617).indexOf,o=t(421),l=s([].push);h.exports=function(c,d){var u=i(c),f=0,p=[],m;for(m in u)!n(o,m)&&n(u,m)&&l(p,m);for(;d.length>f;)n(u,m=d[f++])&&(~r(p,m)||l(p,m));return p}},2106:(h,e,t)=>{var s=t(283),n=t(4913);h.exports=function(i,r,o){return o.get&&s(o.get,r,{getter:!0}),o.set&&s(o.set,r,{setter:!0}),n.f(i,r,o)}},2140:(h,e,t)=>{var s=t(8227),n=s("toStringTag"),i={};i[n]="z",h.exports=String(i)==="[object z]"},2195:(h,e,t)=>{var s=t(9504),n=s({}.toString),i=s("".slice);h.exports=function(r){return i(n(r),8,-1)}},2211:(h,e,t)=>{var s=t(9039);h.exports=!s(function(){function n(){}return n.prototype.constructor=null,Object.getPrototypeOf(new n)!==n.prototype})},2303:(h,e,t)=>{var s=t(4576),n=t(9504),i=s.Uint8Array,r=s.SyntaxError,o=s.parseInt,l=Math.min,c=/[^\da-f]/i,d=n(c.exec),u=n("".slice);h.exports=function(f,p){var m=f.length;if(m%2!==0)throw new r("String should be an even number of characters");for(var v=p?l(p.length,m/2):m/2,y=p||new i(v),A=0,E=0;E<v;){var S=u(f,A,A+=2);if(d(c,S))throw new r("String should only contain hex characters");y[E++]=o(S,16)}return{bytes:y,read:A}}},2360:(h,e,t)=>{var s=t(8551),n=t(6801),i=t(8727),r=t(421),o=t(397),l=t(4055),c=t(6119),d=">",u="<",f="prototype",p="script",m=c("IE_PROTO"),v=function(){},y=function(T){return u+p+d+T+u+"/"+p+d},A=function(T){T.write(y("")),T.close();var C=T.parentWindow.Object;return T=null,C},E=function(){var T=l("iframe"),C="java"+p+":",P;return T.style.display="none",o.appendChild(T),T.src=String(C),P=T.contentWindow.document,P.open(),P.write(y("document.F=Object")),P.close(),P.F},S,x=function(){try{S=new ActiveXObject("htmlfile")}catch{}x=typeof document<"u"?document.domain&&S?A(S):E():A(S);for(var T=i.length;T--;)delete x[f][i[T]];return x()};r[m]=!0,h.exports=Object.create||function(C,P){var k;return C!==null?(v[f]=s(C),k=new v,v[f]=null,k[m]=C):k=x(),P===void 0?k:n.f(k,P)}},2475:(h,e,t)=>{var s=t(6518),n=t(8527),i=t(4916),r=!i("isSupersetOf",function(o){return!o});s({target:"Set",proto:!0,real:!0,forced:r},{isSupersetOf:n})},2489:(h,e,t)=>{var s=t(6518),n=t(9565),i=t(9306),r=t(8551),o=t(1767),l=t(9462),c=t(6319),d=t(6395),u=t(9539),f=t(684),p=t(4549),m=!d&&!f("filter",function(){}),v=!d&&!m&&p("filter",TypeError),y=d||m||v,A=l(function(){for(var E=this.iterator,S=this.predicate,x=this.next,T,C,P;;){if(T=r(n(x,E)),C=this.done=!!T.done,C)return;if(P=T.value,c(E,S,[P,this.counter++],!0))return P}});s({target:"Iterator",proto:!0,real:!0,forced:y},{filter:function(S){r(this);try{i(S)}catch(x){u(this,"throw",x)}return v?n(v,this,S):new A(o(this),{predicate:S})}})},2529:h=>{h.exports=function(e,t){return{value:e,done:t}}},2603:(h,e,t)=>{var s=t(655);h.exports=function(n,i){return n===void 0?arguments.length<2?"":i:s(n)}},2652:(h,e,t)=>{var s=t(6080),n=t(9565),i=t(8551),r=t(6823),o=t(4209),l=t(6198),c=t(1625),d=t(81),u=t(851),f=t(9539),p=TypeError,m=function(y,A){this.stopped=y,this.result=A},v=m.prototype;h.exports=function(y,A,E){var S=E&&E.that,x=!!(E&&E.AS_ENTRIES),T=!!(E&&E.IS_RECORD),C=!!(E&&E.IS_ITERATOR),P=!!(E&&E.INTERRUPTED),k=s(A,S),R,L,D,H,V,G,q,j=function(nt){return R&&f(R,"normal"),new m(!0,nt)},F=function(nt){return x?(i(nt),P?k(nt[0],nt[1],j):k(nt[0],nt[1])):P?k(nt,j):k(nt)};if(T)R=y.iterator;else if(C)R=y;else{if(L=u(y),!L)throw new p(r(y)+" is not iterable");if(o(L)){for(D=0,H=l(y);H>D;D++)if(V=F(y[D]),V&&c(v,V))return V;return new m(!1)}R=d(y,L)}for(G=T?y.next:R.next;!(q=n(G,R)).done;){try{V=F(q.value)}catch(nt){f(R,"throw",nt)}if(typeof V=="object"&&V&&c(v,V))return V}return new m(!1)}},2777:(h,e,t)=>{var s=t(9565),n=t(34),i=t(757),r=t(5966),o=t(4270),l=t(8227),c=TypeError,d=l("toPrimitive");h.exports=function(u,f){if(!n(u)||i(u))return u;var p=r(u,d),m;if(p){if(f===void 0&&(f="default"),m=s(p,u,f),!n(m)||i(m))return m;throw new c("Can't convert object to primitive value")}return f===void 0&&(f="number"),o(u,f)}},2787:(h,e,t)=>{var s=t(9297),n=t(4901),i=t(8981),r=t(6119),o=t(2211),l=r("IE_PROTO"),c=Object,d=c.prototype;h.exports=o?c.getPrototypeOf:function(u){var f=i(u);if(s(f,l))return f[l];var p=f.constructor;return n(p)&&f instanceof p?p.prototype:f instanceof c?d:null}},2796:(h,e,t)=>{var s=t(9039),n=t(4901),i=/#|\.prototype\./,r=function(u,f){var p=l[o(u)];return p===d?!0:p===c?!1:n(f)?s(f):!!f},o=r.normalize=function(u){return String(u).replace(i,".").toLowerCase()},l=r.data={},c=r.NATIVE="N",d=r.POLYFILL="P";h.exports=r},2804:h=>{var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=e+"+/",s=e+"-_",n=function(i){for(var r={},o=0;o<64;o++)r[i.charAt(o)]=o;return r};h.exports={i2c:t,c2i:n(t),i2cUrl:s,c2iUrl:n(s)}},2812:h=>{var e=TypeError;h.exports=function(t,s){if(t<s)throw new e("Not enough arguments");return t}},2839:(h,e,t)=>{var s=t(4576),n=s.navigator,i=n&&n.userAgent;h.exports=i?String(i):""},2967:(h,e,t)=>{var s=t(6706),n=t(34),i=t(7750),r=t(3506);h.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var o=!1,l={},c;try{c=s(Object.prototype,"__proto__","set"),c(l,[]),o=l instanceof Array}catch{}return function(u,f){return i(u),r(f),n(u)&&(o?c(u,f):u.__proto__=f),u}}():void 0)},3068:(h,e,t)=>{var s=t(6518),n=t(9504),i=t(2652),r=RangeError,o=TypeError,l=1/0,c=NaN,d=Math.abs,u=Math.pow,f=n([].push),p=u(2,1023),m=u(2,53)-1,v=Number.MAX_VALUE,y=u(2,971),A={},E={},S={},x={},T={},C=function(P,k){var R=P+k,L=k-(R-P);return{hi:R,lo:L}};s({target:"Math",stat:!0},{sumPrecise:function(k){var R=[],L=0,D=x;switch(i(k,function(z){if(++L>=m)throw new r("Maximum allowed index exceeded");if(typeof z!="number")throw new o("Value is not a number");D!==A&&(z!==z?D=A:z===l?D=D===E?A:S:z===-l?D=D===S?A:E:(z!==0||1/z===l)&&(D===x||D===T)&&(D=T,f(R,z)))}),D){case A:return c;case E:return-l;case S:return l;case x:return-0}for(var H=[],V=0,G,q,j,F,nt,ct,Pt=0;Pt<R.length;Pt++){G=R[Pt];for(var Kt=0,ut=0;ut<H.length;ut++){if(q=H[ut],d(G)<d(q)&&(ct=G,G=q,q=ct),j=C(G,q),F=j.hi,nt=j.lo,d(F)===l){var mt=F===l?1:-1;V+=mt,G=G-mt*p-mt*p,d(G)<d(q)&&(ct=G,G=q,q=ct),j=C(G,q),F=j.hi,nt=j.lo}nt!==0&&(H[Kt++]=nt),G=F}H.length=Kt,G!==0&&f(H,G)}var Ht=H.length-1;if(F=0,nt=0,V!==0){var ne=Ht>=0?H[Ht]:0;if(Ht--,d(V)>1||V>0&&ne>0||V<0&&ne<0)return V>0?l:-l;if(j=C(V*p,ne/2),F=j.hi,nt=j.lo,nt*=2,d(2*F)===l)return F>0?F===p&&nt===-(y/2)&&Ht>=0&&H[Ht]<0?v:l:F===-p&&nt===y/2&&Ht>=0&&H[Ht]>0?-v:-l;nt!==0&&(H[++Ht]=nt,nt=0),F*=2}for(;Ht>=0&&(j=C(F,H[Ht--]),F=j.hi,nt=j.lo,nt===0););return Ht>=0&&(nt<0&&H[Ht]<0||nt>0&&H[Ht]>0)&&(q=nt*2,G=F+q,q===G-F&&(F=G)),F}})},3167:(h,e,t)=>{var s=t(4901),n=t(34),i=t(2967);h.exports=function(r,o,l){var c,d;return i&&s(c=o.constructor)&&c!==l&&n(d=c.prototype)&&d!==l.prototype&&i(r,d),r}},3238:(h,e,t)=>{var s=t(4576),n=t(7811),i=t(7394),r=s.DataView;h.exports=function(o){if(!n||i(o)!==0)return!1;try{return new r(o),!1}catch{return!0}}},3392:(h,e,t)=>{var s=t(9504),n=0,i=Math.random(),r=s(1.1.toString);h.exports=function(o){return"Symbol("+(o===void 0?"":o)+")_"+r(++n+i,36)}},3440:(h,e,t)=>{var s=t(7080),n=t(4402),i=t(9286),r=t(5170),o=t(3789),l=t(8469),c=t(507),d=n.has,u=n.remove;h.exports=function(p){var m=s(this),v=o(p),y=i(m);return r(m)<=v.size?l(m,function(A){v.includes(A)&&u(y,A)}):c(v.getIterator(),function(A){d(y,A)&&u(y,A)}),y}},3463:h=>{var e=TypeError;h.exports=function(t){if(typeof t=="string")return t;throw new e("Argument is not a string")}},3506:(h,e,t)=>{var s=t(3925),n=String,i=TypeError;h.exports=function(r){if(s(r))return r;throw new i("Can't set "+n(r)+" as a prototype")}},3579:(h,e,t)=>{var s=t(6518),n=t(9565),i=t(2652),r=t(9306),o=t(8551),l=t(1767),c=t(9539),d=t(4549),u=d("some",TypeError);s({target:"Iterator",proto:!0,real:!0,forced:u},{some:function(p){o(this);try{r(p)}catch(y){c(this,"throw",y)}if(u)return n(u,this,p);var m=l(this),v=0;return i(m,function(y,A){if(p(y,v++))return A()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},3650:(h,e,t)=>{var s=t(7080),n=t(4402),i=t(9286),r=t(3789),o=t(507),l=n.add,c=n.has,d=n.remove;h.exports=function(f){var p=s(this),m=r(f).getIterator(),v=i(p);return o(m,function(y){c(p,y)?d(v,y):l(v,y)}),v}},3706:(h,e,t)=>{var s=t(9504),n=t(4901),i=t(7629),r=s(Function.toString);n(i.inspectSource)||(i.inspectSource=function(o){return r(o)}),h.exports=i.inspectSource},3717:(h,e)=>{e.f=Object.getOwnPropertySymbols},3724:(h,e,t)=>{var s=t(9039);h.exports=!s(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})},3789:(h,e,t)=>{var s=t(9306),n=t(8551),i=t(9565),r=t(1291),o=t(1767),l="Invalid size",c=RangeError,d=TypeError,u=Math.max,f=function(p,m){this.set=p,this.size=u(m,0),this.has=s(p.has),this.keys=s(p.keys)};f.prototype={getIterator:function(){return o(n(i(this.keys,this.set)))},includes:function(p){return i(this.has,this.set,p)}},h.exports=function(p){n(p);var m=+p.size;if(m!==m)throw new d(l);var v=r(m);if(v<0)throw new c(l);return new f(p,v)}},3838:(h,e,t)=>{var s=t(7080),n=t(5170),i=t(8469),r=t(3789);h.exports=function(l){var c=s(this),d=r(l);return n(c)>d.size?!1:i(c,function(u){if(!d.includes(u))return!1},!0)!==!1}},3853:(h,e,t)=>{var s=t(6518),n=t(4449),i=t(4916),r=!i("isDisjointFrom",function(o){return!o});s({target:"Set",proto:!0,real:!0,forced:r},{isDisjointFrom:n})},3925:(h,e,t)=>{var s=t(34);h.exports=function(n){return s(n)||n===null}},3972:(h,e,t)=>{var s=t(34),n=String,i=TypeError;h.exports=function(r){if(r===void 0||s(r))return r;throw new i(n(r)+" is not an object or undefined")}},4055:(h,e,t)=>{var s=t(4576),n=t(34),i=s.document,r=n(i)&&n(i.createElement);h.exports=function(o){return r?i.createElement(o):{}}},4114:(h,e,t)=>{var s=t(6518),n=t(8981),i=t(6198),r=t(4527),o=t(6837),l=t(9039),c=l(function(){return[].push.call({length:4294967296},1)!==4294967297}),d=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(f){return f instanceof TypeError}},u=c||!d();s({target:"Array",proto:!0,arity:1,forced:u},{push:function(p){var m=n(this),v=i(m),y=arguments.length;o(v+y);for(var A=0;A<y;A++)m[v]=arguments[A],v++;return r(m,v),v}})},4117:h=>{h.exports=function(e){return e==null}},4149:h=>{var e=RangeError;h.exports=function(t){if(t===t)return t;throw new e("NaN is not allowed")}},4154:(h,e,t)=>{var s=t(6955),n=TypeError;h.exports=function(i){if(s(i)==="Uint8Array")return i;throw new n("Argument is not an Uint8Array")}},4204:(h,e,t)=>{var s=t(7080),n=t(4402).add,i=t(9286),r=t(3789),o=t(507);h.exports=function(c){var d=s(this),u=r(c).getIterator(),f=i(d);return o(u,function(p){n(f,p)}),f}},4209:(h,e,t)=>{var s=t(8227),n=t(6269),i=s("iterator"),r=Array.prototype;h.exports=function(o){return o!==void 0&&(n.Array===o||r[i]===o)}},4215:(h,e,t)=>{var s=t(4576),n=t(2839),i=t(2195),r=function(o){return n.slice(0,o.length)===o};h.exports=function(){return r("Bun/")?"BUN":r("Cloudflare-Workers")?"CLOUDFLARE":r("Deno/")?"DENO":r("Node.js/")?"NODE":s.Bun&&typeof Bun.version=="string"?"BUN":s.Deno&&typeof Deno.version=="object"?"DENO":i(s.process)==="process"?"NODE":s.window&&s.document?"BROWSER":"REST"}()},4226:(h,e,t)=>{var s=t(6518),n=t(4576),i=t(3463),r=t(4154),o=t(5169),l=t(2303);n.Uint8Array&&s({target:"Uint8Array",proto:!0},{setFromHex:function(d){r(this),i(d),o(this.buffer);var u=l(d,this).read;return{read:u,written:u/2}}})},4235:(h,e,t)=>{t(3068)},4270:(h,e,t)=>{var s=t(9565),n=t(4901),i=t(34),r=TypeError;h.exports=function(o,l){var c,d;if(l==="string"&&n(c=o.toString)&&!i(d=s(c,o))||n(c=o.valueOf)&&!i(d=s(c,o))||l!=="string"&&n(c=o.toString)&&!i(d=s(c,o)))return d;throw new r("Can't convert object to primitive value")}},4376:(h,e,t)=>{var s=t(2195);h.exports=Array.isArray||function(i){return s(i)==="Array"}},4402:(h,e,t)=>{var s=t(9504),n=Set.prototype;h.exports={Set,add:s(n.add),has:s(n.has),remove:s(n.delete),proto:n}},4449:(h,e,t)=>{var s=t(7080),n=t(4402).has,i=t(5170),r=t(3789),o=t(8469),l=t(507),c=t(9539);h.exports=function(u){var f=s(this),p=r(u);if(i(f)<=p.size)return o(f,function(v){if(p.includes(v))return!1},!0)!==!1;var m=p.getIterator();return l(m,function(v){if(n(f,v))return c(m,"normal",!1)})!==!1}},4483:(h,e,t)=>{var s=t(4576),n=t(9429),i=t(1548),r=s.structuredClone,o=s.ArrayBuffer,l=s.MessageChannel,c=!1,d,u,f,p;if(i)c=function(m){r(m,{transfer:[m]})};else if(o)try{l||(d=n("worker_threads"),d&&(l=d.MessageChannel)),l&&(u=new l,f=new o(2),p=function(m){u.port1.postMessage(null,[m])},f.byteLength===2&&(p(f),f.byteLength===0&&(c=p)))}catch{}h.exports=c},4495:(h,e,t)=>{var s=t(9519),n=t(9039),i=t(4576),r=i.String;h.exports=!!Object.getOwnPropertySymbols&&!n(function(){var o=Symbol("symbol detection");return!r(o)||!(Object(o)instanceof Symbol)||!Symbol.sham&&s&&s<41})},4527:(h,e,t)=>{var s=t(3724),n=t(4376),i=TypeError,r=Object.getOwnPropertyDescriptor,o=s&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(l){return l instanceof TypeError}}();h.exports=o?function(l,c){if(n(l)&&!r(l,"length").writable)throw new i("Cannot set read only .length");return l.length=c}:function(l,c){return l.length=c}},4549:(h,e,t)=>{var s=t(4576);h.exports=function(n,i){var r=s.Iterator,o=r&&r.prototype,l=o&&o[n],c=!1;if(l)try{l.call({next:function(){return{done:!0}},return:function(){c=!0}},-1)}catch(d){d instanceof i||(c=!1)}if(!c)return l}},4576:function(h){var e=function(t){return t&&t.Math===Math&&t};h.exports=e(typeof globalThis=="object"&&globalThis)||e(typeof window=="object"&&window)||e(typeof self=="object"&&self)||e(typeof global=="object"&&global)||e(typeof this=="object"&&this)||function(){return this}()||Function("return this")()},4603:(h,e,t)=>{var s=t(6840),n=t(9504),i=t(655),r=t(2812),o=URLSearchParams,l=o.prototype,c=n(l.append),d=n(l.delete),u=n(l.forEach),f=n([].push),p=new o("a=1&a=2&b=3");p.delete("a",1),p.delete("b",void 0),p+""!="a=2"&&s(l,"delete",function(m){var v=arguments.length,y=v<2?void 0:arguments[1];if(v&&y===void 0)return d(this,m);var A=[];u(this,function(R,L){f(A,{key:L,value:R})}),r(v,1);for(var E=i(m),S=i(y),x=0,T=0,C=!1,P=A.length,k;x<P;)k=A[x++],C||k.key===E?(C=!0,d(this,k.key)):T++;for(;T<P;)k=A[T++],k.key===E&&k.value===S||c(this,k.key,k.value)},{enumerable:!0,unsafe:!0})},4628:(h,e,t)=>{var s=t(6518),n=t(6043);s({target:"Promise",stat:!0},{withResolvers:function(){var r=n.f(this);return{promise:r.promise,resolve:r.resolve,reject:r.reject}}})},4644:(h,e,t)=>{var s=t(7811),n=t(3724),i=t(4576),r=t(4901),o=t(34),l=t(9297),c=t(6955),d=t(6823),u=t(6699),f=t(6840),p=t(2106),m=t(1625),v=t(2787),y=t(2967),A=t(8227),E=t(3392),S=t(1181),x=S.enforce,T=S.get,C=i.Int8Array,P=C&&C.prototype,k=i.Uint8ClampedArray,R=k&&k.prototype,L=C&&v(C),D=P&&v(P),H=Object.prototype,V=i.TypeError,G=A("toStringTag"),q=E("TYPED_ARRAY_TAG"),j="TypedArrayConstructor",F=s&&!!y&&c(i.opera)!=="Opera",nt=!1,ct,Pt,Kt,ut={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},mt={BigInt64Array:8,BigUint64Array:8},Ht=function(kt){if(!o(kt))return!1;var jt=c(kt);return jt==="DataView"||l(ut,jt)||l(mt,jt)},ne=function(it){var kt=v(it);if(o(kt)){var jt=T(kt);return jt&&l(jt,j)?jt[j]:ne(kt)}},z=function(it){if(!o(it))return!1;var kt=c(it);return l(ut,kt)||l(mt,kt)},B=function(it){if(z(it))return it;throw new V("Target is not a typed array")},X=function(it){if(r(it)&&(!y||m(L,it)))return it;throw new V(d(it)+" is not a typed array constructor")},ft=function(it,kt,jt,Ts){if(n){if(jt)for(var $e in ut){var me=i[$e];if(me&&l(me.prototype,it))try{delete me.prototype[it]}catch{try{me.prototype[it]=kt}catch{}}}(!D[it]||jt)&&f(D,it,jt?kt:F&&P[it]||kt,Ts)}},Dt=function(it,kt,jt){var Ts,$e;if(n){if(y){if(jt){for(Ts in ut)if($e=i[Ts],$e&&l($e,it))try{delete $e[it]}catch{}}if(!L[it]||jt)try{return f(L,it,jt?kt:F&&L[it]||kt)}catch{}else return}for(Ts in ut)$e=i[Ts],$e&&(!$e[it]||jt)&&f($e,it,kt)}};for(ct in ut)Pt=i[ct],Kt=Pt&&Pt.prototype,Kt?x(Kt)[j]=Pt:F=!1;for(ct in mt)Pt=i[ct],Kt=Pt&&Pt.prototype,Kt&&(x(Kt)[j]=Pt);if((!F||!r(L)||L===Function.prototype)&&(L=function(){throw new V("Incorrect invocation")},F))for(ct in ut)i[ct]&&y(i[ct],L);if((!F||!D||D===H)&&(D=L.prototype,F))for(ct in ut)i[ct]&&y(i[ct].prototype,D);if(F&&v(R)!==D&&y(R,D),n&&!l(D,G)){nt=!0,p(D,G,{configurable:!0,get:function(){return o(this)?this[q]:void 0}});for(ct in ut)i[ct]&&u(i[ct],q,ct)}h.exports={NATIVE_ARRAY_BUFFER_VIEWS:F,TYPED_ARRAY_TAG:nt&&q,aTypedArray:B,aTypedArrayConstructor:X,exportTypedArrayMethod:ft,exportTypedArrayStaticMethod:Dt,getTypedArrayConstructor:ne,isView:Ht,isTypedArray:z,TypedArray:L,TypedArrayPrototype:D}},4659:(h,e,t)=>{var s=t(3724),n=t(4913),i=t(6980);h.exports=function(r,o,l){s?n.f(r,o,i(0,l)):r[o]=l}},4901:h=>{var e=typeof document=="object"&&document.all;h.exports=typeof e>"u"&&e!==void 0?function(t){return typeof t=="function"||t===e}:function(t){return typeof t=="function"}},4913:(h,e,t)=>{var s=t(3724),n=t(5917),i=t(8686),r=t(8551),o=t(6969),l=TypeError,c=Object.defineProperty,d=Object.getOwnPropertyDescriptor,u="enumerable",f="configurable",p="writable";e.f=s?i?function(v,y,A){if(r(v),y=o(y),r(A),typeof v=="function"&&y==="prototype"&&"value"in A&&p in A&&!A[p]){var E=d(v,y);E&&E[p]&&(v[y]=A.value,A={configurable:f in A?A[f]:E[f],enumerable:u in A?A[u]:E[u],writable:!1})}return c(v,y,A)}:c:function(v,y,A){if(r(v),y=o(y),r(A),n)try{return c(v,y,A)}catch{}if("get"in A||"set"in A)throw new l("Accessors not supported");return"value"in A&&(v[y]=A.value),v}},4916:(h,e,t)=>{var s=t(7751),n=function(r){return{size:r,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},i=function(r){return{size:r,has:function(){return!0},keys:function(){throw new Error("e")}}};h.exports=function(r,o){var l=s("Set");try{new l()[r](n(0));try{return new l()[r](n(-1)),!1}catch{if(!o)return!0;try{return new l()[r](i(-1/0)),!1}catch{var c=new l;return c.add(1),c.add(2),o(c[r](i(1/0)))}}}catch{return!1}}},4972:(h,e,t)=>{var s=t(6518),n=t(9565),i=t(8551),r=t(1767),o=t(4149),l=t(9590),c=t(9462),d=t(9539),u=t(4549),f=t(6395),p=!f&&u("take",RangeError),m=c(function(){var v=this.iterator;if(!this.remaining--)return this.done=!0,d(v,"normal",void 0);var y=i(n(this.next,v)),A=this.done=!!y.done;if(!A)return y.value});s({target:"Iterator",proto:!0,real:!0,forced:f||p},{take:function(y){i(this);var A;try{A=l(o(+y))}catch(E){d(this,"throw",E)}return p?n(p,this,A):new m(r(this),{remaining:A})}})},4979:(h,e,t)=>{var s=t(6518),n=t(4576),i=t(7751),r=t(6980),o=t(4913).f,l=t(9297),c=t(679),d=t(3167),u=t(2603),f=t(5002),p=t(8574),m=t(3724),v=t(6395),y="DOMException",A=i("Error"),E=i(y),S=function(){c(this,x);var j=arguments.length,F=u(j<1?void 0:arguments[0]),nt=u(j<2?void 0:arguments[1],"Error"),ct=new E(F,nt),Pt=new A(F);return Pt.name=y,o(ct,"stack",r(1,p(Pt.stack,1))),d(ct,this,S),ct},x=S.prototype=E.prototype,T="stack"in new A(y),C="stack"in new E(1,2),P=E&&m&&Object.getOwnPropertyDescriptor(n,y),k=!!P&&!(P.writable&&P.configurable),R=T&&!k&&!C;s({global:!0,constructor:!0,forced:v||R},{DOMException:R?S:E});var L=i(y),D=L.prototype;if(D.constructor!==L){v||o(D,"constructor",r(1,L));for(var H in f)if(l(f,H)){var V=f[H],G=V.s;l(L,G)||o(L,G,r(6,V.c))}}},5002:h=>{h.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}},5024:(h,e,t)=>{var s=t(6518),n=t(3650),i=t(9835),r=t(4916),o=!r("symmetricDifference")||!i("symmetricDifference");s({target:"Set",proto:!0,real:!0,forced:o},{symmetricDifference:n})},5031:(h,e,t)=>{var s=t(7751),n=t(9504),i=t(8480),r=t(3717),o=t(8551),l=n([].concat);h.exports=s("Reflect","ownKeys")||function(d){var u=i.f(o(d)),f=r.f;return f?l(u,f(d)):u}},5169:(h,e,t)=>{var s=t(3238),n=TypeError;h.exports=function(i){if(s(i))throw new n("ArrayBuffer is detached");return i}},5170:(h,e,t)=>{var s=t(6706),n=t(4402);h.exports=s(n.proto,"size","get")||function(i){return i.size}},5213:(h,e,t)=>{var s=t(6518),n=t(4576),i=t(5370),r=t(9143),o=n.Uint8Array,l=!o||!o.fromBase64||!function(){try{o.fromBase64("a");return}catch{}try{o.fromBase64("",null)}catch{return!0}}();o&&s({target:"Uint8Array",stat:!0,forced:l},{fromBase64:function(d){var u=r(d,arguments.length>1?arguments[1]:void 0,null,9007199254740991);return i(o,u.bytes)}})},5370:(h,e,t)=>{var s=t(6198);h.exports=function(n,i,r){for(var o=0,l=arguments.length>2?r:s(i),c=new n(l);l>o;)c[o]=i[o++];return c}},5397:(h,e,t)=>{var s=t(7055),n=t(7750);h.exports=function(i){return s(n(i))}},5610:(h,e,t)=>{var s=t(1291),n=Math.max,i=Math.min;h.exports=function(r,o){var l=s(r);return l<0?n(l+o,0):i(l,o)}},5623:(h,e,t)=>{t(456)},5636:(h,e,t)=>{var s=t(4576),n=t(9504),i=t(6706),r=t(7696),o=t(5169),l=t(7394),c=t(4483),d=t(1548),u=s.structuredClone,f=s.ArrayBuffer,p=s.DataView,m=Math.min,v=f.prototype,y=p.prototype,A=n(v.slice),E=i(v,"resizable","get"),S=i(v,"maxByteLength","get"),x=n(y.getInt8),T=n(y.setInt8);h.exports=(d||c)&&function(C,P,k){var R=l(C),L=P===void 0?R:r(P),D=!E||!E(C),H;if(o(C),d&&(C=u(C,{transfer:[C]}),R===L&&(k||D)))return C;if(R>=L&&(!k||D))H=A(C,0,L);else{var V=k&&!D&&S?{maxByteLength:S(C)}:void 0;H=new f(L,V);for(var G=new p(C),q=new p(H),j=m(L,R),F=0;F<j;F++)T(q,F,x(G,F))}return d||c(C),H}},5745:(h,e,t)=>{var s=t(7629);h.exports=function(n,i){return s[n]||(s[n]=i||{})}},5781:(h,e,t)=>{var s=t(6518),n=t(7751),i=t(2812),r=t(655),o=t(7416),l=n("URL");s({target:"URL",stat:!0,forced:!o},{parse:function(d){var u=i(arguments.length,1),f=r(d),p=u<2||arguments[1]===void 0?void 0:r(arguments[1]);try{return new l(f,p)}catch{return null}}})},5854:(h,e,t)=>{var s=t(2777),n=TypeError;h.exports=function(i){var r=s(i,"number");if(typeof r=="number")throw new n("Can't convert number to bigint");return BigInt(r)}},5876:(h,e,t)=>{var s=t(6518),n=t(3838),i=t(4916),r=!i("isSubsetOf",function(o){return o});s({target:"Set",proto:!0,real:!0,forced:r},{isSubsetOf:n})},5917:(h,e,t)=>{var s=t(3724),n=t(9039),i=t(4055);h.exports=!s&&!n(function(){return Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a!==7})},5966:(h,e,t)=>{var s=t(9306),n=t(4117);h.exports=function(i,r){var o=i[r];return n(o)?void 0:s(o)}},6043:(h,e,t)=>{var s=t(9306),n=TypeError,i=function(r){var o,l;this.promise=new r(function(c,d){if(o!==void 0||l!==void 0)throw new n("Bad Promise constructor");o=c,l=d}),this.resolve=s(o),this.reject=s(l)};h.exports.f=function(r){return new i(r)}},6080:(h,e,t)=>{var s=t(7476),n=t(9306),i=t(616),r=s(s.bind);h.exports=function(o,l){return n(o),l===void 0?o:i?r(o,l):function(){return o.apply(l,arguments)}}},6119:(h,e,t)=>{var s=t(5745),n=t(3392),i=s("keys");h.exports=function(r){return i[r]||(i[r]=n(r))}},6193:(h,e,t)=>{var s=t(4215);h.exports=s==="NODE"},6198:(h,e,t)=>{var s=t(8014);h.exports=function(n){return s(n.length)}},6269:h=>{h.exports={}},6279:(h,e,t)=>{var s=t(6840);h.exports=function(n,i,r){for(var o in i)s(n,o,i[o],r);return n}},6319:(h,e,t)=>{var s=t(8551),n=t(9539);h.exports=function(i,r,o,l){try{return l?r(s(o)[0],o[1]):r(o)}catch(c){n(i,"throw",c)}}},6395:h=>{h.exports=!1},6518:(h,e,t)=>{var s=t(4576),n=t(7347).f,i=t(6699),r=t(6840),o=t(9433),l=t(7740),c=t(2796);h.exports=function(d,u){var f=d.target,p=d.global,m=d.stat,v,y,A,E,S,x;if(p?y=s:m?y=s[f]||o(f,{}):y=s[f]&&s[f].prototype,y)for(A in u){if(S=u[A],d.dontCallGetSet?(x=n(y,A),E=x&&x.value):E=y[A],v=c(p?A:f+(m?".":"#")+A,d.forced),!v&&E!==void 0){if(typeof S==typeof E)continue;l(S,E)}(d.sham||E&&E.sham)&&i(S,"sham",!0),r(y,A,S,d)}}},6573:(h,e,t)=>{var s=t(3724),n=t(2106),i=t(3238),r=ArrayBuffer.prototype;s&&!("detached"in r)&&n(r,"detached",{configurable:!0,get:function(){return i(this)}})},6632:(h,e,t)=>{var s=t(6518),n=t(4576),i=t(9143),r=t(4154),o=n.Uint8Array,l=!o||!o.prototype.setFromBase64||!function(){var c=new o([255,255,255,255,255]);try{c.setFromBase64("",null);return}catch{}try{c.setFromBase64("a");return}catch{}try{c.setFromBase64("MjYyZg===")}catch{return c[0]===50&&c[1]===54&&c[2]===50&&c[3]===255&&c[4]===255}}();o&&s({target:"Uint8Array",proto:!0,forced:l},{setFromBase64:function(d){r(this);var u=i(d,arguments.length>1?arguments[1]:void 0,this,this.length);return{read:u.read,written:u.written}}})},6699:(h,e,t)=>{var s=t(3724),n=t(4913),i=t(6980);h.exports=s?function(r,o,l){return n.f(r,o,i(1,l))}:function(r,o,l){return r[o]=l,r}},6706:(h,e,t)=>{var s=t(9504),n=t(9306);h.exports=function(i,r,o){try{return s(n(Object.getOwnPropertyDescriptor(i,r)[o]))}catch{}}},6801:(h,e,t)=>{var s=t(3724),n=t(8686),i=t(4913),r=t(8551),o=t(5397),l=t(1072);e.f=s&&!n?Object.defineProperties:function(d,u){r(d);for(var f=o(u),p=l(u),m=p.length,v=0,y;m>v;)i.f(d,y=p[v++],f[y]);return d}},6823:h=>{var e=String;h.exports=function(t){try{return e(t)}catch{return"Object"}}},6837:h=>{var e=TypeError,t=9007199254740991;h.exports=function(s){if(s>t)throw e("Maximum allowed index exceeded");return s}},6840:(h,e,t)=>{var s=t(4901),n=t(4913),i=t(283),r=t(9433);h.exports=function(o,l,c,d){d||(d={});var u=d.enumerable,f=d.name!==void 0?d.name:l;if(s(c)&&i(c,f,d),d.global)u?o[l]=c:r(l,c);else{try{d.unsafe?o[l]&&(u=!0):delete o[l]}catch{}u?o[l]=c:n.f(o,l,{value:c,enumerable:!1,configurable:!d.nonConfigurable,writable:!d.nonWritable})}return o}},6955:(h,e,t)=>{var s=t(2140),n=t(4901),i=t(2195),r=t(8227),o=r("toStringTag"),l=Object,c=i(function(){return arguments}())==="Arguments",d=function(u,f){try{return u[f]}catch{}};h.exports=s?i:function(u){var f,p,m;return u===void 0?"Undefined":u===null?"Null":typeof(p=d(f=l(u),o))=="string"?p:c?i(f):(m=i(f))==="Object"&&n(f.callee)?"Arguments":m}},6969:(h,e,t)=>{var s=t(2777),n=t(757);h.exports=function(i){var r=s(i,"string");return n(r)?r:r+""}},6980:h=>{h.exports=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}}},7040:(h,e,t)=>{var s=t(4495);h.exports=s&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},7055:(h,e,t)=>{var s=t(9504),n=t(9039),i=t(2195),r=Object,o=s("".split);h.exports=n(function(){return!r("z").propertyIsEnumerable(0)})?function(l){return i(l)==="String"?o(l,""):r(l)}:r},7080:(h,e,t)=>{var s=t(4402).has;h.exports=function(n){return s(n),n}},7347:(h,e,t)=>{var s=t(3724),n=t(9565),i=t(8773),r=t(6980),o=t(5397),l=t(6969),c=t(9297),d=t(5917),u=Object.getOwnPropertyDescriptor;e.f=s?u:function(p,m){if(p=o(p),m=l(m),d)try{return u(p,m)}catch{}if(c(p,m))return r(!n(i.f,p,m),p[m])}},7394:(h,e,t)=>{var s=t(4576),n=t(6706),i=t(2195),r=s.ArrayBuffer,o=s.TypeError;h.exports=r&&n(r.prototype,"byteLength","get")||function(l){if(i(l)!=="ArrayBuffer")throw new o("ArrayBuffer expected");return l.byteLength}},7416:(h,e,t)=>{var s=t(9039),n=t(8227),i=t(3724),r=t(6395),o=n("iterator");h.exports=!s(function(){var l=new URL("b?a=1&b=2&c=3","https://a"),c=l.searchParams,d=new URLSearchParams("a=1&a=2&b=3"),u="";return l.pathname="c%20d",c.forEach(function(f,p){c.delete("b"),u+=p+f}),d.delete("a",2),d.delete("b",void 0),r&&(!l.toJSON||!d.has("a",1)||d.has("a",2)||!d.has("a",void 0)||d.has("b"))||!c.size&&(r||!i)||!c.sort||l.href!=="https://a/c%20d?a=1&c=3"||c.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!c[o]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("https://тест").host!=="xn--e1aybc"||new URL("https://a#б").hash!=="#%D0%B1"||u!=="a1c3"||new URL("https://x",void 0).host!=="x"})},7476:(h,e,t)=>{var s=t(2195),n=t(9504);h.exports=function(i){if(s(i)==="Function")return n(i)}},7566:(h,e,t)=>{var s=t(6840),n=t(9504),i=t(655),r=t(2812),o=URLSearchParams,l=o.prototype,c=n(l.getAll),d=n(l.has),u=new o("a=1");(u.has("a",2)||!u.has("a",void 0))&&s(l,"has",function(p){var m=arguments.length,v=m<2?void 0:arguments[1];if(m&&v===void 0)return d(this,p);var y=c(this,p);r(m,1);for(var A=i(v),E=0;E<y.length;)if(y[E++]===A)return!0;return!1},{enumerable:!0,unsafe:!0})},7588:(h,e,t)=>{var s=t(6518),n=t(9565),i=t(2652),r=t(9306),o=t(8551),l=t(1767),c=t(9539),d=t(4549),u=d("forEach",TypeError);s({target:"Iterator",proto:!0,real:!0,forced:u},{forEach:function(p){o(this);try{r(p)}catch(y){c(this,"throw",y)}if(u)return n(u,this,p);var m=l(this),v=0;i(m,function(y){p(y,v++)},{IS_RECORD:!0})}})},7629:(h,e,t)=>{var s=t(6395),n=t(4576),i=t(9433),r="__core-js_shared__",o=h.exports=n[r]||i(r,{});(o.versions||(o.versions=[])).push({version:"3.45.0",mode:s?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.45.0/LICENSE",source:"https://github.com/zloirock/core-js"})},7642:(h,e,t)=>{var s=t(6518),n=t(3440),i=t(9039),r=t(4916),o=!r("difference",function(c){return c.size===0}),l=o||i(function(){var c={size:1,has:function(){return!0},keys:function(){var u=0;return{next:function(){var f=u++>1;return d.has(1)&&d.clear(),{done:f,value:2}}}}},d=new Set([1,2,3,4]);return d.difference(c).size!==3});s({target:"Set",proto:!0,real:!0,forced:l},{difference:n})},7657:(h,e,t)=>{var s=t(9039),n=t(4901),i=t(34),r=t(2360),o=t(2787),l=t(6840),c=t(8227),d=t(6395),u=c("iterator"),f=!1,p,m,v;[].keys&&(v=[].keys(),"next"in v?(m=o(o(v)),m!==Object.prototype&&(p=m)):f=!0);var y=!i(p)||s(function(){var A={};return p[u].call(A)!==A});y?p={}:d&&(p=r(p)),n(p[u])||l(p,u,function(){return this}),h.exports={IteratorPrototype:p,BUGGY_SAFARI_ITERATORS:f}},7680:(h,e,t)=>{var s=t(9504);h.exports=s([].slice)},7696:(h,e,t)=>{var s=t(1291),n=t(8014),i=RangeError;h.exports=function(r){if(r===void 0)return 0;var o=s(r),l=n(o);if(o!==l)throw new i("Wrong length or index");return l}},7740:(h,e,t)=>{var s=t(9297),n=t(5031),i=t(7347),r=t(4913);h.exports=function(o,l,c){for(var d=n(l),u=r.f,f=i.f,p=0;p<d.length;p++){var m=d[p];!s(o,m)&&!(c&&s(c,m))&&u(o,m,f(l,m))}}},7750:(h,e,t)=>{var s=t(4117),n=TypeError;h.exports=function(i){if(s(i))throw new n("Can't call method on "+i);return i}},7751:(h,e,t)=>{var s=t(4576),n=t(4901),i=function(r){return n(r)?r:void 0};h.exports=function(r,o){return arguments.length<2?i(s[r]):s[r]&&s[r][o]}},7811:h=>{h.exports=typeof ArrayBuffer<"u"&&typeof DataView<"u"},7936:(h,e,t)=>{var s=t(6518),n=t(5636);n&&s({target:"ArrayBuffer",proto:!0},{transferToFixedLength:function(){return n(this,arguments.length?arguments[0]:void 0,!1)}})},8004:(h,e,t)=>{var s=t(6518),n=t(9039),i=t(8750),r=t(4916),o=!r("intersection",function(l){return l.size===2&&l.has(1)&&l.has(2)})||n(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});s({target:"Set",proto:!0,real:!0,forced:o},{intersection:i})},8014:(h,e,t)=>{var s=t(1291),n=Math.min;h.exports=function(i){var r=s(i);return r>0?n(r,9007199254740991):0}},8100:(h,e,t)=>{var s=t(6518),n=t(5636);n&&s({target:"ArrayBuffer",proto:!0},{transfer:function(){return n(this,arguments.length?arguments[0]:void 0,!0)}})},8111:(h,e,t)=>{var s=t(6518),n=t(4576),i=t(679),r=t(8551),o=t(4901),l=t(2787),c=t(2106),d=t(4659),u=t(9039),f=t(9297),p=t(8227),m=t(7657).IteratorPrototype,v=t(3724),y=t(6395),A="constructor",E="Iterator",S=p("toStringTag"),x=TypeError,T=n[E],C=y||!o(T)||T.prototype!==m||!u(function(){T({})}),P=function(){if(i(this,m),l(this)===m)throw new x("Abstract class Iterator not directly constructable")},k=function(R,L){v?c(m,R,{configurable:!0,get:function(){return L},set:function(D){if(r(this),this===m)throw new x("You can't redefine this property");f(this,R)?this[R]=D:d(this,R,D)}}):m[R]=L};f(m,S)||k(S,E),(C||!f(m,A)||m[A]===Object)&&k(A,P),P.prototype=m,s({global:!0,constructor:!0,forced:C},{Iterator:P})},8227:(h,e,t)=>{var s=t(4576),n=t(5745),i=t(9297),r=t(3392),o=t(4495),l=t(7040),c=s.Symbol,d=n("wks"),u=l?c.for||c:c&&c.withoutSetter||r;h.exports=function(f){return i(d,f)||(d[f]=o&&i(c,f)?c[f]:u("Symbol."+f)),d[f]}},8235:(h,e,t)=>{var s=t(9504),n=t(9297),i=SyntaxError,r=parseInt,o=String.fromCharCode,l=s("".charAt),c=s("".slice),d=s(/./.exec),u={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	"},f=/^[\da-f]{4}$/i,p=/^[\u0000-\u001F]$/;h.exports=function(m,v){for(var y=!0,A="";v<m.length;){var E=l(m,v);if(E==="\\"){var S=c(m,v,v+2);if(n(u,S))A+=u[S],v+=2;else if(S==="\\u"){v+=2;var x=c(m,v,v+4);if(!d(f,x))throw new i("Bad Unicode escape at: "+v);A+=o(r(x,16)),v+=4}else throw new i('Unknown escape sequence: "'+S+'"')}else if(E==='"'){y=!1,v++;break}else{if(d(p,E))throw new i("Bad control character in string literal at: "+v);A+=E,v++}}if(y)throw new i("Unterminated string at: "+v);return{value:A,end:v}}},8237:(h,e,t)=>{var s=t(6518),n=t(2652),i=t(9306),r=t(8551),o=t(1767),l=t(9539),c=t(4549),d=t(8745),u=t(9039),f=TypeError,p=u(function(){[].keys().reduce(function(){},void 0)}),m=!p&&c("reduce",f);s({target:"Iterator",proto:!0,real:!0,forced:p||m},{reduce:function(y){r(this);try{i(y)}catch(T){l(this,"throw",T)}var A=arguments.length<2,E=A?void 0:arguments[1];if(m)return d(m,this,A?[y]:[y,E]);var S=o(this),x=0;if(n(S,function(T){A?(A=!1,E=T):E=y(E,T,x),x++},{IS_RECORD:!0}),A)throw new f("Reduce of empty iterator with no initial value");return E}})},8335:(h,e,t)=>{var s=t(6518),n=t(3724),i=t(4576),r=t(7751),o=t(9504),l=t(9565),c=t(4901),d=t(34),u=t(4376),f=t(9297),p=t(655),m=t(6198),v=t(4659),y=t(9039),A=t(8235),E=t(4495),S=i.JSON,x=i.Number,T=i.SyntaxError,C=S&&S.parse,P=r("Object","keys"),k=Object.getOwnPropertyDescriptor,R=o("".charAt),L=o("".slice),D=o(/./.exec),H=o([].push),V=/^\d$/,G=/^[1-9]$/,q=/^[\d-]$/,j=/^[\t\n\r ]$/,F=0,nt=1,ct=function(z,B){z=p(z);var X=new mt(z,0),ft=X.parse(),Dt=ft.value,it=X.skip(j,ft.end);if(it<z.length)throw new T('Unexpected extra character: "'+R(z,it)+'" after the parsed data at: '+it);return c(B)?Pt({"":Dt},"",B,ft):Dt},Pt=function(z,B,X,ft){var Dt=z[B],it=ft&&Dt===ft.value,kt=it&&typeof ft.source=="string"?{source:ft.source}:{},jt,Ts,$e,me,Ga;if(d(Dt)){var cu=u(Dt),Mh=it?ft.nodes:cu?[]:{};if(cu)for(jt=Mh.length,$e=m(Dt),me=0;me<$e;me++)Kt(Dt,me,Pt(Dt,""+me,X,me<jt?Mh[me]:void 0));else for(Ts=P(Dt),$e=m(Ts),me=0;me<$e;me++)Ga=Ts[me],Kt(Dt,Ga,Pt(Dt,Ga,X,f(Mh,Ga)?Mh[Ga]:void 0))}return l(X,z,B,Dt,kt)},Kt=function(z,B,X){if(n){var ft=k(z,B);if(ft&&!ft.configurable)return}X===void 0?delete z[B]:v(z,B,X)},ut=function(z,B,X,ft){this.value=z,this.end=B,this.source=X,this.nodes=ft},mt=function(z,B){this.source=z,this.index=B};mt.prototype={fork:function(z){return new mt(this.source,z)},parse:function(){var z=this.source,B=this.skip(j,this.index),X=this.fork(B),ft=R(z,B);if(D(q,ft))return X.number();switch(ft){case"{":return X.object();case"[":return X.array();case'"':return X.string();case"t":return X.keyword(!0);case"f":return X.keyword(!1);case"n":return X.keyword(null)}throw new T('Unexpected character: "'+ft+'" at: '+B)},node:function(z,B,X,ft,Dt){return new ut(B,ft,z?null:L(this.source,X,ft),Dt)},object:function(){for(var z=this.source,B=this.index+1,X=!1,ft={},Dt={};B<z.length;){if(B=this.until(['"',"}"],B),R(z,B)==="}"&&!X){B++;break}var it=this.fork(B).string(),kt=it.value;B=it.end,B=this.until([":"],B)+1,B=this.skip(j,B),it=this.fork(B).parse(),v(Dt,kt,it),v(ft,kt,it.value),B=this.until([",","}"],it.end);var jt=R(z,B);if(jt===",")X=!0,B++;else if(jt==="}"){B++;break}}return this.node(nt,ft,this.index,B,Dt)},array:function(){for(var z=this.source,B=this.index+1,X=!1,ft=[],Dt=[];B<z.length;){if(B=this.skip(j,B),R(z,B)==="]"&&!X){B++;break}var it=this.fork(B).parse();if(H(Dt,it),H(ft,it.value),B=this.until([",","]"],it.end),R(z,B)===",")X=!0,B++;else if(R(z,B)==="]"){B++;break}}return this.node(nt,ft,this.index,B,Dt)},string:function(){var z=this.index,B=A(this.source,this.index+1);return this.node(F,B.value,z,B.end)},number:function(){var z=this.source,B=this.index,X=B;if(R(z,X)==="-"&&X++,R(z,X)==="0")X++;else if(D(G,R(z,X)))X=this.skip(V,X+1);else throw new T("Failed to parse number at: "+X);if(R(z,X)==="."&&(X=this.skip(V,X+1)),R(z,X)==="e"||R(z,X)==="E"){X++,(R(z,X)==="+"||R(z,X)==="-")&&X++;var ft=X;if(X=this.skip(V,X),ft===X)throw new T("Failed to parse number's exponent value at: "+X)}return this.node(F,x(L(z,B,X)),B,X)},keyword:function(z){var B=""+z,X=this.index,ft=X+B.length;if(L(this.source,X,ft)!==B)throw new T("Failed to parse value at: "+X);return this.node(F,z,X,ft)},skip:function(z,B){for(var X=this.source;B<X.length&&D(z,R(X,B));B++);return B},until:function(z,B){B=this.skip(j,B);for(var X=R(this.source,B),ft=0;ft<z.length;ft++)if(z[ft]===X)return B;throw new T('Unexpected character: "'+X+'" at: '+B)}};var Ht=y(function(){var z="9007199254740993",B;return C(z,function(X,ft,Dt){B=Dt.source}),B!==z}),ne=E&&!y(function(){return 1/C("-0 	")!==-1/0});s({target:"JSON",stat:!0,forced:Ht},{parse:function(B,X){return ne&&!c(X)?C(B):ct(B,X)}})},8469:(h,e,t)=>{var s=t(9504),n=t(507),i=t(4402),r=i.Set,o=i.proto,l=s(o.forEach),c=s(o.keys),d=c(new r).next;h.exports=function(u,f,p){return p?n({iterator:c(u),next:d},f):l(u,f)}},8480:(h,e,t)=>{var s=t(1828),n=t(8727),i=n.concat("length","prototype");e.f=Object.getOwnPropertyNames||function(o){return s(o,i)}},8527:(h,e,t)=>{var s=t(7080),n=t(4402).has,i=t(5170),r=t(3789),o=t(507),l=t(9539);h.exports=function(d){var u=s(this),f=r(d);if(i(u)<f.size)return!1;var p=f.getIterator();return o(p,function(m){if(!n(u,m))return l(p,"normal",!1)})!==!1}},8551:(h,e,t)=>{var s=t(34),n=String,i=TypeError;h.exports=function(r){if(s(r))return r;throw new i(n(r)+" is not an object")}},8574:(h,e,t)=>{var s=t(9504),n=Error,i=s("".replace),r=function(c){return String(new n(c).stack)}("zxcasd"),o=/\n\s*at [^:]*:[^\n]*/,l=o.test(r);h.exports=function(c,d){if(l&&typeof c=="string"&&!n.prepareStackTrace)for(;d--;)c=i(c,o,"");return c}},8622:(h,e,t)=>{var s=t(4576),n=t(4901),i=s.WeakMap;h.exports=n(i)&&/native code/.test(String(i))},8646:(h,e,t)=>{var s=t(9565),n=t(8551),i=t(1767),r=t(851);h.exports=function(o,l){(!l||typeof o!="string")&&n(o);var c=r(o);return i(n(c!==void 0?s(c,o):o))}},8686:(h,e,t)=>{var s=t(3724),n=t(9039);h.exports=s&&n(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})},8721:(h,e,t)=>{var s=t(3724),n=t(9504),i=t(2106),r=URLSearchParams.prototype,o=n(r.forEach);s&&!("size"in r)&&i(r,"size",{get:function(){var c=0;return o(this,function(){c++}),c},configurable:!0,enumerable:!0})},8727:h=>{h.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},8745:(h,e,t)=>{var s=t(616),n=Function.prototype,i=n.apply,r=n.call;h.exports=typeof Reflect=="object"&&Reflect.apply||(s?r.bind(i):function(){return r.apply(i,arguments)})},8750:(h,e,t)=>{var s=t(7080),n=t(4402),i=t(5170),r=t(3789),o=t(8469),l=t(507),c=n.Set,d=n.add,u=n.has;h.exports=function(p){var m=s(this),v=r(p),y=new c;return i(m)>v.size?l(v.getIterator(),function(A){u(m,A)&&d(y,A)}):o(m,function(A){v.includes(A)&&d(y,A)}),y}},8773:(h,e)=>{var t={}.propertyIsEnumerable,s=Object.getOwnPropertyDescriptor,n=s&&!t.call({1:2},1);e.f=n?function(r){var o=s(this,r);return!!o&&o.enumerable}:t},8981:(h,e,t)=>{var s=t(7750),n=Object;h.exports=function(i){return n(s(i))}},9039:h=>{h.exports=function(e){try{return!!e()}catch{return!0}}},9143:(h,e,t)=>{var s=t(4576),n=t(9504),i=t(3972),r=t(3463),o=t(9297),l=t(2804),c=t(944),d=t(5169),u=l.c2i,f=l.c2iUrl,p=s.SyntaxError,m=s.TypeError,v=n("".charAt),y=function(S,x){for(var T=S.length;x<T;x++){var C=v(S,x);if(C!==" "&&C!=="	"&&C!==`
`&&C!=="\f"&&C!=="\r")break}return x},A=function(S,x,T){var C=S.length;C<4&&(S+=C===2?"AA":"A");var P=(x[v(S,0)]<<18)+(x[v(S,1)]<<12)+(x[v(S,2)]<<6)+x[v(S,3)],k=[P>>16&255,P>>8&255,P&255];if(C===2){if(T&&k[1]!==0)throw new p("Extra bits");return[k[0]]}if(C===3){if(T&&k[2]!==0)throw new p("Extra bits");return[k[0],k[1]]}return k},E=function(S,x,T){for(var C=x.length,P=0;P<C;P++)S[T+P]=x[P];return T+C};h.exports=function(S,x,T,C){r(S),i(x);var P=c(x)==="base64"?u:f,k=x?x.lastChunkHandling:void 0;if(k===void 0&&(k="loose"),k!=="loose"&&k!=="strict"&&k!=="stop-before-partial")throw new m("Incorrect `lastChunkHandling` option");T&&d(T.buffer);var R=S.length,L=T||[],D=0,H=0,V="",G=0;if(C)for(;;){if(G=y(S,G),G===R){if(V.length>0){if(k==="stop-before-partial")break;if(k==="loose"){if(V.length===1)throw new p("Malformed padding: exactly one additional character");D=E(L,A(V,P,!1),D)}else throw new p("Missing padding")}H=R;break}var q=v(S,G);if(++G,q==="="){if(V.length<2)throw new p("Padding is too early");if(G=y(S,G),V.length===2){if(G===R){if(k==="stop-before-partial")break;throw new p("Malformed padding: only one =")}v(S,G)==="="&&(++G,G=y(S,G))}if(G<R)throw new p("Unexpected character after padding");D=E(L,A(V,P,k==="strict"),D),H=R;break}if(!o(P,q))throw new p("Unexpected character");var j=C-D;if(j===1&&V.length===2||j===2&&V.length===3||(V+=q,V.length===4&&(D=E(L,A(V,P,!1),D),V="",H=G,D===C)))break}return{bytes:L,read:H,written:D}}},9286:(h,e,t)=>{var s=t(4402),n=t(8469),i=s.Set,r=s.add;h.exports=function(o){var l=new i;return n(o,function(c){r(l,c)}),l}},9297:(h,e,t)=>{var s=t(9504),n=t(8981),i=s({}.hasOwnProperty);h.exports=Object.hasOwn||function(o,l){return i(n(o),l)}},9306:(h,e,t)=>{var s=t(4901),n=t(6823),i=TypeError;h.exports=function(r){if(s(r))return r;throw new i(n(r)+" is not a function")}},9314:(h,e,t)=>{var s=t(6518),n=t(9565),i=t(8551),r=t(1767),o=t(4149),l=t(9590),c=t(9539),d=t(9462),u=t(684),f=t(4549),p=t(6395),m=!p&&!u("drop",0),v=!p&&!m&&f("drop",RangeError),y=p||m||v,A=d(function(){for(var E=this.iterator,S=this.next,x,T;this.remaining;)if(this.remaining--,x=i(n(S,E)),T=this.done=!!x.done,T)return;if(x=i(n(S,E)),T=this.done=!!x.done,!T)return x.value});s({target:"Iterator",proto:!0,real:!0,forced:y},{drop:function(S){i(this);var x;try{x=l(o(+S))}catch(T){c(this,"throw",T)}return v?n(v,this,x):new A(r(this),{remaining:x})}})},9429:(h,e,t)=>{var s=t(4576),n=t(6193);h.exports=function(i){if(n){try{return s.process.getBuiltinModule(i)}catch{}try{return Function('return require("'+i+'")')()}catch{}}}},9432:(h,e,t)=>{t(5213)},9433:(h,e,t)=>{var s=t(4576),n=Object.defineProperty;h.exports=function(i,r){try{n(s,i,{value:r,configurable:!0,writable:!0})}catch{s[i]=r}return r}},9462:(h,e,t)=>{var s=t(9565),n=t(2360),i=t(6699),r=t(6279),o=t(8227),l=t(1181),c=t(5966),d=t(7657).IteratorPrototype,u=t(2529),f=t(9539),p=t(1385),m=o("toStringTag"),v="IteratorHelper",y="WrapForValidIterator",A="normal",E="throw",S=l.set,x=function(P){var k=l.getterFor(P?y:v);return r(n(d),{next:function(){var L=k(this);if(P)return L.nextHandler();if(L.done)return u(void 0,!0);try{var D=L.nextHandler();return L.returnHandlerResult?D:u(D,L.done)}catch(H){throw L.done=!0,H}},return:function(){var R=k(this),L=R.iterator;if(R.done=!0,P){var D=c(L,"return");return D?s(D,L):u(void 0,!0)}if(R.inner)try{f(R.inner.iterator,A)}catch(H){return f(L,E,H)}if(R.openIters)try{p(R.openIters,A)}catch(H){return f(L,E,H)}return L&&f(L,A),u(void 0,!0)}})},T=x(!0),C=x(!1);i(C,m,"Iterator Helper"),h.exports=function(P,k,R){var L=function(H,V){V?(V.iterator=H.iterator,V.next=H.next):V=H,V.type=k?y:v,V.returnHandlerResult=!!R,V.nextHandler=P,V.counter=0,V.done=!1,S(this,V)};return L.prototype=k?T:C,L}},9486:(h,e,t)=>{var s=t(6518),n=t(4576),i=t(9504),r=t(3972),o=t(4154),l=t(5169),c=t(2804),d=t(944),u=c.i2c,f=c.i2cUrl,p=i("".charAt),m=n.Uint8Array,v=!m||!m.prototype.toBase64||!function(){try{var y=new m;y.toBase64(null)}catch{return!0}}();m&&s({target:"Uint8Array",proto:!0,forced:v},{toBase64:function(){var A=o(this),E=arguments.length?r(arguments[0]):void 0,S=d(E)==="base64"?u:f,x=!!E&&!!E.omitPadding;l(this.buffer);for(var T="",C=0,P=A.length,k,R=function(L){return p(S,k>>6*L&63)};C+2<P;C+=3)k=(A[C]<<16)+(A[C+1]<<8)+A[C+2],T+=R(3)+R(2)+R(1)+R(0);return C+2===P?(k=(A[C]<<16)+(A[C+1]<<8),T+=R(3)+R(2)+R(1)+(x?"":"=")):C+1===P&&(k=A[C]<<16,T+=R(3)+R(2)+(x?"":"==")),T}})},9504:(h,e,t)=>{var s=t(616),n=Function.prototype,i=n.call,r=s&&n.bind.bind(i,i);h.exports=s?r:function(o){return function(){return i.apply(o,arguments)}}},9519:(h,e,t)=>{var s=t(4576),n=t(2839),i=s.process,r=s.Deno,o=i&&i.versions||r&&r.version,l=o&&o.v8,c,d;l&&(c=l.split("."),d=c[0]>0&&c[0]<4?1:+(c[0]+c[1])),!d&&n&&(c=n.match(/Edge\/(\d+)/),(!c||c[1]>=74)&&(c=n.match(/Chrome\/(\d+)/),c&&(d=+c[1]))),h.exports=d},9539:(h,e,t)=>{var s=t(9565),n=t(8551),i=t(5966);h.exports=function(r,o,l){var c,d;n(r);try{if(c=i(r,"return"),!c){if(o==="throw")throw l;return l}c=s(c,r)}catch(u){d=!0,c=u}if(o==="throw")throw l;if(d)throw c;return n(c),l}},9565:(h,e,t)=>{var s=t(616),n=Function.prototype.call;h.exports=s?n.bind(n):function(){return n.apply(n,arguments)}},9577:(h,e,t)=>{var s=t(9928),n=t(4644),i=t(1108),r=t(1291),o=t(5854),l=n.aTypedArray,c=n.getTypedArrayConstructor,d=n.exportTypedArrayMethod,u=function(){try{new Int8Array(1).with(2,{valueOf:function(){throw 8}})}catch(p){return p===8}}(),f=u&&function(){try{new Int8Array(1).with(-.5,1)}catch{return!0}}();d("with",function(p,m){var v=l(this),y=r(p),A=i(v)?o(m):+m;return s(v,c(v),y,A)},!u||f)},9590:(h,e,t)=>{var s=t(1291),n=RangeError;h.exports=function(i){var r=s(i);if(r<0)throw new n("The argument can't be less than 0");return r}},9617:(h,e,t)=>{var s=t(5397),n=t(5610),i=t(6198),r=function(o){return function(l,c,d){var u=s(l),f=i(u);if(f===0)return!o&&-1;var p=n(d,f),m;if(o&&c!==c){for(;f>p;)if(m=u[p++],m!==m)return!0}else for(;f>p;p++)if((o||p in u)&&u[p]===c)return o||p||0;return!o&&-1}};h.exports={includes:r(!0),indexOf:r(!1)}},9631:(h,e,t)=>{t(9486)},9797:(h,e,t)=>{t(4226)},9835:h=>{h.exports=function(e){try{var t=new Set,s={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return t.clear(),t.add(4),function(){return{done:!0}}}})}},n=t[e](s);return n.size===1&&n.values().next().value===4}catch{return!1}}},9928:(h,e,t)=>{var s=t(6198),n=t(1291),i=RangeError;h.exports=function(r,o,l,c){var d=s(r),u=n(l),f=u<0?d+u:u;if(f>=d||f<0)throw new i("Incorrect index");for(var p=new o(d),m=0;m<d;m++)p[m]=m===f?c:r[m];return p}}},Ap={};function gt(h){var e=Ap[h];if(e!==void 0)return e.exports;var t=Ap[h]={exports:{}};return Pw[h].call(t.exports,t,t.exports,gt),t.exports}gt.d=(h,e)=>{for(var t in e)gt.o(e,t)&&!gt.o(h,t)&&Object.defineProperty(h,t,{enumerable:!0,get:e[t]})};gt.o=(h,e)=>Object.prototype.hasOwnProperty.call(h,e);gt(4114);gt(6573);gt(8100);gt(7936);gt(8111);gt(8237);gt(1689);gt(9577);gt(4235);gt(9432);gt(1549);gt(9797);gt(9631);gt(5623);gt(4979);gt(5781);const We=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),xu=[.001,0,0,.001,0,0],uu=1.35,As={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Pi={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},sg="pdfjs_internal_editor_",ht={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Et={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},Iw={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Ee={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Vh={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},re={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Wa={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},su={ERRORS:0,WARNINGS:1,INFOS:5},Gl={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Lh={moveTo:0,lineTo:1,curveTo:2,closePath:3},Rw={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let nu=su.WARNINGS;function kw(h){Number.isInteger(h)&&(nu=h)}function Mw(){return nu}function iu(h){nu>=su.INFOS&&console.log(`Info: ${h}`)}function lt(h){nu>=su.WARNINGS&&console.log(`Warning: ${h}`)}function $t(h){throw new Error(h)}function oe(h,e){h||$t(e)}function Lw(h){switch(h==null?void 0:h.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function ng(h,e=null,t=null){if(!h)return null;if(t&&typeof h=="string"){if(t.addDefaultProtocol&&h.startsWith("www.")){const n=h.match(/\./g);(n==null?void 0:n.length)>=2&&(h=`http://${h}`)}if(t.tryConvertEncoding)try{h=Fw(h)}catch{}}const s=e?URL.parse(h,e):URL.parse(h);return Lw(s)?s:null}function ig(h,e,t=!1){const s=URL.parse(h);return s?(s.hash=e,s.href):t&&ng(h,"http://example.com")?h.split("#",1)[0]+`${e?`#${e}`:""}`:""}function At(h,e,t,s=!1){return Object.defineProperty(h,e,{value:t,enumerable:!s,configurable:!0,writable:!1}),t}const Ua=function(){function e(t,s){this.message=t,this.name=s}return e.prototype=new Error,e.constructor=e,e}();class wp extends Ua{constructor(e,t){super(e,"PasswordException"),this.code=t}}class fu extends Ua{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class Cu extends Ua{constructor(e){super(e,"InvalidPDFException")}}class yd extends Ua{constructor(e,t,s){super(e,"ResponseException"),this.status=t,this.missing=s}}class Dw extends Ua{constructor(e){super(e,"FormatError")}}class wr extends Ua{constructor(e){super(e,"AbortException")}}function rg(h){(typeof h!="object"||(h==null?void 0:h.length)===void 0)&&$t("Invalid argument for bytesToString");const e=h.length,t=8192;if(e<t)return String.fromCharCode.apply(null,h);const s=[];for(let n=0;n<e;n+=t){const i=Math.min(n+t,e),r=h.subarray(n,i);s.push(String.fromCharCode.apply(null,r))}return s.join("")}function xh(h){typeof h!="string"&&$t("Invalid argument for stringToBytes");const e=h.length,t=new Uint8Array(e);for(let s=0;s<e;++s)t[s]=h.charCodeAt(s)&255;return t}function Ow(h){return String.fromCharCode(h>>24&255,h>>16&255,h>>8&255,h&255)}function _w(){const h=new Uint8Array(4);return h[0]=1,new Uint32Array(h.buffer,0,1)[0]===1}function Nw(){try{return new Function(""),!0}catch{return!1}}class De{static get isLittleEndian(){return At(this,"isLittleEndian",_w())}static get isEvalSupported(){return At(this,"isEvalSupported",Nw())}static get isOffscreenCanvasSupported(){return At(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return At(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return At(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return At(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const pu=Array.from(Array(256).keys(),h=>h.toString(16).padStart(2,"0"));var Ai,Uh,Pu;class Z{static makeHexColor(e,t,s){return`#${pu[e]}${pu[t]}${pu[s]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let s;e[0]?(e[0]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[3],t[3]*=e[3]):(s=t[0],t[0]=t[1],t[1]=s,s=t[2],t[2]=t[3],t[3]=s,e[1]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,s=0){const n=e[s],i=e[s+1];e[s]=n*t[0]+i*t[2]+t[4],e[s+1]=n*t[1]+i*t[3]+t[5]}static applyTransformToBezier(e,t,s=0){const n=t[0],i=t[1],r=t[2],o=t[3],l=t[4],c=t[5];for(let d=0;d<6;d+=2){const u=e[s+d],f=e[s+d+1];e[s+d]=u*n+f*r+l,e[s+d+1]=u*i+f*o+c}}static applyInverseTransform(e,t){const s=e[0],n=e[1],i=t[0]*t[3]-t[1]*t[2];e[0]=(s*t[3]-n*t[2]+t[2]*t[5]-t[4]*t[3])/i,e[1]=(-s*t[1]+n*t[0]+t[4]*t[1]-t[5]*t[0])/i}static axialAlignedBoundingBox(e,t,s){const n=t[0],i=t[1],r=t[2],o=t[3],l=t[4],c=t[5],d=e[0],u=e[1],f=e[2],p=e[3];let m=n*d+l,v=m,y=n*f+l,A=y,E=o*u+c,S=E,x=o*p+c,T=x;if(i!==0||r!==0){const C=i*d,P=i*f,k=r*u,R=r*p;m+=k,A+=k,y+=R,v+=R,E+=C,T+=C,x+=P,S+=P}s[0]=Math.min(s[0],m,y,v,A),s[1]=Math.min(s[1],E,x,S,T),s[2]=Math.max(s[2],m,y,v,A),s[3]=Math.max(s[3],E,x,S,T)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const s=e[0],n=e[1],i=e[2],r=e[3],o=s**2+n**2,l=s*i+n*r,c=i**2+r**2,d=(o+c)/2,u=Math.sqrt(d**2-(o*c-l**2));t[0]=Math.sqrt(d+u||1),t[1]=Math.sqrt(d-u||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const s=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),n=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(s>n)return null;const i=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),r=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return i>r?null:[s,i,n,r]}static pointBoundingBox(e,t,s){s[0]=Math.min(s[0],e),s[1]=Math.min(s[1],t),s[2]=Math.max(s[2],e),s[3]=Math.max(s[3],t)}static rectBoundingBox(e,t,s,n,i){i[0]=Math.min(i[0],e,s),i[1]=Math.min(i[1],t,n),i[2]=Math.max(i[2],e,s),i[3]=Math.max(i[3],t,n)}static bezierBoundingBox(e,t,s,n,i,r,o,l,c){c[0]=Math.min(c[0],e,o),c[1]=Math.min(c[1],t,l),c[2]=Math.max(c[2],e,o),c[3]=Math.max(c[3],t,l),w(this,Ai,Pu).call(this,e,s,i,o,t,n,r,l,3*(-e+3*(s-i)+o),6*(e-2*s+i),3*(s-e),c),w(this,Ai,Pu).call(this,e,s,i,o,t,n,r,l,3*(-t+3*(n-r)+l),6*(t-2*n+r),3*(n-t),c)}}Ai=new WeakSet,Uh=function(e,t,s,n,i,r,o,l,c,d){if(c<=0||c>=1)return;const u=1-c,f=c*c,p=f*c,m=u*(u*(u*e+3*c*t)+3*f*s)+p*n,v=u*(u*(u*i+3*c*r)+3*f*o)+p*l;d[0]=Math.min(d[0],m),d[1]=Math.min(d[1],v),d[2]=Math.max(d[2],m),d[3]=Math.max(d[3],v)},Pu=function(e,t,s,n,i,r,o,l,c,d,u,f){if(Math.abs(c)<1e-12){Math.abs(d)>=1e-12&&w(this,Ai,Uh).call(this,e,t,s,n,i,r,o,l,-u/d,f);return}const p=d**2-4*u*c;if(p<0)return;const m=Math.sqrt(p),v=2*c;w(this,Ai,Uh).call(this,e,t,s,n,i,r,o,l,(-d+m)/v,f),w(this,Ai,Uh).call(this,e,t,s,n,i,r,o,l,(-d-m)/v,f)},b(Z,Ai);function Fw(h){return decodeURIComponent(escape(h))}let gu=null,Sp=null;function Bw(h){return gu||(gu=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Sp=new Map([["ﬅ","ſt"]])),h.replaceAll(gu,(e,t,s)=>t?t.normalize("NFKC"):Sp.get(s))}function ag(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const h=new Uint8Array(32);return crypto.getRandomValues(h),rg(h)}const tp="pdfjs_internal_id_";function $w(h,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[s,n,...i]=t;if(!h(s)&&!Number.isInteger(s)||!e(n))return!1;const r=i.length;let o=!0;switch(n.name){case"XYZ":if(r<2||r>3)return!1;break;case"Fit":case"FitB":return r===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(r>1)return!1;break;case"FitR":if(r!==4)return!1;o=!1;break;default:return!1}for(const l of i)if(!(typeof l=="number"||o&&l===null))return!1;return!0}function Xe(h,e,t){return Math.min(Math.max(h,e),t)}function og(h){return Uint8Array.prototype.toBase64?h.toBase64():btoa(rg(h))}function Hw(h){return Uint8Array.fromBase64?Uint8Array.fromBase64(h):xh(atob(h))}typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(h){return h.reduce((e,t)=>e+t,0)});typeof AbortSignal.any!="function"&&(AbortSignal.any=function(h){const e=new AbortController,{signal:t}=e;for(const s of h)if(s.aborted)return e.abort(s.reason),t;for(const s of h)s.addEventListener("abort",()=>{e.abort(s.reason)},{signal:t});return t});gt(1701);gt(4972);gt(4628);gt(7642);gt(8004);gt(3853);gt(5876);gt(2475);gt(5024);gt(1698);gt(4603);gt(7566);gt(8721);gt(9314);gt(1148);gt(3579);gt(8335);const kn="http://www.w3.org/2000/svg",Ir=class Ir{};U(Ir,"CSS",96),U(Ir,"PDF",72),U(Ir,"PDF_TO_CSS_UNITS",Ir.CSS/Ir.PDF);let Sr=Ir;async function Ch(h,e="text"){if(Tl(h,document.baseURI)){const t=await fetch(h);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,s)=>{const n=new XMLHttpRequest;n.open("GET",h,!0),n.responseType=e,n.onreadystatechange=()=>{if(n.readyState===XMLHttpRequest.DONE){if(n.status===200||n.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(n.response);return}t(n.responseText);return}s(new Error(n.statusText))}},n.send(null)})}class Ph{constructor({viewBox:e,userUnit:t,scale:s,rotation:n,offsetX:i=0,offsetY:r=0,dontFlip:o=!1}){this.viewBox=e,this.userUnit=t,this.scale=s,this.rotation=n,this.offsetX=i,this.offsetY=r,s*=t;const l=(e[2]+e[0])/2,c=(e[3]+e[1])/2;let d,u,f,p;switch(n%=360,n<0&&(n+=360),n){case 180:d=-1,u=0,f=0,p=1;break;case 90:d=0,u=1,f=1,p=0;break;case 270:d=0,u=-1,f=-1,p=0;break;case 0:d=1,u=0,f=0,p=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(f=-f,p=-p);let m,v,y,A;d===0?(m=Math.abs(c-e[1])*s+i,v=Math.abs(l-e[0])*s+r,y=(e[3]-e[1])*s,A=(e[2]-e[0])*s):(m=Math.abs(l-e[0])*s+i,v=Math.abs(c-e[1])*s+r,y=(e[2]-e[0])*s,A=(e[3]-e[1])*s),this.transform=[d*s,u*s,f*s,p*s,m-d*s*l-f*s*c,v-u*s*l-p*s*c],this.width=y,this.height=A}get rawDims(){const e=this.viewBox;return At(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:s=this.offsetX,offsetY:n=this.offsetY,dontFlip:i=!1}={}){return new Ph({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:n,dontFlip:i})}convertToViewportPoint(e,t){const s=[e,t];return Z.applyTransform(s,this.transform),s}convertToViewportRectangle(e){const t=[e[0],e[1]];Z.applyTransform(t,this.transform);const s=[e[2],e[3]];return Z.applyTransform(s,this.transform),[t[0],t[1],s[0],s[1]]}convertToPdfPoint(e,t){const s=[e,t];return Z.applyInverseTransform(s,this.transform),s}}class ep extends Ua{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function ru(h){const e=h.length;let t=0;for(;t<e&&h[t].trim()==="";)t++;return h.substring(t,t+5).toLowerCase()==="data:"}function sp(h){return typeof h=="string"&&/\.pdf$/i.test(h)}function Vw(h){return[h]=h.split(/[#?]/,1),h.substring(h.lastIndexOf("/")+1)}function Uw(h,e="document.pdf"){if(typeof h!="string")return e;if(ru(h))return lt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const s=(o=>{try{return new URL(o)}catch{try{return new URL(decodeURIComponent(o))}catch{try{return new URL(o,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(o),"https://foo.bar")}catch{return null}}}}})(h);if(!s)return e;const n=o=>{try{let l=decodeURIComponent(o);return l.includes("/")?(l=l.split("/").at(-1),l.test(/^\.pdf$/i)?l:o):l}catch{return o}},i=/\.pdf$/i,r=s.pathname.split("/").at(-1);if(i.test(r))return n(r);if(s.searchParams.size>0){const o=Array.from(s.searchParams.values()).reverse();for(const c of o)if(i.test(c))return n(c);const l=Array.from(s.searchParams.keys()).reverse();for(const c of l)if(i.test(c))return n(c)}if(s.hash){const l=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(s.hash);if(l)return n(l[0])}return e}class Ep{constructor(){U(this,"started",Object.create(null));U(this,"times",[])}time(e){e in this.started&&lt(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||lt(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:s}of this.times)t=Math.max(s.length,t);for(const{name:s,start:n,end:i}of this.times)e.push(`${s.padEnd(t)} ${i-n}ms
`);return e.join("")}}function Tl(h,e){const t=e?URL.parse(h,e):URL.parse(h);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function $s(h){h.preventDefault()}function ae(h){h.preventDefault(),h.stopPropagation()}function jw(h){console.log("Deprecated API usage: "+h)}var Yl;class bd{static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;a(this,Yl)||g(this,Yl,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=a(this,Yl).exec(e);if(!t)return null;const s=parseInt(t[1],10);let n=parseInt(t[2],10);n=n>=1&&n<=12?n-1:0;let i=parseInt(t[3],10);i=i>=1&&i<=31?i:1;let r=parseInt(t[4],10);r=r>=0&&r<=23?r:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const c=t[7]||"Z";let d=parseInt(t[8],10);d=d>=0&&d<=23?d:0;let u=parseInt(t[9],10)||0;return u=u>=0&&u<=59?u:0,c==="-"?(r+=d,o+=u):c==="+"&&(r-=d,o-=u),new Date(Date.UTC(s,n,i,r,o,l))}}Yl=new WeakMap,b(bd,Yl);function Gw(h,{scale:e=1,rotation:t=0}){const{width:s,height:n}=h.attributes.style,i=[0,0,parseInt(s),parseInt(n)];return new Ph({viewBox:i,userUnit:1,scale:e,rotation:t})}function au(h){if(h.startsWith("#")){const e=parseInt(h.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return h.startsWith("rgb(")?h.slice(4,-1).split(",").map(e=>parseInt(e)):h.startsWith("rgba(")?h.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(lt(`Not a valid color format: "${h}"`),[0,0,0])}function zw(h){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of h.keys()){e.style.color=t;const s=window.getComputedStyle(e).color;h.set(t,au(s))}e.remove()}function Zt(h){const{a:e,b:t,c:s,d:n,e:i,f:r}=h.getTransform();return[e,t,s,n,i,r]}function qs(h){const{a:e,b:t,c:s,d:n,e:i,f:r}=h.getTransform().invertSelf();return[e,t,s,n,i,r]}function Fa(h,e,t=!1,s=!0){if(e instanceof Ph){const{pageWidth:n,pageHeight:i}=e.rawDims,{style:r}=h,o=De.isCSSRoundSupported,l=`var(--total-scale-factor) * ${n}px`,c=`var(--total-scale-factor) * ${i}px`,d=o?`round(down, ${l}, var(--scale-round-x))`:`calc(${l})`,u=o?`round(down, ${c}, var(--scale-round-y))`:`calc(${c})`;!t||e.rotation%180===0?(r.width=d,r.height=u):(r.width=u,r.height=d)}s&&h.setAttribute("data-main-rotation",e.rotation)}class Pn{constructor(){const{pixelRatio:e}=Pn;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,s,n,i=-1){let r=1/0,o=1/0,l=1/0;s=Pn.capPixels(s,i),s>0&&(r=Math.sqrt(s/(e*t))),n!==-1&&(o=n/e,l=n/t);const c=Math.min(r,o,l);return this.sx>c||this.sy>c?(this.sx=c,this.sy=c,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const s=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,s):s}return e}}const Iu=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];var Ii,Ri,Ps,_n,Kl,io,ro,Jl,Rd,lg,Le,cg,hg,Xa,xl;const Dn=class Dn{constructor(e){b(this,Le);b(this,Ii,null);b(this,Ri,null);b(this,Ps);b(this,_n,null);b(this,Kl,null);b(this,io,null);b(this,ro,null);g(this,Ps,e),a(Dn,Jl)||g(Dn,Jl,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=g(this,Ii,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=a(this,Ps)._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",$s,{signal:t}),e.addEventListener("pointerdown",w(Dn,Rd,lg),{signal:t}));const s=g(this,_n,document.createElement("div"));s.className="buttons",e.append(s);const n=a(this,Ps).toolbarPosition;if(n){const{style:i}=e,r=a(this,Ps)._uiManager.direction==="ltr"?1-n[0]:n[0];i.insetInlineEnd=`${100*r}%`,i.top=`calc(${100*n[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return a(this,Ii)}hide(){var e;a(this,Ii).classList.add("hidden"),(e=a(this,Ri))==null||e.hideDropdown()}show(){var e,t;a(this,Ii).classList.remove("hidden"),(e=a(this,Kl))==null||e.shown(),(t=a(this,io))==null||t.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=a(this,Ps),s=document.createElement("button");s.classList.add("basic","deleteButton"),s.tabIndex=0,s.setAttribute("data-l10n-id",a(Dn,Jl)[e]),w(this,Le,Xa).call(this,s)&&s.addEventListener("click",n=>{t.delete()},{signal:t._signal}),a(this,_n).append(s)}async addAltText(e){const t=await e.render();w(this,Le,Xa).call(this,t),a(this,_n).append(t,a(this,Le,xl)),g(this,Kl,e)}addComment(e){if(a(this,io))return;const t=e.render();t&&(w(this,Le,Xa).call(this,t),a(this,_n).append(t,a(this,Le,xl)),g(this,io,e),e.toolbar=this)}addColorPicker(e){if(a(this,Ri))return;g(this,Ri,e);const t=e.renderButton();w(this,Le,Xa).call(this,t),a(this,_n).append(t,a(this,Le,xl))}async addEditSignatureButton(e){const t=g(this,ro,await e.renderEditButton(a(this,Ps)));w(this,Le,Xa).call(this,t),a(this,_n).append(t,a(this,Le,xl))}async addButton(e,t){switch(e){case"colorPicker":this.addColorPicker(t);break;case"altText":await this.addAltText(t);break;case"editSignature":await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(t);break}}updateEditSignatureButton(e){a(this,ro)&&(a(this,ro).title=e)}remove(){var e;a(this,Ii).remove(),(e=a(this,Ri))==null||e.destroy(),g(this,Ri,null)}};Ii=new WeakMap,Ri=new WeakMap,Ps=new WeakMap,_n=new WeakMap,Kl=new WeakMap,io=new WeakMap,ro=new WeakMap,Jl=new WeakMap,Rd=new WeakSet,lg=function(e){e.stopPropagation()},Le=new WeakSet,cg=function(e){a(this,Ps)._focusEventsAllowed=!1,ae(e)},hg=function(e){a(this,Ps)._focusEventsAllowed=!0,ae(e)},Xa=function(e){const t=a(this,Ps)._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",w(this,Le,cg).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",w(this,Le,hg).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",$s,{signal:t}),!0)},xl=function(){const e=document.createElement("div");return e.className="divider",e},b(Dn,Rd),b(Dn,Jl,null);let Ru=Dn;var Ql,Mr,Nn,Ei,dg,ug,ku;class Ww{constructor(e){b(this,Ei);b(this,Ql,null);b(this,Mr,null);b(this,Nn);g(this,Nn,e)}show(e,t,s){const[n,i]=w(this,Ei,ug).call(this,t,s),{style:r}=a(this,Mr)||g(this,Mr,w(this,Ei,dg).call(this));e.append(a(this,Mr)),r.insetInlineEnd=`${100*n}%`,r.top=`calc(${100*i}% + var(--editor-toolbar-vert-offset))`}hide(){a(this,Mr).remove()}}Ql=new WeakMap,Mr=new WeakMap,Nn=new WeakMap,Ei=new WeakSet,dg=function(){const e=g(this,Mr,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar");const t=a(this,Nn)._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",$s,{signal:t});const s=g(this,Ql,document.createElement("div"));return s.className="buttons",e.append(s),a(this,Nn).hasCommentManager()&&w(this,Ei,ku).call(this,"commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{a(this,Nn).commentSelection("floating_button")}),w(this,Ei,ku).call(this,"highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{a(this,Nn).highlightSelection("floating_button")}),e},ug=function(e,t){let s=0,n=0;for(const i of e){const r=i.y+i.height;if(r<s)continue;const o=i.x+(t?i.width:0);if(r>s){n=o,s=r;continue}t?o>n&&(n=o):o<n&&(n=o)}return[t?1-n:n,s]},ku=function(e,t,s,n){const i=document.createElement("button");i.classList.add("basic",e),i.tabIndex=0,i.setAttribute("data-l10n-id",t);const r=document.createElement("span");i.append(r),r.className="visuallyHidden",r.setAttribute("data-l10n-id",s);const o=a(this,Nn)._signal;o instanceof AbortSignal&&!o.aborted&&(i.addEventListener("contextmenu",$s,{signal:o}),i.addEventListener("click",n,{signal:o})),a(this,Ql).append(i)};function fg(h,e,t){for(const s of t)e.addEventListener(s,h[s].bind(h))}var kd;class Xw{constructor(){b(this,kd,0)}get id(){return`${sg}${ce(this,kd)._++}`}}kd=new WeakMap;var ao,Zl,_e,oo,jh;const hp=class hp{constructor(){b(this,oo);b(this,ao,ag());b(this,Zl,0);b(this,_e,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),n=new Image;n.src=e;const i=n.decode().then(()=>(s.drawImage(n,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return At(this,"_isSVGFittingCanvas",i)}async getFromFile(e){const{lastModified:t,name:s,size:n,type:i}=e;return w(this,oo,jh).call(this,`${t}_${s}_${n}_${i}`,e)}async getFromUrl(e){return w(this,oo,jh).call(this,e,e)}async getFromBlob(e,t){const s=await t;return w(this,oo,jh).call(this,e,s)}async getFromId(e){a(this,_e)||g(this,_e,new Map);const t=a(this,_e).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:s}=t;return delete t.blobPromise,this.getFromBlob(t.id,s)}return this.getFromUrl(t.url)}getFromCanvas(e,t){a(this,_e)||g(this,_e,new Map);let s=a(this,_e).get(e);if(s!=null&&s.bitmap)return s.refCounter+=1,s;const n=new OffscreenCanvas(t.width,t.height);return n.getContext("2d").drawImage(t,0,0),s={bitmap:n.transferToImageBitmap(),id:`image_${a(this,ao)}_${ce(this,Zl)._++}`,refCounter:1,isSvg:!1},a(this,_e).set(e,s),a(this,_e).set(s.id,s),s}getSvgUrl(e){const t=a(this,_e).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var n;a(this,_e)||g(this,_e,new Map);const t=a(this,_e).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:s}=t;if(!t.url&&!t.file){const i=new OffscreenCanvas(s.width,s.height);i.getContext("bitmaprenderer").transferFromImageBitmap(s),t.blobPromise=i.convertToBlob()}(n=s.close)==null||n.call(s),t.bitmap=null}isValidId(e){return e.startsWith(`image_${a(this,ao)}_`)}};ao=new WeakMap,Zl=new WeakMap,_e=new WeakMap,oo=new WeakSet,jh=async function(e,t){a(this,_e)||g(this,_e,new Map);let s=a(this,_e).get(e);if(s===null)return null;if(s!=null&&s.bitmap)return s.refCounter+=1,s;try{s||(s={bitmap:null,id:`image_${a(this,ao)}_${ce(this,Zl)._++}`,refCounter:0,isSvg:!1});let n;if(typeof t=="string"?(s.url=t,n=await Ch(t,"blob")):t instanceof File?n=s.file=t:t instanceof Blob&&(n=t),n.type==="image/svg+xml"){const i=hp._isSVGFittingCanvas,r=new FileReader,o=new Image,l=new Promise((c,d)=>{o.onload=()=>{s.bitmap=o,s.isSvg=!0,c()},r.onload=async()=>{const u=s.svgUrl=r.result;o.src=await i?`${u}#svgView(preserveAspectRatio(none))`:u},o.onerror=r.onerror=d});r.readAsDataURL(n),await l}else s.bitmap=await createImageBitmap(n);s.refCounter=1}catch(n){lt(n),s=null}return a(this,_e).set(e,s),s&&a(this,_e).set(s.id,s),s};let Mu=hp;var te,ki,ql,Jt;class Yw{constructor(e=128){b(this,te,[]);b(this,ki,!1);b(this,ql);b(this,Jt,-1);g(this,ql,e)}add({cmd:e,undo:t,post:s,mustExec:n,type:i=NaN,overwriteIfSameType:r=!1,keepUndo:o=!1}){if(n&&e(),a(this,ki))return;const l={cmd:e,undo:t,post:s,type:i};if(a(this,Jt)===-1){a(this,te).length>0&&(a(this,te).length=0),g(this,Jt,0),a(this,te).push(l);return}if(r&&a(this,te)[a(this,Jt)].type===i){o&&(l.undo=a(this,te)[a(this,Jt)].undo),a(this,te)[a(this,Jt)]=l;return}const c=a(this,Jt)+1;c===a(this,ql)?a(this,te).splice(0,1):(g(this,Jt,c),c<a(this,te).length&&a(this,te).splice(c)),a(this,te).push(l)}undo(){if(a(this,Jt)===-1)return;g(this,ki,!0);const{undo:e,post:t}=a(this,te)[a(this,Jt)];e(),t==null||t(),g(this,ki,!1),g(this,Jt,a(this,Jt)-1)}redo(){if(a(this,Jt)<a(this,te).length-1){g(this,Jt,a(this,Jt)+1),g(this,ki,!0);const{cmd:e,post:t}=a(this,te)[a(this,Jt)];e(),t==null||t(),g(this,ki,!1)}}hasSomethingToUndo(){return a(this,Jt)!==-1}hasSomethingToRedo(){return a(this,Jt)<a(this,te).length-1}cleanType(e){if(a(this,Jt)!==-1){for(let t=a(this,Jt);t>=0;t--)if(a(this,te)[t].type!==e){a(this,te).splice(t+1,a(this,Jt)-t),g(this,Jt,t);return}a(this,te).length=0,g(this,Jt,-1)}}destroy(){g(this,te,null)}}te=new WeakMap,ki=new WeakMap,ql=new WeakMap,Jt=new WeakMap;var Md,pg;class Ih{constructor(e){b(this,Md);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=De.platform;for(const[s,n,i={}]of e)for(const r of s){const o=r.startsWith("mac+");t&&o?(this.callbacks.set(r.slice(4),{callback:n,options:i}),this.allKeys.add(r.split("+").at(-1))):!t&&!o&&(this.callbacks.set(r,{callback:n,options:i}),this.allKeys.add(r.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const s=this.callbacks.get(w(this,Md,pg).call(this,t));if(!s)return;const{callback:n,options:{bubbles:i=!1,args:r=[],checker:o=null}}=s;o&&!o(e,t)||(n.bind(e,...r,t)(),i||ae(t))}}Md=new WeakSet,pg=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const Ld=class Ld{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return zw(e),At(this,"_colors",e)}convert(e){const t=au(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[s,n]of this._colors)if(n.every((i,r)=>i===t[r]))return Ld._colorsMapping.get(s);return t}getHexCode(e){const t=this._colors.get(e);return t?Z.makeHexColor(...t):e}};U(Ld,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let Lu=Ld;var lo,ns,co,ue,Te,ho,Fn,uo,Is,Bn,Mi,Li,fo,Lr,sn,Rs,Dr,tc,ec,po,sc,nn,Di,go,Oi,rn,Dd,_i,mo,nc,Ni,Or,vo,Fi,ic,fe,Ot,$n,Bi,$i,rc,yo,ac,Hi,an,Hn,oc,lc,ks,W,Gh,Du,gg,mg,Cl,vg,yg,bg,Ou,Ag,_u,Nu,wg,He,Mn,Sg,Eg,Fu,Tg,Pl,Bu;const eo=class eo{constructor(e,t,s,n,i,r,o,l,c,d,u,f,p,m,v,y){b(this,W);b(this,lo,new AbortController);b(this,ns,null);b(this,co,null);b(this,ue,new Map);b(this,Te,new Map);b(this,ho,null);b(this,Fn,null);b(this,uo,null);b(this,Is,new Yw);b(this,Bn,null);b(this,Mi,null);b(this,Li,null);b(this,fo,0);b(this,Lr,new Set);b(this,sn,null);b(this,Rs,null);b(this,Dr,new Set);U(this,"_editorUndoBar",null);b(this,tc,!1);b(this,ec,!1);b(this,po,!1);b(this,sc,null);b(this,nn,null);b(this,Di,null);b(this,go,null);b(this,Oi,!1);b(this,rn,null);b(this,Dd,new Xw);b(this,_i,!1);b(this,mo,!1);b(this,nc,!1);b(this,Ni,null);b(this,Or,null);b(this,vo,null);b(this,Fi,null);b(this,ic,null);b(this,fe,ht.NONE);b(this,Ot,new Set);b(this,$n,null);b(this,Bi,null);b(this,$i,null);b(this,rc,null);b(this,yo,null);b(this,ac,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});b(this,Hi,[0,0]);b(this,an,null);b(this,Hn,null);b(this,oc,null);b(this,lc,null);b(this,ks,null);const A=this._signal=a(this,lo).signal;g(this,Hn,e),g(this,oc,t),g(this,lc,s),g(this,ho,n),g(this,Bn,i),g(this,Bi,r),g(this,yo,l),this._eventBus=o,o._on("editingaction",this.onEditingAction.bind(this),{signal:A}),o._on("pagechanging",this.onPageChanging.bind(this),{signal:A}),o._on("scalechanging",this.onScaleChanging.bind(this),{signal:A}),o._on("rotationchanging",this.onRotationChanging.bind(this),{signal:A}),o._on("setpreference",this.onSetPreference.bind(this),{signal:A}),o._on("switchannotationeditorparams",E=>this.updateParams(E.type,E.value),{signal:A}),window.addEventListener("pointerdown",()=>{g(this,mo,!0)},{capture:!0,signal:A}),window.addEventListener("pointerup",()=>{g(this,mo,!1)},{capture:!0,signal:A}),w(this,W,vg).call(this),w(this,W,wg).call(this),w(this,W,Ou).call(this),g(this,Fn,l.annotationStorage),g(this,sc,l.filterFactory),g(this,$i,c),g(this,go,d||null),g(this,tc,u),g(this,ec,f),g(this,po,p),g(this,ic,m||null),this.viewParameters={realScale:Sr.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=v||null,this._supportsPinchToZoom=y!==!1}static get _keyboardManager(){const e=eo.prototype,t=r=>a(r,Hn).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&r.hasSomethingToControl(),s=(r,{target:o})=>{if(o instanceof HTMLInputElement){const{type:l}=o;return l!=="text"&&l!=="number"}return!0},n=this.TRANSLATE_SMALL,i=this.TRANSLATE_BIG;return At(this,"_keyboardManager",new Ih([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],e.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:s}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(r,{target:o})=>!(o instanceof HTMLButtonElement)&&a(r,Hn).contains(o)&&!r.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(r,{target:o})=>!(o instanceof HTMLButtonElement)&&a(r,Hn).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-n,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[n,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-n],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,n],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}]]))}destroy(){var e,t,s,n,i,r,o,l,c;(e=a(this,ks))==null||e.resolve(),g(this,ks,null),(t=a(this,lo))==null||t.abort(),g(this,lo,null),this._signal=null;for(const d of a(this,Te).values())d.destroy();a(this,Te).clear(),a(this,ue).clear(),a(this,Dr).clear(),(s=a(this,Fi))==null||s.clear(),g(this,ns,null),a(this,Ot).clear(),a(this,Is).destroy(),(n=a(this,ho))==null||n.destroy(),(i=a(this,Bn))==null||i.destroy(),(r=a(this,Bi))==null||r.destroy(),(o=a(this,rn))==null||o.hide(),g(this,rn,null),(l=a(this,vo))==null||l.destroy(),g(this,vo,null),g(this,co,null),a(this,nn)&&(clearTimeout(a(this,nn)),g(this,nn,null)),a(this,an)&&(clearTimeout(a(this,an)),g(this,an,null)),(c=this._editorUndoBar)==null||c.destroy(),g(this,yo,null)}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return a(this,ic)}get useNewAltTextFlow(){return a(this,ec)}get useNewAltTextWhenAddingImage(){return a(this,po)}get hcmFilter(){return At(this,"hcmFilter",a(this,$i)?a(this,sc).addHCMFilter(a(this,$i).foreground,a(this,$i).background):"none")}get direction(){return At(this,"direction",getComputedStyle(a(this,Hn)).direction)}get _highlightColors(){return At(this,"_highlightColors",a(this,go)?new Map(a(this,go).split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return At(this,"highlightColors",null);const t=new Map,s=!!a(this,$i);for(const[n,i]of e){const r=n.endsWith("_HCM");if(s&&r){t.set(n.replace("_HCM",""),i);continue}!s&&!r&&t.set(n,i)}return At(this,"highlightColors",t)}get highlightColorNames(){return At(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),g(this,Li,e)}setMainHighlightColorPicker(e){g(this,vo,e)}editAltText(e,t=!1){var s;(s=a(this,ho))==null||s.editAltText(this,e,t)}hasCommentManager(){return!!a(this,Bn)}editComment(e,t){var s;(s=a(this,Bn))==null||s.open(this,e,t)}getSignature(e){var t;(t=a(this,Bi))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return a(this,Bi)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":g(this,po,t);break}}onPageChanging({pageNumber:e}){g(this,fo,e-1)}focusMainContainer(){a(this,Hn).focus()}findParent(e,t){for(const s of a(this,Te).values()){const{x:n,y:i,width:r,height:o}=s.div.getBoundingClientRect();if(e>=n&&e<=n+r&&t>=i&&t<=i+o)return s}return null}disableUserSelect(e=!1){a(this,oc).classList.toggle("noUserSelect",e)}addShouldRescale(e){a(this,Dr).add(e)}removeShouldRescale(e){a(this,Dr).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*Sr.PDF_TO_CSS_UNITS;for(const s of a(this,Dr))s.onScaleChanging();(t=a(this,Li))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e="",t=!1){const s=document.getSelection();if(!s||s.isCollapsed)return;const{anchorNode:n,anchorOffset:i,focusNode:r,focusOffset:o}=s,l=s.toString(),d=w(this,W,Gh).call(this,s).closest(".textLayer"),u=this.getSelectionBoxes(d);if(!u)return;s.empty();const f=w(this,W,Du).call(this,d),p=a(this,fe)===ht.NONE,m=()=>{const v=f==null?void 0:f.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:u,anchorNode:n,anchorOffset:i,focusNode:r,focusOffset:o,text:l});p&&this.showAllEditors("highlight",!0,!0),t&&(v==null||v.editComment())};if(p){this.switchToMode(ht.HIGHLIGHT,m);return}m()}commentSelection(e=""){this.highlightSelection(e,!0)}addToAnnotationStorage(e){!e.isEmpty()&&a(this,Fn)&&!a(this,Fn).has(e.id)&&a(this,Fn).setValue(e.id,e)}a11yAlert(e,t=null){const s=a(this,lc);s&&(s.setAttribute("data-l10n-id",e),t?s.setAttribute("data-l10n-args",JSON.stringify(t)):s.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,a(this,Oi)&&(g(this,Oi,!1),w(this,W,Cl).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of a(this,Ot))if(t.div.contains(e)){g(this,Or,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!a(this,Or))return;const[e,t]=a(this,Or);g(this,Or,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){w(this,W,Ou).call(this),w(this,W,_u).call(this)}removeEditListeners(){w(this,W,Ag).call(this),w(this,W,Nu).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const s of a(this,Rs))if(s.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const s of a(this,Rs))if(s.isHandlingMimeForPasting(t.type)){s.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var s;if(e.preventDefault(),(s=a(this,ns))==null||s.commitOrRemove(),!this.hasSelection)return;const t=[];for(const n of a(this,Ot)){const i=n.serialize(!0);i&&t.push(i)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const i of t.items)for(const r of a(this,Rs))if(r.isHandlingMimeForPasting(i.type)){r.paste(i,this.currentLayer);return}let s=t.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(i){lt(`paste: "${i.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const n=this.currentLayer;try{const i=[];for(const l of s){const c=await n.deserialize(l);if(!c)return;i.push(c)}const r=()=>{for(const l of i)w(this,W,Fu).call(this,l);w(this,W,Bu).call(this,i)},o=()=>{for(const l of i)l.remove()};this.addCommands({cmd:r,undo:o,mustExec:!0})}catch(i){lt(`paste: "${i.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),a(this,fe)!==ht.NONE&&!this.isEditorHandlingKeyboard&&eo._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,a(this,Oi)&&(g(this,Oi,!1),w(this,W,Cl).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}setEditingState(e){e?(w(this,W,yg).call(this),w(this,W,_u).call(this),w(this,W,He).call(this,{isEditing:a(this,fe)!==ht.NONE,isEmpty:w(this,W,Pl).call(this),hasSomethingToUndo:a(this,Is).hasSomethingToUndo(),hasSomethingToRedo:a(this,Is).hasSomethingToRedo(),hasSelectedEditor:!1})):(w(this,W,bg).call(this),w(this,W,Nu).call(this),w(this,W,He).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!a(this,Rs)){g(this,Rs,e);for(const t of a(this,Rs))w(this,W,Mn).call(this,t.defaultPropertiesToUpdate)}}getId(){return a(this,Dd).id}get currentLayer(){return a(this,Te).get(a(this,fo))}getLayer(e){return a(this,Te).get(e)}get currentPageIndex(){return a(this,fo)}addLayer(e){a(this,Te).set(e.pageIndex,e),a(this,_i)?e.enable():e.disable()}removeLayer(e){a(this,Te).delete(e.pageIndex)}async updateMode(e,t=null,s=!1,n=!1,i=!1){var r,o,l,c,d;if(a(this,fe)!==e&&!(a(this,ks)&&(await a(this,ks).promise,!a(this,ks)))){if(g(this,ks,Promise.withResolvers()),(r=a(this,Li))==null||r.commitOrRemove(),a(this,fe)===ht.POPUP&&((o=a(this,Bn))==null||o.hideSidebar()),g(this,fe,e),e===ht.NONE){this.setEditingState(!1),w(this,W,Eg).call(this),(l=this._editorUndoBar)==null||l.hide(),a(this,ks).resolve();return}e===ht.SIGNATURE&&await((c=a(this,Bi))==null?void 0:c.loadSignatures()),e===ht.POPUP&&(a(this,co)||g(this,co,await a(this,yo).getAnnotationsByType(new Set(a(this,Rs).map(u=>u._editorType)))),(d=a(this,Bn))==null||d.showSidebar(a(this,co))),this.setEditingState(!0),await w(this,W,Sg).call(this),this.unselectAll();for(const u of a(this,Te).values())u.updateMode(e);if(!t){s&&this.addNewEditorFromKeyboard(),a(this,ks).resolve();return}for(const u of a(this,ue).values())u.annotationElementId===t||u.id===t?(this.setSelected(u),i?u.editComment():n&&u.enterInEditMode()):u.unselect();a(this,ks).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==a(this,fe)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(a(this,Rs)){switch(e){case Et.CREATE:this.currentLayer.addNewEditor(t);return;case Et.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(a(this,rc)||g(this,rc,new Map)).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const s of a(this,Ot))s.updateParams(e,t);else for(const s of a(this,Rs))s.updateDefaultParams(e,t)}}showAllEditors(e,t,s=!1){var i;for(const r of a(this,ue).values())r.editorType===e&&r.show(t);(((i=a(this,rc))==null?void 0:i.get(Et.HIGHLIGHT_SHOW_ALL))??!0)!==t&&w(this,W,Mn).call(this,[[Et.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(a(this,nc)!==e){g(this,nc,e);for(const t of a(this,Te).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const s of a(this,ue).values())s.pageIndex===e&&t.push(s);return t}getEditor(e){return a(this,ue).get(e)}addEditor(e){a(this,ue).set(e.id,e)}removeEditor(e){var t,s;e.div.contains(document.activeElement)&&(a(this,nn)&&clearTimeout(a(this,nn)),g(this,nn,setTimeout(()=>{this.focusMainContainer(),g(this,nn,null)},0))),a(this,ue).delete(e.id),e.annotationElementId&&((t=a(this,Fi))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!a(this,Lr).has(e.annotationElementId))&&((s=a(this,Fn))==null||s.remove(e.id))}addDeletedAnnotationElement(e){a(this,Lr).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return a(this,Lr).has(e)}removeDeletedAnnotationElement(e){a(this,Lr).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){a(this,ns)!==e&&(g(this,ns,e),e&&w(this,W,Mn).call(this,e.propertiesToUpdate))}updateUI(e){a(this,W,Tg)===e&&w(this,W,Mn).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){w(this,W,Mn).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(a(this,Ot).has(e)){a(this,Ot).delete(e),e.unselect(),w(this,W,He).call(this,{hasSelectedEditor:this.hasSelection});return}a(this,Ot).add(e),e.select(),w(this,W,Mn).call(this,e.propertiesToUpdate),w(this,W,He).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.id}),(t=a(this,Li))==null||t.commitOrRemove();for(const s of a(this,Ot))s!==e&&s.unselect();a(this,Ot).clear(),a(this,Ot).add(e),e.select(),w(this,W,Mn).call(this,e.propertiesToUpdate),w(this,W,He).call(this,{hasSelectedEditor:!0})}isSelected(e){return a(this,Ot).has(e)}get firstSelectedEditor(){return a(this,Ot).values().next().value}unselect(e){e.unselect(),a(this,Ot).delete(e),w(this,W,He).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return a(this,Ot).size!==0}get isEnterHandled(){return a(this,Ot).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;a(this,Is).undo(),w(this,W,He).call(this,{hasSomethingToUndo:a(this,Is).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:w(this,W,Pl).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){a(this,Is).redo(),w(this,W,He).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:a(this,Is).hasSomethingToRedo(),isEmpty:w(this,W,Pl).call(this)})}addCommands(e){a(this,Is).add(e),w(this,W,He).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:w(this,W,Pl).call(this)})}cleanUndoStack(e){a(this,Is).cleanType(e)}delete(){var i;this.commitOrRemove();const e=(i=this.currentLayer)==null?void 0:i.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...a(this,Ot)],s=()=>{var r;(r=this._editorUndoBar)==null||r.show(n,t.length===1?t[0].editorType:t.length);for(const o of t)o.remove()},n=()=>{for(const r of t)w(this,W,Fu).call(this,r)};this.addCommands({cmd:s,undo:n,mustExec:!0})}commitOrRemove(){var e;(e=a(this,ns))==null||e.commitOrRemove()}hasSomethingToControl(){return a(this,ns)||this.hasSelection}selectAll(){for(const e of a(this,Ot))e.commit();w(this,W,Bu).call(this,a(this,ue).values())}unselectAll(){var e;if(!(a(this,ns)&&(a(this,ns).commitOrRemove(),a(this,fe)!==ht.NONE))&&!((e=a(this,Li))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of a(this,Ot))t.unselect();a(this,Ot).clear(),w(this,W,He).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;a(this,Hi)[0]+=e,a(this,Hi)[1]+=t;const[n,i]=a(this,Hi),r=[...a(this,Ot)],o=1e3;a(this,an)&&clearTimeout(a(this,an)),g(this,an,setTimeout(()=>{g(this,an,null),a(this,Hi)[0]=a(this,Hi)[1]=0,this.addCommands({cmd:()=>{for(const l of r)a(this,ue).has(l.id)&&(l.translateInPage(n,i),l.translationDone())},undo:()=>{for(const l of r)a(this,ue).has(l.id)&&(l.translateInPage(-n,-i),l.translationDone())},mustExec:!1})},o));for(const l of r)l.translateInPage(e,t),l.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),g(this,sn,new Map);for(const e of a(this,Ot))a(this,sn).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!a(this,sn))return!1;this.disableUserSelect(!1);const e=a(this,sn);g(this,sn,null);let t=!1;for(const[{x:n,y:i,pageIndex:r},o]of e)o.newX=n,o.newY=i,o.newPageIndex=r,t||(t=n!==o.savedX||i!==o.savedY||r!==o.savedPageIndex);if(!t)return!1;const s=(n,i,r,o)=>{if(a(this,ue).has(n.id)){const l=a(this,Te).get(o);l?n._setParentAndPosition(l,i,r):(n.pageIndex=o,n.x=i,n.y=r)}};return this.addCommands({cmd:()=>{for(const[n,{newX:i,newY:r,newPageIndex:o}]of e)s(n,i,r,o)},undo:()=>{for(const[n,{savedX:i,savedY:r,savedPageIndex:o}]of e)s(n,i,r,o)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(a(this,sn))for(const s of a(this,sn).keys())s.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||a(this,Ot).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return a(this,ns)===e}getActive(){return a(this,ns)}getMode(){return a(this,fe)}get imageManager(){return At(this,"imageManager",new Mu)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let c=0,d=t.rangeCount;c<d;c++)if(!e.contains(t.getRangeAt(c).commonAncestorContainer))return null;const{x:s,y:n,width:i,height:r}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(c,d,u,f)=>({x:(d-n)/r,y:1-(c+u-s)/i,width:f/r,height:u/i});break;case"180":o=(c,d,u,f)=>({x:1-(c+u-s)/i,y:1-(d+f-n)/r,width:u/i,height:f/r});break;case"270":o=(c,d,u,f)=>({x:1-(d+f-n)/r,y:(c-s)/i,width:f/r,height:u/i});break;default:o=(c,d,u,f)=>({x:(c-s)/i,y:(d-n)/r,width:u/i,height:f/r});break}const l=[];for(let c=0,d=t.rangeCount;c<d;c++){const u=t.getRangeAt(c);if(!u.collapsed)for(const{x:f,y:p,width:m,height:v}of u.getClientRects())m===0||v===0||l.push(o(f,p,m,v))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:t}){(a(this,uo)||g(this,uo,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=a(this,uo))==null||t.delete(e)}renderAnnotationElement(e){var n;const t=(n=a(this,uo))==null?void 0:n.get(e.data.id);if(!t)return;const s=a(this,Fn).getRawValue(t);s&&(a(this,fe)===ht.NONE&&!s.hasBeenModified||s.renderAnnotationElement(e))}setMissingCanvas(e,t,s){var i;const n=(i=a(this,Fi))==null?void 0:i.get(e);n&&(n.setCanvas(t,s),a(this,Fi).delete(e))}addMissingCanvas(e,t){(a(this,Fi)||g(this,Fi,new Map)).set(e,t)}};lo=new WeakMap,ns=new WeakMap,co=new WeakMap,ue=new WeakMap,Te=new WeakMap,ho=new WeakMap,Fn=new WeakMap,uo=new WeakMap,Is=new WeakMap,Bn=new WeakMap,Mi=new WeakMap,Li=new WeakMap,fo=new WeakMap,Lr=new WeakMap,sn=new WeakMap,Rs=new WeakMap,Dr=new WeakMap,tc=new WeakMap,ec=new WeakMap,po=new WeakMap,sc=new WeakMap,nn=new WeakMap,Di=new WeakMap,go=new WeakMap,Oi=new WeakMap,rn=new WeakMap,Dd=new WeakMap,_i=new WeakMap,mo=new WeakMap,nc=new WeakMap,Ni=new WeakMap,Or=new WeakMap,vo=new WeakMap,Fi=new WeakMap,ic=new WeakMap,fe=new WeakMap,Ot=new WeakMap,$n=new WeakMap,Bi=new WeakMap,$i=new WeakMap,rc=new WeakMap,yo=new WeakMap,ac=new WeakMap,Hi=new WeakMap,an=new WeakMap,Hn=new WeakMap,oc=new WeakMap,lc=new WeakMap,ks=new WeakMap,W=new WeakSet,Gh=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},Du=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const s of a(this,Te).values())if(s.hasTextLayer(e))return s;return null},gg=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const s=w(this,W,Gh).call(this,e).closest(".textLayer"),n=this.getSelectionBoxes(s);n&&(a(this,rn)||g(this,rn,new Ww(this)),a(this,rn).show(s,n,this.direction==="ltr"))},mg=function(){var i,r,o;const e=document.getSelection();if(!e||e.isCollapsed){a(this,$n)&&((i=a(this,rn))==null||i.hide(),g(this,$n,null),w(this,W,He).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===a(this,$n))return;const n=w(this,W,Gh).call(this,e).closest(".textLayer");if(!n){a(this,$n)&&((r=a(this,rn))==null||r.hide(),g(this,$n,null),w(this,W,He).call(this,{hasSelectedText:!1}));return}if((o=a(this,rn))==null||o.hide(),g(this,$n,t),w(this,W,He).call(this,{hasSelectedText:!0}),!(a(this,fe)!==ht.HIGHLIGHT&&a(this,fe)!==ht.NONE)&&(a(this,fe)===ht.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),g(this,Oi,this.isShiftKeyDown),!this.isShiftKeyDown)){const l=a(this,fe)===ht.HIGHLIGHT?w(this,W,Du).call(this,n):null;if(l==null||l.toggleDrawing(),a(this,mo)){const c=new AbortController,d=this.combinedSignal(c),u=f=>{f.type==="pointerup"&&f.button!==0||(c.abort(),l==null||l.toggleDrawing(!0),f.type==="pointerup"&&w(this,W,Cl).call(this,"main_toolbar"))};window.addEventListener("pointerup",u,{signal:d}),window.addEventListener("blur",u,{signal:d})}else l==null||l.toggleDrawing(!0),w(this,W,Cl).call(this,"main_toolbar")}},Cl=function(e=""){a(this,fe)===ht.HIGHLIGHT?this.highlightSelection(e):a(this,tc)&&w(this,W,gg).call(this)},vg=function(){document.addEventListener("selectionchange",w(this,W,mg).bind(this),{signal:this._signal})},yg=function(){if(a(this,Di))return;g(this,Di,new AbortController);const e=this.combinedSignal(a(this,Di));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},bg=function(){var e;(e=a(this,Di))==null||e.abort(),g(this,Di,null)},Ou=function(){if(a(this,Ni))return;g(this,Ni,new AbortController);const e=this.combinedSignal(a(this,Ni));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},Ag=function(){var e;(e=a(this,Ni))==null||e.abort(),g(this,Ni,null)},_u=function(){if(a(this,Mi))return;g(this,Mi,new AbortController);const e=this.combinedSignal(a(this,Mi));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},Nu=function(){var e;(e=a(this,Mi))==null||e.abort(),g(this,Mi,null)},wg=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},He=function(e){Object.entries(e).some(([s,n])=>a(this,ac)[s]!==n)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(a(this,ac),e)}),a(this,fe)===ht.HIGHLIGHT&&e.hasSelectedEditor===!1&&w(this,W,Mn).call(this,[[Et.HIGHLIGHT_FREE,!0]]))},Mn=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},Sg=async function(){if(!a(this,_i)){g(this,_i,!0);const e=[];for(const t of a(this,Te).values())e.push(t.enable());await Promise.all(e);for(const t of a(this,ue).values())t.enable()}},Eg=function(){if(this.unselectAll(),a(this,_i)){g(this,_i,!1);for(const e of a(this,Te).values())e.disable();for(const e of a(this,ue).values())e.disable()}},Fu=function(e){const t=a(this,Te).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},Tg=function(){let e=null;for(e of a(this,Ot));return e},Pl=function(){if(a(this,ue).size===0)return!0;if(a(this,ue).size===1)for(const e of a(this,ue).values())return e.isEmpty();return!1},Bu=function(e){for(const t of a(this,Ot))t.unselect();a(this,Ot).clear();for(const t of e)t.isEmpty()||(a(this,Ot).add(t),t.select());w(this,W,He).call(this,{hasSelectedEditor:this.hasSelection})},U(eo,"TRANSLATE_SMALL",1),U(eo,"TRANSLATE_BIG",10);let Ba=eo;var ve,on,Vs,bo,ln,is,Ao,cn,Ze,Vn,_r,hn,Vi,Qs,Il,zh;const Ve=class Ve{constructor(e){b(this,Qs);b(this,ve,null);b(this,on,!1);b(this,Vs,null);b(this,bo,null);b(this,ln,null);b(this,is,null);b(this,Ao,!1);b(this,cn,null);b(this,Ze,null);b(this,Vn,null);b(this,_r,null);b(this,hn,!1);g(this,Ze,e),g(this,hn,e._uiManager.useNewAltTextFlow),a(Ve,Vi)||g(Ve,Vi,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){Ve._l10n??(Ve._l10n=e)}async render(){const e=g(this,Vs,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=g(this,bo,document.createElement("span"));e.append(t),a(this,hn)?(e.classList.add("new"),e.setAttribute("data-l10n-id",a(Ve,Vi).missing),t.setAttribute("data-l10n-id",a(Ve,Vi)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=a(this,Ze)._uiManager._signal;e.addEventListener("contextmenu",$s,{signal:s}),e.addEventListener("pointerdown",i=>i.stopPropagation(),{signal:s});const n=i=>{i.preventDefault(),a(this,Ze)._uiManager.editAltText(a(this,Ze)),a(this,hn)&&a(this,Ze)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:a(this,Qs,Il)}})};return e.addEventListener("click",n,{capture:!0,signal:s}),e.addEventListener("keydown",i=>{i.target===e&&i.key==="Enter"&&(g(this,Ao,!0),n(i))},{signal:s}),await w(this,Qs,zh).call(this),e}finish(){a(this,Vs)&&(a(this,Vs).focus({focusVisible:a(this,Ao)}),g(this,Ao,!1))}isEmpty(){return a(this,hn)?a(this,ve)===null:!a(this,ve)&&!a(this,on)}hasData(){return a(this,hn)?a(this,ve)!==null||!!a(this,Vn):this.isEmpty()}get guessedText(){return a(this,Vn)}async setGuessedText(e){a(this,ve)===null&&(g(this,Vn,e),g(this,_r,await Ve._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),w(this,Qs,zh).call(this))}toggleAltTextBadge(e=!1){var t;if(!a(this,hn)||a(this,ve)){(t=a(this,cn))==null||t.remove(),g(this,cn,null);return}if(!a(this,cn)){const s=g(this,cn,document.createElement("div"));s.className="noAltTextBadge",a(this,Ze).div.append(s)}a(this,cn).classList.toggle("hidden",!e)}serialize(e){let t=a(this,ve);return!e&&a(this,Vn)===t&&(t=a(this,_r)),{altText:t,decorative:a(this,on),guessedText:a(this,Vn),textWithDisclaimer:a(this,_r)}}get data(){return{altText:a(this,ve),decorative:a(this,on)}}set data({altText:e,decorative:t,guessedText:s,textWithDisclaimer:n,cancel:i=!1}){s&&(g(this,Vn,s),g(this,_r,n)),!(a(this,ve)===e&&a(this,on)===t)&&(i||(g(this,ve,e),g(this,on,t)),w(this,Qs,zh).call(this))}toggle(e=!1){a(this,Vs)&&(!e&&a(this,is)&&(clearTimeout(a(this,is)),g(this,is,null)),a(this,Vs).disabled=!e)}shown(){a(this,Ze)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:a(this,Qs,Il)}})}destroy(){var e,t;(e=a(this,Vs))==null||e.remove(),g(this,Vs,null),g(this,bo,null),g(this,ln,null),(t=a(this,cn))==null||t.remove(),g(this,cn,null)}};ve=new WeakMap,on=new WeakMap,Vs=new WeakMap,bo=new WeakMap,ln=new WeakMap,is=new WeakMap,Ao=new WeakMap,cn=new WeakMap,Ze=new WeakMap,Vn=new WeakMap,_r=new WeakMap,hn=new WeakMap,Vi=new WeakMap,Qs=new WeakSet,Il=function(){return a(this,ve)&&"added"||a(this,ve)===null&&this.guessedText&&"review"||"missing"},zh=async function(){var n,i,r;const e=a(this,Vs);if(!e)return;if(a(this,hn)){if(e.classList.toggle("done",!!a(this,ve)),e.setAttribute("data-l10n-id",a(Ve,Vi)[a(this,Qs,Il)]),(n=a(this,bo))==null||n.setAttribute("data-l10n-id",a(Ve,Vi)[`${a(this,Qs,Il)}-label`]),!a(this,ve)){(i=a(this,ln))==null||i.remove();return}}else{if(!a(this,ve)&&!a(this,on)){e.classList.remove("done"),(r=a(this,ln))==null||r.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=a(this,ln);if(!t){g(this,ln,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${a(this,Ze).id}`;const o=100,l=a(this,Ze)._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(a(this,is)),g(this,is,null)},{once:!0}),e.addEventListener("mouseenter",()=>{g(this,is,setTimeout(()=>{g(this,is,null),a(this,ln).classList.add("show"),a(this,Ze)._reportTelemetry({action:"alt_text_tooltip"})},o))},{signal:l}),e.addEventListener("mouseleave",()=>{var c;a(this,is)&&(clearTimeout(a(this,is)),g(this,is,null)),(c=a(this,ln))==null||c.classList.remove("show")},{signal:l})}a(this,on)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=a(this,ve)),t.parentNode||e.append(t);const s=a(this,Ze).getElementForAltText();s==null||s.setAttribute("aria-describedby",t.id)},b(Ve,Vi,null),U(Ve,"_l10n",null);let Ad=Ve;var dn,Nr,Us,cc,Un,wo,Ui;class Dh{constructor(e){b(this,dn,null);b(this,Nr,!1);b(this,Us,null);b(this,cc,null);b(this,Un,null);b(this,wo,null);b(this,Ui,!1);g(this,Us,e),this.toolbar=null}render(){if(!a(this,Us)._uiManager.hasCommentManager())return null;const e=g(this,dn,document.createElement("button"));e.className="comment",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button");const t=a(this,Us)._uiManager._signal;if(!(t instanceof AbortSignal)||t.aborted)return e;e.addEventListener("contextmenu",$s,{signal:t}),e.addEventListener("pointerdown",n=>n.stopPropagation(),{signal:t});const s=n=>{n.preventDefault(),this.edit()};return e.addEventListener("click",s,{capture:!0,signal:t}),e.addEventListener("keydown",n=>{n.target===e&&n.key==="Enter"&&(g(this,Nr,!0),s(n))},{signal:t}),e}edit(){const{bottom:e,left:t,right:s}=a(this,Us).getClientDimensions(),n={top:e};a(this,Us)._uiManager.direction==="ltr"?n.right=s:n.left=t,a(this,Us)._uiManager.editComment(a(this,Us),n)}finish(){a(this,dn)&&(a(this,dn).focus({focusVisible:a(this,Nr)}),g(this,Nr,!1))}isDeleted(){return a(this,Ui)||a(this,Un)===""}hasBeenEdited(){return this.isDeleted()||a(this,Un)!==a(this,cc)}serialize(){return this.data}get data(){return{text:a(this,Un),date:a(this,wo),deleted:a(this,Ui)}}set data(e){if(e===null){g(this,Un,""),g(this,Ui,!0);return}g(this,Un,e),g(this,wo,new Date),g(this,Ui,!1)}setInitialText(e){g(this,cc,e),this.data=e}toggle(e=!1){a(this,dn)&&(a(this,dn).disabled=!e)}shown(){}destroy(){var e;(e=a(this,dn))==null||e.remove(),g(this,dn,null),g(this,Un,""),g(this,wo,null),g(this,Us,null),g(this,Nr,!1),g(this,Ui,!1)}}dn=new WeakMap,Nr=new WeakMap,Us=new WeakMap,cc=new WeakMap,Un=new WeakMap,wo=new WeakMap,Ui=new WeakMap;var So,Fr,hc,dc,uc,fc,pc,jn,Br,Gn,$r,zn,Er,xg,Cg,Pg;const dp=class dp{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:s=null,onPinchStart:n=null,onPinching:i=null,onPinchEnd:r=null,signal:o}){b(this,Er);b(this,So);b(this,Fr,!1);b(this,hc,null);b(this,dc);b(this,uc);b(this,fc);b(this,pc);b(this,jn,null);b(this,Br);b(this,Gn,null);b(this,$r);b(this,zn,null);g(this,So,e),g(this,hc,s),g(this,dc,t),g(this,uc,n),g(this,fc,i),g(this,pc,r),g(this,$r,new AbortController),g(this,Br,AbortSignal.any([o,a(this,$r).signal])),e.addEventListener("touchstart",w(this,Er,xg).bind(this),{passive:!1,signal:a(this,Br)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Pn.pixelRatio}destroy(){var e,t;(e=a(this,$r))==null||e.abort(),g(this,$r,null),(t=a(this,jn))==null||t.abort(),g(this,jn,null)}};So=new WeakMap,Fr=new WeakMap,hc=new WeakMap,dc=new WeakMap,uc=new WeakMap,fc=new WeakMap,pc=new WeakMap,jn=new WeakMap,Br=new WeakMap,Gn=new WeakMap,$r=new WeakMap,zn=new WeakMap,Er=new WeakSet,xg=function(e){var n,i,r;if((n=a(this,dc))!=null&&n.call(this))return;if(e.touches.length===1){if(a(this,jn))return;const o=g(this,jn,new AbortController),l=AbortSignal.any([a(this,Br),o.signal]),c=a(this,So),d={capture:!0,signal:l,passive:!1},u=f=>{var p;f.pointerType==="touch"&&((p=a(this,jn))==null||p.abort(),g(this,jn,null))};c.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(ae(f),u(f))},d),c.addEventListener("pointerup",u,d),c.addEventListener("pointercancel",u,d);return}if(!a(this,zn)){g(this,zn,new AbortController);const o=AbortSignal.any([a(this,Br),a(this,zn).signal]),l=a(this,So),c={signal:o,capture:!1,passive:!1};l.addEventListener("touchmove",w(this,Er,Cg).bind(this),c);const d=w(this,Er,Pg).bind(this);l.addEventListener("touchend",d,c),l.addEventListener("touchcancel",d,c),c.capture=!0,l.addEventListener("pointerdown",ae,c),l.addEventListener("pointermove",ae,c),l.addEventListener("pointercancel",ae,c),l.addEventListener("pointerup",ae,c),(i=a(this,uc))==null||i.call(this)}if(ae(e),e.touches.length!==2||(r=a(this,hc))!=null&&r.call(this)){g(this,Gn,null);return}let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]),g(this,Gn,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:s.screenX,touch1Y:s.screenY})},Cg=function(e){var x;if(!a(this,Gn)||e.touches.length!==2)return;ae(e);let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]);const{screenX:n,screenY:i}=t,{screenX:r,screenY:o}=s,l=a(this,Gn),{touch0X:c,touch0Y:d,touch1X:u,touch1Y:f}=l,p=u-c,m=f-d,v=r-n,y=o-i,A=Math.hypot(v,y)||1,E=Math.hypot(p,m)||1;if(!a(this,Fr)&&Math.abs(E-A)<=dp.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=n,l.touch0Y=i,l.touch1X=r,l.touch1Y=o,!a(this,Fr)){g(this,Fr,!0);return}const S=[(n+r)/2,(i+o)/2];(x=a(this,fc))==null||x.call(this,S,E,A)},Pg=function(e){var t;e.touches.length>=2||(a(this,zn)&&(a(this,zn).abort(),g(this,zn,null),(t=a(this,pc))==null||t.call(this)),a(this,Gn)&&(ae(e),g(this,Gn,null),g(this,Fr,!1)))};let wd=dp;var Hr,js,Wt,xe,Eo,ji,gc,Vr,Ce,Ur,Wn,Gi,mc,jr,rs,vc,Gr,Xn,un,To,xo,Ms,zr,yc,Od,ot,$u,bc,Hu,Wh,Ig,Rg,Vu,Xh,Uu,kg,Mg,Lg,ju,Dg,Gu,Og,_g,Ng,zu,Rl;const vt=class vt{constructor(e){b(this,ot);b(this,Hr,null);b(this,js,null);b(this,Wt,null);b(this,xe,null);b(this,Eo,!1);b(this,ji,null);b(this,gc,"");b(this,Vr,!1);b(this,Ce,null);b(this,Ur,null);b(this,Wn,null);b(this,Gi,null);b(this,mc,"");b(this,jr,!1);b(this,rs,null);b(this,vc,!1);b(this,Gr,!1);b(this,Xn,!1);b(this,un,null);b(this,To,0);b(this,xo,0);b(this,Ms,null);b(this,zr,null);U(this,"isSelected",!1);U(this,"_isCopy",!1);U(this,"_editToolbar",null);U(this,"_initialOptions",Object.create(null));U(this,"_initialData",null);U(this,"_isVisible",!0);U(this,"_uiManager",null);U(this,"_focusEventsAllowed",!0);b(this,yc,!1);b(this,Od,vt._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null;const{rotation:t,rawDims:{pageWidth:s,pageHeight:n,pageX:i,pageY:r}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,n],this.pageTranslation=[i,r];const[o,l]=this.parentDimensions;this.x=e.x/o,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=vt.prototype._resizeWithKeyboard,t=Ba.TRANSLATE_SMALL,s=Ba.TRANSLATE_BIG;return At(this,"_resizerKeyboardManager",new Ih([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,s]}],[["Escape","mac+Escape"],vt.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return At(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new Kw({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(vt._l10n??(vt._l10n=e),vt._l10nResizer||(vt._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),vt._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);vt._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){$t("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return a(this,yc)}set _isDraggable(e){var t;g(this,yc,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=a(this,Od)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):w(this,ot,Rl).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(a(this,jr)?g(this,jr,!1):this.parent.setSelected(this))}focusout(e){var s;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(s=this.parent)!=null&&s.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,s,n){const[i,r]=this.parentDimensions;[s,n]=this.screenToPageTranslation(s,n),this.x=(e+s)/i,this.y=(t+n)/r,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[s,n]=this.parentDimensions;this.setAt(e*s,t*n,this.width*s,this.height*n),this._onTranslated()}translate(e,t){w(this,ot,$u).call(this,this.parentDimensions,e,t)}translateInPage(e,t){a(this,rs)||g(this,rs,[this.x,this.y,this.width,this.height]),w(this,ot,$u).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){a(this,rs)||g(this,rs,[this.x,this.y,this.width,this.height]);const{div:s,parentDimensions:[n,i]}=this;if(this.x+=e/n,this.y+=t/i,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:u,y:f}=this.div.getBoundingClientRect();this.parent.findNewParent(this,u,f)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:r,y:o}=this;const[l,c]=this.getBaseTranslation();r+=l,o+=c;const{style:d}=s;d.left=`${(100*r).toFixed(2)}%`,d.top=`${(100*o).toFixed(2)}%`,this._onTranslating(r,o),s.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!a(this,rs)&&(a(this,rs)[0]!==this.x||a(this,rs)[1]!==this.y)}get _hasBeenResized(){return!!a(this,rs)&&(a(this,rs)[2]!==this.width||a(this,rs)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:s}=vt,n=s/e,i=s/t;switch(this.rotation){case 90:return[-n,i];case 180:return[n,i];case 270:return[n,-i];default:return[-n,-i]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[s,n]}=this;let{x:i,y:r,width:o,height:l}=this;if(o*=s,l*=n,i*=s,r*=n,this._mustFixPosition)switch(e){case 0:i=Xe(i,0,s-o),r=Xe(r,0,n-l);break;case 90:i=Xe(i,0,s-l),r=Xe(r,o,n);break;case 180:i=Xe(i,o,s),r=Xe(r,l,n);break;case 270:i=Xe(i,l,s),r=Xe(r,0,n-o);break}this.x=i/=s,this.y=r/=n;const[c,d]=this.getBaseTranslation();i+=c,r+=d,t.left=`${(100*i).toFixed(2)}%`,t.top=`${(100*r).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var s;return w(s=vt,bc,Hu).call(s,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var s;return w(s=vt,bc,Hu).call(s,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,s]}=this;return[t*e,s*e]}setDims(e,t){const[s,n]=this.parentDimensions,{style:i}=this.div;i.width=`${(100*e/s).toFixed(2)}%`,a(this,Vr)||(i.height=`${(100*t/n).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:s}=e,n=s.endsWith("%"),i=!a(this,Vr)&&t.endsWith("%");if(n&&i)return;const[r,o]=this.parentDimensions;n||(e.width=`${(100*parseFloat(s)/r).toFixed(2)}%`),!a(this,Vr)&&!i&&(e.height=`${(100*parseFloat(t)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=a(this,Wt))==null||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||a(this,Gr))return this._editToolbar;this._editToolbar=new Ru(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,s]of e)await this._editToolbar.addButton(t,s);return this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(e=a(this,Wt))==null||e.destroy())}addContainer(e){var s;const t=(s=this._editToolbar)==null?void 0:s.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return a(this,Wt)||(Ad.initialize(vt._l10n),g(this,Wt,new Ad(this)),a(this,Hr)&&(a(this,Wt).data=a(this,Hr),g(this,Hr,null))),a(this,Wt)}get altTextData(){var e;return(e=a(this,Wt))==null?void 0:e.data}set altTextData(e){a(this,Wt)&&(a(this,Wt).data=e)}get guessedAltText(){var e;return(e=a(this,Wt))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=a(this,Wt))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=a(this,Wt))==null?void 0:t.serialize(e)}hasAltText(){return!!a(this,Wt)&&!a(this,Wt).isEmpty()}hasAltTextData(){var e;return((e=a(this,Wt))==null?void 0:e.hasData())??!1}addCommentButton(){return a(this,xe)?a(this,xe):g(this,xe,new Dh(this))}get commentColor(){return null}get comment(){const e=a(this,xe);return{text:e.data.text,date:e.data.date,deleted:e.isDeleted(),color:this.commentColor}}set comment(e){a(this,xe)||g(this,xe,new Dh(this)),a(this,xe).data=e}setCommentData(e){a(this,xe)||g(this,xe,new Dh(this)),a(this,xe).setInitialText(e)}get hasEditedComment(){var e;return(e=a(this,xe))==null?void 0:e.hasBeenEdited()}async editComment(){a(this,xe)||g(this,xe,new Dh(this)),a(this,xe).edit()}addComment(e){if(this.hasEditedComment){const[,,,n]=e.rect,[i]=this.pageDimensions,[r]=this.pageTranslation,o=r+i+1,l=n-100,c=o+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[o,l,c,n]}}}render(){var r;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=a(this,Eo)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),w(this,ot,Gu).call(this);const[t,s]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*s/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/s).toFixed(2)}%`);const[n,i]=this.getInitialTranslation();return this.translate(n,i),fg(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(a(this,zr)||g(this,zr,new wd({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:w(this,ot,kg).bind(this),onPinching:w(this,ot,Mg).bind(this),onPinchEnd:w(this,ot,Lg).bind(this),signal:this._uiManager._signal}))),(r=this._uiManager._editorUndoBar)==null||r.hide(),e}pointerdown(e){const{isMac:t}=De.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(g(this,jr,!0),this._isDraggable){w(this,ot,Dg).call(this,e);return}w(this,ot,ju).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){a(this,un)&&clearTimeout(a(this,un)),g(this,un,setTimeout(()=>{var e;g(this,un,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,s){e.changeParent(this),this.x=t,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,s=this.rotation){const n=this.parentScale,[i,r]=this.pageDimensions,[o,l]=this.pageTranslation,c=e/n,d=t/n,u=this.x*i,f=this.y*r,p=this.width*i,m=this.height*r;switch(s){case 0:return[u+c+o,r-f-d-m+l,u+c+p+o,r-f-d+l];case 90:return[u+d+o,r-f+c+l,u+d+m+o,r-f+c+p+l];case 180:return[u-c-p+o,r-f+d+l,u-c+o,r-f+d+m+l];case 270:return[u-d-m+o,r-f-c-p+l,u-d+o,r-f-c+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[s,n,i,r]=e,o=i-s,l=r-n;switch(this.rotation){case 0:return[s,t-r,o,l];case 90:return[s,t-n,l,o];case 180:return[i,t-n,o,l];case 270:return[i,t-r,l,o];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),g(this,Gr,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),g(this,Gr,!1),!0):!1}isInEditMode(){return a(this,Gr)}shouldGetKeyboardEvents(){return a(this,Xn)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:s,right:n}=this.getClientDimensions(),{innerHeight:i,innerWidth:r}=window;return t<r&&n>0&&e<i&&s>0}rebuild(){w(this,ot,Gu).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){$t("An editor must be serializable")}static async deserialize(e,t,s){const n=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:s,annotationElementId:e.annotationElementId});n.rotation=e.rotation,g(n,Hr,e.accessibilityData),n._isCopy=e.isCopy||!1;const[i,r]=n.pageDimensions,[o,l,c,d]=n.getRectInCurrentCoords(e.rect,r);return n.x=o/i,n.y=l/r,n.width=c/i,n.height=d/r,n}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=a(this,Gi))==null||e.abort(),g(this,Gi,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),a(this,un)&&(clearTimeout(a(this,un)),g(this,un,null)),w(this,ot,Rl).call(this),this.removeEditToolbar(),a(this,Ms)){for(const s of a(this,Ms).values())clearTimeout(s);g(this,Ms,null)}this.parent=null,(t=a(this,zr))==null||t.destroy(),g(this,zr,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(w(this,ot,Ig).call(this),a(this,Ce).classList.remove("hidden"))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),g(this,Wn,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=a(this,Ce).children;if(!a(this,js)){g(this,js,Array.from(t));const r=w(this,ot,Og).bind(this),o=w(this,ot,_g).bind(this),l=this._uiManager._signal;for(const c of a(this,js)){const d=c.getAttribute("data-resizer-name");c.setAttribute("role","spinbutton"),c.addEventListener("keydown",r,{signal:l}),c.addEventListener("blur",o,{signal:l}),c.addEventListener("focus",w(this,ot,Ng).bind(this,d),{signal:l}),c.setAttribute("data-l10n-id",vt._l10nResizer[d])}}const s=a(this,js)[0];let n=0;for(const r of t){if(r===s)break;n++}const i=(360-this.rotation+this.parentRotation)%360/90*(a(this,js).length/4);if(i!==n){if(i<n)for(let o=0;o<n-i;o++)a(this,Ce).append(a(this,Ce).firstChild);else if(i>n)for(let o=0;o<i-n;o++)a(this,Ce).firstChild.before(a(this,Ce).lastChild);let r=0;for(const o of t){const c=a(this,js)[r++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",vt._l10nResizer[c])}}w(this,ot,zu).call(this,0),g(this,Xn,!0),a(this,Ce).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){a(this,Xn)&&w(this,ot,Uu).call(this,a(this,mc),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){w(this,ot,Rl).call(this),this.div.focus()}select(){var e,t,s;if(!(this.isSelected&&this._editToolbar)){if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var n,i;(n=this.div)!=null&&n.classList.contains("selectedEditor")&&((i=this._editToolbar)==null||i.show())});return}(t=this._editToolbar)==null||t.show(),(s=a(this,Wt))==null||s.toggleAltTextBadge(!1)}}unselect(){var e,t,s,n,i;this.isSelected&&(this.isSelected=!1,(e=a(this,Ce))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(s=this.div)!=null&&s.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(n=this._editToolbar)==null||n.hide(),(i=a(this,Wt))==null||i.toggleAltTextBadge(!0))}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return a(this,vc)}set isEditing(e){g(this,vc,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){g(this,Vr,!0);const s=e/t,{style:n}=this.div;n.aspectRatio=s,n.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){a(this,Ms)||g(this,Ms,new Map);const{action:s}=e;let n=a(this,Ms).get(s);n&&clearTimeout(n),n=setTimeout(()=>{this._reportTelemetry(e),a(this,Ms).delete(s),a(this,Ms).size===0&&g(this,Ms,null)},vt._telemetryTimeout),a(this,Ms).set(s,n);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),g(this,Eo,!1)}disable(){this.div&&(this.div.tabIndex=-1),g(this,Eo,!0)}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const s=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),s.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};Hr=new WeakMap,js=new WeakMap,Wt=new WeakMap,xe=new WeakMap,Eo=new WeakMap,ji=new WeakMap,gc=new WeakMap,Vr=new WeakMap,Ce=new WeakMap,Ur=new WeakMap,Wn=new WeakMap,Gi=new WeakMap,mc=new WeakMap,jr=new WeakMap,rs=new WeakMap,vc=new WeakMap,Gr=new WeakMap,Xn=new WeakMap,un=new WeakMap,To=new WeakMap,xo=new WeakMap,Ms=new WeakMap,zr=new WeakMap,yc=new WeakMap,Od=new WeakMap,ot=new WeakSet,$u=function([e,t],s,n){[s,n]=this.screenToPageTranslation(s,n),this.x+=s/e,this.y+=n/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},bc=new WeakSet,Hu=function(e,t,s){switch(s){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},Wh=function(e){switch(e){case 90:{const[t,s]=this.pageDimensions;return[0,-t/s,s/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,s]=this.pageDimensions;return[0,t/s,-s/t,0]}default:return[1,0,0,1]}},Ig=function(){if(a(this,Ce))return;g(this,Ce,document.createElement("div")),a(this,Ce).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const s of e){const n=document.createElement("div");a(this,Ce).append(n),n.classList.add("resizer",s),n.setAttribute("data-resizer-name",s),n.addEventListener("pointerdown",w(this,ot,Rg).bind(this,s),{signal:t}),n.addEventListener("contextmenu",$s,{signal:t}),n.tabIndex=-1}this.div.prepend(a(this,Ce))},Rg=function(e,t){var d;t.preventDefault();const{isMac:s}=De.platform;if(t.button!==0||t.ctrlKey&&s)return;(d=a(this,Wt))==null||d.toggle(!1);const n=this._isDraggable;this._isDraggable=!1,g(this,Ur,[t.screenX,t.screenY]);const i=new AbortController,r=this._uiManager.combinedSignal(i);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",w(this,ot,Uu).bind(this,e),{passive:!0,capture:!0,signal:r}),window.addEventListener("touchmove",ae,{passive:!1,signal:r}),window.addEventListener("contextmenu",$s,{signal:r}),g(this,Wn,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const c=()=>{var u;i.abort(),this.parent.togglePointerEvents(!0),(u=a(this,Wt))==null||u.toggle(!0),this._isDraggable=n,this.parent.div.style.cursor=o,this.div.style.cursor=l,w(this,ot,Xh).call(this)};window.addEventListener("pointerup",c,{signal:r}),window.addEventListener("blur",c,{signal:r})},Vu=function(e,t,s,n){this.width=s,this.height=n,this.x=e,this.y=t;const[i,r]=this.parentDimensions;this.setDims(i*s,r*n),this.fixAndSetPosition(),this._onResized()},Xh=function(){if(!a(this,Wn))return;const{savedX:e,savedY:t,savedWidth:s,savedHeight:n}=a(this,Wn);g(this,Wn,null);const i=this.x,r=this.y,o=this.width,l=this.height;i===e&&r===t&&o===s&&l===n||this.addCommands({cmd:w(this,ot,Vu).bind(this,i,r,o,l),undo:w(this,ot,Vu).bind(this,e,t,s,n),mustExec:!0})},Uu=function(e,t){const[s,n]=this.parentDimensions,i=this.x,r=this.y,o=this.width,l=this.height,c=vt.MIN_SIZE/s,d=vt.MIN_SIZE/n,u=w(this,ot,Wh).call(this,this.rotation),f=(j,F)=>[u[0]*j+u[2]*F,u[1]*j+u[3]*F],p=w(this,ot,Wh).call(this,360-this.rotation),m=(j,F)=>[p[0]*j+p[2]*F,p[1]*j+p[3]*F];let v,y,A=!1,E=!1;switch(e){case"topLeft":A=!0,v=(j,F)=>[0,0],y=(j,F)=>[j,F];break;case"topMiddle":v=(j,F)=>[j/2,0],y=(j,F)=>[j/2,F];break;case"topRight":A=!0,v=(j,F)=>[j,0],y=(j,F)=>[0,F];break;case"middleRight":E=!0,v=(j,F)=>[j,F/2],y=(j,F)=>[0,F/2];break;case"bottomRight":A=!0,v=(j,F)=>[j,F],y=(j,F)=>[0,0];break;case"bottomMiddle":v=(j,F)=>[j/2,F],y=(j,F)=>[j/2,0];break;case"bottomLeft":A=!0,v=(j,F)=>[0,F],y=(j,F)=>[j,0];break;case"middleLeft":E=!0,v=(j,F)=>[0,F/2],y=(j,F)=>[j,F/2];break}const S=v(o,l),x=y(o,l);let T=f(...x);const C=vt._round(i+T[0]),P=vt._round(r+T[1]);let k=1,R=1,L,D;if(t.fromKeyboard)({deltaX:L,deltaY:D}=t);else{const{screenX:j,screenY:F}=t,[nt,ct]=a(this,Ur);[L,D]=this.screenToPageTranslation(j-nt,F-ct),a(this,Ur)[0]=j,a(this,Ur)[1]=F}if([L,D]=m(L/s,D/n),A){const j=Math.hypot(o,l);k=R=Math.max(Math.min(Math.hypot(x[0]-S[0]-L,x[1]-S[1]-D)/j,1/o,1/l),c/o,d/l)}else E?k=Xe(Math.abs(x[0]-S[0]-L),c,1)/o:R=Xe(Math.abs(x[1]-S[1]-D),d,1)/l;const H=vt._round(o*k),V=vt._round(l*R);T=f(...y(H,V));const G=C-T[0],q=P-T[1];a(this,rs)||g(this,rs,[this.x,this.y,this.width,this.height]),this.width=H,this.height=V,this.x=G,this.y=q,this.setDims(s*H,n*V),this.fixAndSetPosition(),this._onResizing()},kg=function(){var e;g(this,Wn,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=a(this,Wt))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},Mg=function(e,t,s){let i=.7*(s/t)+1-.7;if(i===1)return;const r=w(this,ot,Wh).call(this,this.rotation),o=(C,P)=>[r[0]*C+r[2]*P,r[1]*C+r[3]*P],[l,c]=this.parentDimensions,d=this.x,u=this.y,f=this.width,p=this.height,m=vt.MIN_SIZE/l,v=vt.MIN_SIZE/c;i=Math.max(Math.min(i,1/f,1/p),m/f,v/p);const y=vt._round(f*i),A=vt._round(p*i);if(y===f&&A===p)return;a(this,rs)||g(this,rs,[d,u,f,p]);const E=o(f/2,p/2),S=vt._round(d+E[0]),x=vt._round(u+E[1]),T=o(y/2,A/2);this.x=S-T[0],this.y=x-T[1],this.width=y,this.height=A,this.setDims(l*y,c*A),this.fixAndSetPosition(),this._onResizing()},Lg=function(){var e;(e=a(this,Wt))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),w(this,ot,Xh).call(this)},ju=function(e){const{isMac:t}=De.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},Dg=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let s=!1;const n=new AbortController,i=this._uiManager.combinedSignal(n),r={capture:!0,passive:!1,signal:i},o=c=>{n.abort(),g(this,ji,null),g(this,jr,!1),this._uiManager.endDragSession()||w(this,ot,ju).call(this,c),s&&this._onStopDragging()};t&&(g(this,To,e.clientX),g(this,xo,e.clientY),g(this,ji,e.pointerId),g(this,gc,e.pointerType),window.addEventListener("pointermove",c=>{s||(s=!0,this._onStartDragging());const{clientX:d,clientY:u,pointerId:f}=c;if(f!==a(this,ji)){ae(c);return}const[p,m]=this.screenToPageTranslation(d-a(this,To),u-a(this,xo));g(this,To,d),g(this,xo,u),this._uiManager.dragSelectedEditors(p,m)},r),window.addEventListener("touchmove",ae,r),window.addEventListener("pointerdown",c=>{c.pointerType===a(this,gc)&&(a(this,zr)||c.isPrimary)&&o(c),ae(c)},r));const l=c=>{if(!a(this,ji)||a(this,ji)===c.pointerId){o(c);return}ae(c)};window.addEventListener("pointerup",l,{signal:i}),window.addEventListener("blur",l,{signal:i})},Gu=function(){if(a(this,Gi)||!this.div)return;g(this,Gi,new AbortController);const e=this._uiManager.combinedSignal(a(this,Gi));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},Og=function(e){vt._resizerKeyboardManager.exec(this,e)},_g=function(e){var t;a(this,Xn)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==a(this,Ce)&&w(this,ot,Rl).call(this)},Ng=function(e){g(this,mc,a(this,Xn)?e:"")},zu=function(e){if(a(this,js))for(const t of a(this,js))t.tabIndex=e},Rl=function(){g(this,Xn,!1),w(this,ot,zu).call(this,-1),w(this,ot,Xh).call(this)},b(vt,bc),U(vt,"_l10n",null),U(vt,"_l10nResizer",null),U(vt,"_borderLineWidth",-1),U(vt,"_colorManager",new Lu),U(vt,"_zIndex",1),U(vt,"_telemetryTimeout",1e3);let Vt=vt;class Kw extends Vt{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Tp=3285377520,xs=4294901760,tn=65535;class Fg{constructor(e){this.h1=e?e&4294967295:Tp,this.h2=e?e&4294967295:Tp}update(e){let t,s;if(typeof e=="string"){t=new Uint8Array(e.length*2),s=0;for(let v=0,y=e.length;v<y;v++){const A=e.charCodeAt(v);A<=255?t[s++]=A:(t[s++]=A>>>8,t[s++]=A&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),s=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const n=s>>2,i=s-n*4,r=new Uint32Array(t.buffer,0,n);let o=0,l=0,c=this.h1,d=this.h2;const u=3432918353,f=461845907,p=u&tn,m=f&tn;for(let v=0;v<n;v++)v&1?(o=r[v],o=o*u&xs|o*p&tn,o=o<<15|o>>>17,o=o*f&xs|o*m&tn,c^=o,c=c<<13|c>>>19,c=c*5+3864292196):(l=r[v],l=l*u&xs|l*p&tn,l=l<<15|l>>>17,l=l*f&xs|l*m&tn,d^=l,d=d<<13|d>>>19,d=d*5+3864292196);switch(o=0,i){case 3:o^=t[n*4+2]<<16;case 2:o^=t[n*4+1]<<8;case 1:o^=t[n*4],o=o*u&xs|o*p&tn,o=o<<15|o>>>17,o=o*f&xs|o*m&tn,n&1?c^=o:d^=o}this.h1=c,this.h2=d}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&xs|e*36045&tn,t=t*4283543511&xs|((t<<16|e>>>16)*2950163797&xs)>>>16,e^=t>>>1,e=e*444984403&xs|e*60499&tn,t=t*3301882366&xs|((t<<16|e>>>16)*3120437893&xs)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const Wu=Object.freeze({map:null,hash:"",transfer:void 0});var Wr,Xr,Pe,_d,Bg;class np{constructor(){b(this,_d);b(this,Wr,!1);b(this,Xr,null);b(this,Pe,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const s=a(this,Pe).get(e);return s===void 0?t:Object.assign(t,s)}getRawValue(e){return a(this,Pe).get(e)}remove(e){if(a(this,Pe).delete(e),a(this,Pe).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of a(this,Pe).values())if(t instanceof Vt)return;this.onAnnotationEditor(null)}}setValue(e,t){const s=a(this,Pe).get(e);let n=!1;if(s!==void 0)for(const[i,r]of Object.entries(t))s[i]!==r&&(n=!0,s[i]=r);else n=!0,a(this,Pe).set(e,t);n&&w(this,_d,Bg).call(this),t instanceof Vt&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return a(this,Pe).has(e)}get size(){return a(this,Pe).size}resetModified(){a(this,Wr)&&(g(this,Wr,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new $g(this)}get serializable(){if(a(this,Pe).size===0)return Wu;const e=new Map,t=new Fg,s=[],n=Object.create(null);let i=!1;for(const[r,o]of a(this,Pe)){const l=o instanceof Vt?o.serialize(!1,n):o;l&&(e.set(r,l),t.update(`${r}:${JSON.stringify(l)}`),i||(i=!!l.bitmap))}if(i)for(const r of e.values())r.bitmap&&s.push(r.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:s}:Wu}get editorStats(){let e=null;const t=new Map;for(const s of a(this,Pe).values()){if(!(s instanceof Vt))continue;const n=s.telemetryFinalData;if(!n)continue;const{type:i}=n;t.has(i)||t.set(i,Object.getPrototypeOf(s).constructor),e||(e=Object.create(null));const r=e[i]||(e[i]=new Map);for(const[o,l]of Object.entries(n)){if(o==="type")continue;let c=r.get(o);c||(c=new Map,r.set(o,c));const d=c.get(l)??0;c.set(l,d+1)}}for(const[s,n]of t)e[s]=n.computeTelemetryFinalData(e[s]);return e}resetModifiedIds(){g(this,Xr,null)}get modifiedIds(){if(a(this,Xr))return a(this,Xr);const e=[];for(const t of a(this,Pe).values())!(t instanceof Vt)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return g(this,Xr,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return a(this,Pe).entries()}}Wr=new WeakMap,Xr=new WeakMap,Pe=new WeakMap,_d=new WeakSet,Bg=function(){a(this,Wr)||(g(this,Wr,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var Ac;class $g extends np{constructor(t){super();b(this,Ac);const{map:s,hash:n,transfer:i}=t.serializable,r=structuredClone(s,i?{transfer:i}:null);g(this,Ac,{map:r,hash:n,transfer:i})}get print(){$t("Should not call PrintAnnotationStorage.print")}get serializable(){return a(this,Ac)}get modifiedIds(){return At(this,"modifiedIds",{ids:new Set,hash:""})}}Ac=new WeakMap;var Co;class Jw{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){b(this,Co,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),a(this,Co).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:s}){if(!(!e||a(this,Co).has(e.loadedName))){if(oe(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:n,src:i,style:r}=e,o=new FontFace(n,i,r);this.addNativeFontFace(o);try{await o.load(),a(this,Co).add(n),s==null||s(e)}catch{lt(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}$t("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const s=e.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(n){throw lt(`Failed to load font '${s.family}': '${n}'.`),e.disableFontFace=!0,n}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const n=this._queueLoadingCallback(s);this._prepareFontLoadEvent(e,n)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return At(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return At(this,"isSyncFontLoadingSupported",We||De.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(oe(!n.done,"completeRequest() cannot be called twice."),n.done=!0;s.length>0&&s[0].done;){const i=s.shift();setTimeout(i.callback,0)}}const{loadingRequests:s}=this,n={done:!1,complete:t,callback:e};return s.push(n),n}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return At(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function s(x,T){return x.charCodeAt(T)<<24|x.charCodeAt(T+1)<<16|x.charCodeAt(T+2)<<8|x.charCodeAt(T+3)&255}function n(x,T,C,P){const k=x.substring(0,T),R=x.substring(T+C);return k+P+R}let i,r;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let c=0;function d(x,T){if(++c>30){lt("Load test font never loaded."),T();return}if(l.font="30px "+x,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){T();return}setTimeout(d.bind(null,x,T))}const u=`lt${Date.now()}${this.loadTestFontId++}`;let f=this._loadTestFont;f=n(f,976,u.length,u);const m=16,v=1482184792;let y=s(f,m);for(i=0,r=u.length-3;i<r;i+=4)y=y-v+s(u,i)|0;i<u.length&&(y=y-v+s(u+"XXX",i)|0),f=n(f,m,4,Ow(y));const A=`url(data:font/opentype;base64,${btoa(f)});`,E=`@font-face {font-family:"${u}";src:${A}}`;this.insertRule(E);const S=this._document.createElement("div");S.style.visibility="hidden",S.style.width=S.style.height="10px",S.style.position="absolute",S.style.top=S.style.left="0px";for(const x of[e.loadedName,u]){const T=this._document.createElement("span");T.textContent="Hi",T.style.fontFamily=x,S.append(T)}this._document.body.append(S),d(u,()=>{S.remove(),t.complete()})}}Co=new WeakMap;class Qw{constructor(e,t=null){this.compiledGlyphs=Object.create(null);for(const s in e)this[s]=e[s];this._inspectFont=t}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const s={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(s.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,s)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var s;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${og(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${e}}`}return(s=this._inspectFont)==null||s.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const s=this.loadedName+"_path_"+t;let n;try{n=e.get(s)}catch(r){lt(`getPathGenerator - ignoring character: "${r}".`)}const i=new Path2D(n||"");return this.fontExtraProperties||e.delete(s),this.compiledGlyphs[t]=i}}function Zw(h){if(h instanceof URL)return h.href;if(typeof h=="string"){if(We)return h;const e=URL.parse(h,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function qw(h){if(We&&typeof Buffer<"u"&&h instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(h instanceof Uint8Array&&h.byteLength===h.buffer.byteLength)return h;if(typeof h=="string")return xh(h);if(h instanceof ArrayBuffer||ArrayBuffer.isView(h)||typeof h=="object"&&!isNaN(h==null?void 0:h.length))return new Uint8Array(h);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Oh(h){if(typeof h!="string")return null;if(h.endsWith("/"))return h;throw new Error(`Invalid factory url: "${h}" must include trailing slash.`)}const Xu=h=>typeof h=="object"&&Number.isInteger(h==null?void 0:h.num)&&h.num>=0&&Number.isInteger(h==null?void 0:h.gen)&&h.gen>=0,tS=h=>typeof h=="object"&&typeof(h==null?void 0:h.name)=="string",eS=$w.bind(null,Xu,tS);var Yn,Nd;class sS{constructor(){b(this,Yn,new Map);b(this,Nd,Promise.resolve())}postMessage(e,t){const s={data:structuredClone(e,t?{transfer:t}:null)};a(this,Nd).then(()=>{for(const[n]of a(this,Yn))n.call(this,s)})}addEventListener(e,t,s=null){let n=null;if((s==null?void 0:s.signal)instanceof AbortSignal){const{signal:i}=s;if(i.aborted){lt("LoopbackPort - cannot use an `aborted` signal.");return}const r=()=>this.removeEventListener(e,t);n=()=>i.removeEventListener("abort",r),i.addEventListener("abort",r)}a(this,Yn).set(t,n)}removeEventListener(e,t){const s=a(this,Yn).get(t);s==null||s(),a(this,Yn).delete(t)}terminate(){for(const[,e]of a(this,Yn))e==null||e();a(this,Yn).clear()}}Yn=new WeakMap,Nd=new WeakMap;const _h={DATA:1,ERROR:2},ie={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function xp(){}function Je(h){if(h instanceof wr||h instanceof Cu||h instanceof wp||h instanceof yd||h instanceof fu)return h;switch(h instanceof Error||typeof h=="object"&&h!==null||$t('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),h.name){case"AbortException":return new wr(h.message);case"InvalidPDFException":return new Cu(h.message);case"PasswordException":return new wp(h.message,h.code);case"ResponseException":return new yd(h.message,h.status,h.missing);case"UnknownErrorException":return new fu(h.message,h.details)}return new fu(h.message,h.toString())}var Po,Bs,Hg,Vg,Ug,Yh;class kl{constructor(e,t,s){b(this,Bs);b(this,Po,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",w(this,Bs,Hg).bind(this),{signal:a(this,Po).signal})}on(e,t){const s=this.actionHandler;if(s[e])throw new Error(`There is already an actionName called "${e}"`);s[e]=t}send(e,t,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},s)}sendWithPromise(e,t,s){const n=this.callbackId++,i=Promise.withResolvers();this.callbackCapabilities[n]=i;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:n,data:t},s)}catch(r){i.reject(r)}return i.promise}sendWithStream(e,t,s,n){const i=this.streamId++,r=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:c=>{const d=Promise.withResolvers();return this.streamControllers[i]={controller:c,startCall:d,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:r,targetName:o,action:e,streamId:i,data:t,desiredSize:c.desiredSize},n),d.promise},pull:c=>{const d=Promise.withResolvers();return this.streamControllers[i].pullCall=d,l.postMessage({sourceName:r,targetName:o,stream:ie.PULL,streamId:i,desiredSize:c.desiredSize}),d.promise},cancel:c=>{oe(c instanceof Error,"cancel must have a valid reason");const d=Promise.withResolvers();return this.streamControllers[i].cancelCall=d,this.streamControllers[i].isClosed=!0,l.postMessage({sourceName:r,targetName:o,stream:ie.CANCEL,streamId:i,reason:Je(c)}),d.promise}},s)}destroy(){var e;(e=a(this,Po))==null||e.abort(),g(this,Po,null)}}Po=new WeakMap,Bs=new WeakSet,Hg=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){w(this,Bs,Ug).call(this,e);return}if(e.callback){const s=e.callbackId,n=this.callbackCapabilities[s];if(!n)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],e.callback===_h.DATA)n.resolve(e.data);else if(e.callback===_h.ERROR)n.reject(Je(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const s=this.sourceName,n=e.sourceName,i=this.comObj;Promise.try(t,e.data).then(function(r){i.postMessage({sourceName:s,targetName:n,callback:_h.DATA,callbackId:e.callbackId,data:r})},function(r){i.postMessage({sourceName:s,targetName:n,callback:_h.ERROR,callbackId:e.callbackId,reason:Je(r)})});return}if(e.streamId){w(this,Bs,Vg).call(this,e);return}t(e.data)},Vg=function(e){const t=e.streamId,s=this.sourceName,n=e.sourceName,i=this.comObj,r=this,o=this.actionHandler[e.action],l={enqueue(c,d=1,u){if(this.isCancelled)return;const f=this.desiredSize;this.desiredSize-=d,f>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),i.postMessage({sourceName:s,targetName:n,stream:ie.ENQUEUE,streamId:t,chunk:c},u)},close(){this.isCancelled||(this.isCancelled=!0,i.postMessage({sourceName:s,targetName:n,stream:ie.CLOSE,streamId:t}),delete r.streamSinks[t])},error(c){oe(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,i.postMessage({sourceName:s,targetName:n,stream:ie.ERROR,streamId:t,reason:Je(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(o,e.data,l).then(function(){i.postMessage({sourceName:s,targetName:n,stream:ie.START_COMPLETE,streamId:t,success:!0})},function(c){i.postMessage({sourceName:s,targetName:n,stream:ie.START_COMPLETE,streamId:t,reason:Je(c)})})},Ug=function(e){const t=e.streamId,s=this.sourceName,n=e.sourceName,i=this.comObj,r=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case ie.START_COMPLETE:e.success?r.startCall.resolve():r.startCall.reject(Je(e.reason));break;case ie.PULL_COMPLETE:e.success?r.pullCall.resolve():r.pullCall.reject(Je(e.reason));break;case ie.PULL:if(!o){i.postMessage({sourceName:s,targetName:n,stream:ie.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||xp).then(function(){i.postMessage({sourceName:s,targetName:n,stream:ie.PULL_COMPLETE,streamId:t,success:!0})},function(c){i.postMessage({sourceName:s,targetName:n,stream:ie.PULL_COMPLETE,streamId:t,reason:Je(c)})});break;case ie.ENQUEUE:if(oe(r,"enqueue should have stream controller"),r.isClosed)break;r.controller.enqueue(e.chunk);break;case ie.CLOSE:if(oe(r,"close should have stream controller"),r.isClosed)break;r.isClosed=!0,r.controller.close(),w(this,Bs,Yh).call(this,r,t);break;case ie.ERROR:oe(r,"error should have stream controller"),r.controller.error(Je(e.reason)),w(this,Bs,Yh).call(this,r,t);break;case ie.CANCEL_COMPLETE:e.success?r.cancelCall.resolve():r.cancelCall.reject(Je(e.reason)),w(this,Bs,Yh).call(this,r,t);break;case ie.CANCEL:if(!o)break;const l=Je(e.reason);Promise.try(o.onCancel||xp,l).then(function(){i.postMessage({sourceName:s,targetName:n,stream:ie.CANCEL_COMPLETE,streamId:t,success:!0})},function(c){i.postMessage({sourceName:s,targetName:n,stream:ie.CANCEL_COMPLETE,streamId:t,reason:Je(c)})}),o.sinkCapability.reject(l),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},Yh=async function(e,t){var s,n,i;await Promise.allSettled([(s=e.startCall)==null?void 0:s.promise,(n=e.pullCall)==null?void 0:n.promise,(i=e.cancelCall)==null?void 0:i.promise]),delete this.streamControllers[t]};var wc;class jg{constructor({enableHWA:e=!1}){b(this,wc,!1);g(this,wc,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(e,t);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!a(this,wc)})}}reset(e,t,s){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||s<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=s}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){$t("Abstract method `_createCanvas` called.")}}wc=new WeakMap;class nS extends jg{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const s=this._document.createElement("canvas");return s.width=e,s.height=t,s}}class Gg{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){$t("Abstract method `_fetch` called.")}}class Cp extends Gg{async _fetch(e){const t=await Ch(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):xh(t)}}gt(2489);class zg{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,s,n,i){return"none"}destroy(e=!1){}}var Yr,Io,Kn,Jn,Ne,Kr,Jr,K,Oe,Ml,Ya,Kh,Ka,Wg,Yu,Ja,Ll,Dl,Ku,Ol;class iS extends zg{constructor({docId:t,ownerDocument:s=globalThis.document}){super();b(this,K);b(this,Yr);b(this,Io);b(this,Kn);b(this,Jn);b(this,Ne);b(this,Kr);b(this,Jr,0);g(this,Jn,t),g(this,Ne,s)}addFilter(t){if(!t)return"none";let s=a(this,K,Oe).get(t);if(s)return s;const[n,i,r]=w(this,K,Kh).call(this,t),o=t.length===1?n:`${n}${i}${r}`;if(s=a(this,K,Oe).get(o),s)return a(this,K,Oe).set(t,s),s;const l=`g_${a(this,Jn)}_transfer_map_${ce(this,Jr)._++}`,c=w(this,K,Ka).call(this,l);a(this,K,Oe).set(t,c),a(this,K,Oe).set(o,c);const d=w(this,K,Ja).call(this,l);return w(this,K,Dl).call(this,n,i,r,d),c}addHCMFilter(t,s){var m;const n=`${t}-${s}`,i="base";let r=a(this,K,Ml).get(i);if((r==null?void 0:r.key)===n||(r?((m=r.filter)==null||m.remove(),r.key=n,r.url="none",r.filter=null):(r={key:n,url:"none",filter:null},a(this,K,Ml).set(i,r)),!t||!s))return r.url;const o=w(this,K,Ol).call(this,t);t=Z.makeHexColor(...o);const l=w(this,K,Ol).call(this,s);if(s=Z.makeHexColor(...l),a(this,K,Ya).style.color="",t==="#000000"&&s==="#ffffff"||t===s)return r.url;const c=new Array(256);for(let v=0;v<=255;v++){const y=v/255;c[v]=y<=.03928?y/12.92:((y+.055)/1.055)**2.4}const d=c.join(","),u=`g_${a(this,Jn)}_hcm_filter`,f=r.filter=w(this,K,Ja).call(this,u);w(this,K,Dl).call(this,d,d,d,f),w(this,K,Yu).call(this,f);const p=(v,y)=>{const A=o[v]/255,E=l[v]/255,S=new Array(y+1);for(let x=0;x<=y;x++)S[x]=A+x/y*(E-A);return S.join(",")};return w(this,K,Dl).call(this,p(0,5),p(1,5),p(2,5),f),r.url=w(this,K,Ka).call(this,u),r.url}addAlphaFilter(t){let s=a(this,K,Oe).get(t);if(s)return s;const[n]=w(this,K,Kh).call(this,[t]),i=`alpha_${n}`;if(s=a(this,K,Oe).get(i),s)return a(this,K,Oe).set(t,s),s;const r=`g_${a(this,Jn)}_alpha_map_${ce(this,Jr)._++}`,o=w(this,K,Ka).call(this,r);a(this,K,Oe).set(t,o),a(this,K,Oe).set(i,o);const l=w(this,K,Ja).call(this,r);return w(this,K,Ku).call(this,n,l),o}addLuminosityFilter(t){let s=a(this,K,Oe).get(t||"luminosity");if(s)return s;let n,i;if(t?([n]=w(this,K,Kh).call(this,[t]),i=`luminosity_${n}`):i="luminosity",s=a(this,K,Oe).get(i),s)return a(this,K,Oe).set(t,s),s;const r=`g_${a(this,Jn)}_luminosity_map_${ce(this,Jr)._++}`,o=w(this,K,Ka).call(this,r);a(this,K,Oe).set(t,o),a(this,K,Oe).set(i,o);const l=w(this,K,Ja).call(this,r);return w(this,K,Wg).call(this,l),t&&w(this,K,Ku).call(this,n,l),o}addHighlightHCMFilter(t,s,n,i,r){var E;const o=`${s}-${n}-${i}-${r}`;let l=a(this,K,Ml).get(t);if((l==null?void 0:l.key)===o||(l?((E=l.filter)==null||E.remove(),l.key=o,l.url="none",l.filter=null):(l={key:o,url:"none",filter:null},a(this,K,Ml).set(t,l)),!s||!n))return l.url;const[c,d]=[s,n].map(w(this,K,Ol).bind(this));let u=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),f=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[p,m]=[i,r].map(w(this,K,Ol).bind(this));f<u&&([u,f,p,m]=[f,u,m,p]),a(this,K,Ya).style.color="";const v=(S,x,T)=>{const C=new Array(256),P=(f-u)/T,k=S/255,R=(x-S)/(255*T);let L=0;for(let D=0;D<=T;D++){const H=Math.round(u+D*P),V=k+D*R;for(let G=L;G<=H;G++)C[G]=V;L=H+1}for(let D=L;D<256;D++)C[D]=C[L-1];return C.join(",")},y=`g_${a(this,Jn)}_hcm_${t}_filter`,A=l.filter=w(this,K,Ja).call(this,y);return w(this,K,Yu).call(this,A),w(this,K,Dl).call(this,v(p[0],m[0],5),v(p[1],m[1],5),v(p[2],m[2],5),A),l.url=w(this,K,Ka).call(this,y),l.url}destroy(t=!1){var s,n,i,r;t&&((s=a(this,Kr))!=null&&s.size)||((n=a(this,Kn))==null||n.parentNode.parentNode.remove(),g(this,Kn,null),(i=a(this,Io))==null||i.clear(),g(this,Io,null),(r=a(this,Kr))==null||r.clear(),g(this,Kr,null),g(this,Jr,0))}}Yr=new WeakMap,Io=new WeakMap,Kn=new WeakMap,Jn=new WeakMap,Ne=new WeakMap,Kr=new WeakMap,Jr=new WeakMap,K=new WeakSet,Oe=function(){return a(this,Io)||g(this,Io,new Map)},Ml=function(){return a(this,Kr)||g(this,Kr,new Map)},Ya=function(){if(!a(this,Kn)){const t=a(this,Ne).createElement("div"),{style:s}=t;s.visibility="hidden",s.contain="strict",s.width=s.height=0,s.position="absolute",s.top=s.left=0,s.zIndex=-1;const n=a(this,Ne).createElementNS(kn,"svg");n.setAttribute("width",0),n.setAttribute("height",0),g(this,Kn,a(this,Ne).createElementNS(kn,"defs")),t.append(n),n.append(a(this,Kn)),a(this,Ne).body.append(t)}return a(this,Kn)},Kh=function(t){if(t.length===1){const c=t[0],d=new Array(256);for(let f=0;f<256;f++)d[f]=c[f]/255;const u=d.join(",");return[u,u,u]}const[s,n,i]=t,r=new Array(256),o=new Array(256),l=new Array(256);for(let c=0;c<256;c++)r[c]=s[c]/255,o[c]=n[c]/255,l[c]=i[c]/255;return[r.join(","),o.join(","),l.join(",")]},Ka=function(t){if(a(this,Yr)===void 0){g(this,Yr,"");const s=a(this,Ne).URL;s!==a(this,Ne).baseURI&&(ru(s)?lt('#createUrl: ignore "data:"-URL for performance reasons.'):g(this,Yr,ig(s,"")))}return`url(${a(this,Yr)}#${t})`},Wg=function(t){const s=a(this,Ne).createElementNS(kn,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(s)},Yu=function(t){const s=a(this,Ne).createElementNS(kn,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(s)},Ja=function(t){const s=a(this,Ne).createElementNS(kn,"filter");return s.setAttribute("color-interpolation-filters","sRGB"),s.setAttribute("id",t),a(this,K,Ya).append(s),s},Ll=function(t,s,n){const i=a(this,Ne).createElementNS(kn,s);i.setAttribute("type","discrete"),i.setAttribute("tableValues",n),t.append(i)},Dl=function(t,s,n,i){const r=a(this,Ne).createElementNS(kn,"feComponentTransfer");i.append(r),w(this,K,Ll).call(this,r,"feFuncR",t),w(this,K,Ll).call(this,r,"feFuncG",s),w(this,K,Ll).call(this,r,"feFuncB",n)},Ku=function(t,s){const n=a(this,Ne).createElementNS(kn,"feComponentTransfer");s.append(n),w(this,K,Ll).call(this,n,"feFuncA",t)},Ol=function(t){return a(this,K,Ya).style.color=t,au(getComputedStyle(a(this,K,Ya)).getPropertyValue("color"))};class Xg{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){$t("Abstract method `_fetch` called.")}}class Pp extends Xg{async _fetch(e){const t=await Ch(e,"arraybuffer");return new Uint8Array(t)}}class Yg{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){$t("Abstract method `_fetch` called.")}}class Ip extends Yg{async _fetch(e){const t=await Ch(e,"arraybuffer");return new Uint8Array(t)}}var Up;if(We){let h;try{const e=process.getBuiltinModule("module").createRequire(import.meta.url);try{h=e("@napi-rs/canvas")}catch(t){lt(`Cannot load "@napi-rs/canvas" package: "${t}".`)}}catch(e){lt(`Cannot access the \`require\` function: "${e}".`)}globalThis.DOMMatrix||(h!=null&&h.DOMMatrix?globalThis.DOMMatrix=h.DOMMatrix:lt("Cannot polyfill `DOMMatrix`, rendering may be broken.")),globalThis.ImageData||(h!=null&&h.ImageData?globalThis.ImageData=h.ImageData:lt("Cannot polyfill `ImageData`, rendering may be broken.")),globalThis.Path2D||(h!=null&&h.Path2D?globalThis.Path2D=h.Path2D:lt("Cannot polyfill `Path2D`, rendering may be broken.")),(Up=globalThis.navigator)!=null&&Up.language||(globalThis.navigator={language:"en-US",platform:"",userAgent:""})}async function ip(h){const t=await process.getBuiltinModule("fs").promises.readFile(h);return new Uint8Array(t)}class rS extends zg{}class aS extends jg{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class oS extends Gg{async _fetch(e){return ip(e)}}class lS extends Xg{async _fetch(e){return ip(e)}}class cS extends Yg{async _fetch(e){return ip(e)}}gt(7588);const za="__forcedDependency";var as,Ue,Ro,fn,ko,Qn,_t,Nt,Zn,os,zi,Mo,Wi,Xi;class hS{constructor(e){b(this,as,{__proto__:null});b(this,Ue,{__proto__:null,transform:[],moveText:[],sameLineText:[],[za]:[]});b(this,Ro,new Map);b(this,fn,[]);b(this,ko,[]);b(this,Qn,[[1,0,0,1,0,0]]);b(this,_t,[-1/0,-1/0,1/0,1/0]);b(this,Nt,new Float64Array([1/0,1/0,-1/0,-1/0]));b(this,Zn,-1);b(this,os,new Set);b(this,zi,new Map);b(this,Mo,new Map);b(this,Wi);b(this,Xi);g(this,Wi,e.width),g(this,Xi,e.height)}save(e){return g(this,as,{__proto__:a(this,as)}),g(this,Ue,{__proto__:a(this,Ue),transform:{__proto__:a(this,Ue).transform},moveText:{__proto__:a(this,Ue).moveText},sameLineText:{__proto__:a(this,Ue).sameLineText},[za]:{__proto__:a(this,Ue)[za]}}),g(this,_t,{__proto__:a(this,_t)}),a(this,fn).push([e,null]),this}restore(e){const t=Object.getPrototypeOf(a(this,as));if(t===null)return this;g(this,as,t),g(this,Ue,Object.getPrototypeOf(a(this,Ue))),g(this,_t,Object.getPrototypeOf(a(this,_t)));const s=a(this,fn).pop();return s!==void 0&&(s[1]=e),this}recordOpenMarker(e){return a(this,fn).push([e,null]),this}getOpenMarker(){return a(this,fn).length===0?null:a(this,fn).at(-1)[0]}recordCloseMarker(e){const t=a(this,fn).pop();return t!==void 0&&(t[1]=e),this}beginMarkedContent(e){return a(this,ko).push([e,null]),this}endMarkedContent(e){const t=a(this,ko).pop();return t!==void 0&&(t[1]=e),this}pushBaseTransform(e){return a(this,Qn).push(Z.multiplyByDOMMatrix(a(this,Qn).at(-1),e.getTransform())),this}popBaseTransform(){return a(this,Qn).length>1&&a(this,Qn).pop(),this}recordSimpleData(e,t){return a(this,as)[e]=t,this}recordIncrementalData(e,t){return a(this,Ue)[e].push(t),this}resetIncrementalData(e,t){return a(this,Ue)[e].length=0,this}recordNamedData(e,t){return a(this,Ro).set(e,t),this}recordFutureForcedDependency(e,t){return this.recordIncrementalData(za,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in a(this,as)&&this.recordFutureForcedDependency(t,a(this,as)[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of a(this,os))this.recordFutureForcedDependency(za,e);return this}resetBBox(e){return g(this,Zn,e),a(this,Nt)[0]=1/0,a(this,Nt)[1]=1/0,a(this,Nt)[2]=-1/0,a(this,Nt)[3]=-1/0,this}get hasPendingBBox(){return a(this,Zn)!==-1}recordClipBox(e,t,s,n,i,r){const o=Z.multiplyByDOMMatrix(a(this,Qn).at(-1),t.getTransform()),l=[1/0,1/0,-1/0,-1/0];Z.axialAlignedBoundingBox([s,i,n,r],o,l);const c=Z.intersect(a(this,_t),l);return c?(a(this,_t)[0]=c[0],a(this,_t)[1]=c[1],a(this,_t)[2]=c[2],a(this,_t)[3]=c[3]):(a(this,_t)[0]=a(this,_t)[1]=1/0,a(this,_t)[2]=a(this,_t)[3]=-1/0),this}recordBBox(e,t,s,n,i,r){const o=a(this,_t);if(o[0]===1/0)return this;const l=Z.multiplyByDOMMatrix(a(this,Qn).at(-1),t.getTransform());if(o[0]===-1/0)return Z.axialAlignedBoundingBox([s,i,n,r],l,a(this,Nt)),this;const c=[1/0,1/0,-1/0,-1/0];return Z.axialAlignedBoundingBox([s,i,n,r],l,c),a(this,Nt)[0]=Math.min(a(this,Nt)[0],Math.max(c[0],o[0])),a(this,Nt)[1]=Math.min(a(this,Nt)[1],Math.max(c[1],o[1])),a(this,Nt)[2]=Math.max(a(this,Nt)[2],Math.min(c[2],o[2])),a(this,Nt)[3]=Math.max(a(this,Nt)[3],Math.min(c[3],o[3])),this}recordCharacterBBox(e,t,s,n=1,i=0,r=0,o){const l=s.bbox;let c,d;if(l&&(c=l[2]!==l[0]&&l[3]!==l[1]&&a(this,Mo).get(s),c!==!1&&(d=[0,0,0,0],Z.axialAlignedBoundingBox(l,s.fontMatrix,d),(n!==1||i!==0||r!==0)&&Z.scaleMinMax([n,0,0,-n,i,r],d),c)))return this.recordBBox(e,t,d[0],d[2],d[1],d[3]);if(!o)return this.recordFullPageBBox(e);const u=o();return l&&d&&c===void 0&&(c=d[0]<=i-u.actualBoundingBoxLeft&&d[2]>=i+u.actualBoundingBoxRight&&d[1]<=r-u.actualBoundingBoxAscent&&d[3]>=r+u.actualBoundingBoxDescent,a(this,Mo).set(s,c),c)?this.recordBBox(e,t,d[0],d[2],d[1],d[3]):this.recordBBox(e,t,i-u.actualBoundingBoxLeft,i+u.actualBoundingBoxRight,r-u.actualBoundingBoxAscent,r+u.actualBoundingBoxDescent)}recordFullPageBBox(e){return a(this,Nt)[0]=Math.max(0,a(this,_t)[0]),a(this,Nt)[1]=Math.max(0,a(this,_t)[1]),a(this,Nt)[2]=Math.min(a(this,Wi),a(this,_t)[2]),a(this,Nt)[3]=Math.min(a(this,Xi),a(this,_t)[3]),this}getSimpleIndex(e){return a(this,as)[e]}recordDependencies(e,t){const s=a(this,os),n=a(this,as),i=a(this,Ue);for(const r of t)r in a(this,as)?s.add(n[r]):r in i&&i[r].forEach(s.add,s);return this}copyDependenciesFromIncrementalOperation(e,t){const s=a(this,zi),n=a(this,os);for(const i of a(this,Ue)[t])s.get(i).dependencies.forEach(n.add,n.add(i));return this}recordNamedDependency(e,t){return a(this,Ro).has(t)&&a(this,os).add(a(this,Ro).get(t)),this}recordOperation(e,t=!1){this.recordDependencies(e,[za]);const s=new Set(a(this,os)),n=a(this,fn).concat(a(this,ko)),i=a(this,Zn)===e?{minX:a(this,Nt)[0],minY:a(this,Nt)[1],maxX:a(this,Nt)[2],maxY:a(this,Nt)[3]}:null;return a(this,zi).set(e,{bbox:i,pairs:n,dependencies:s}),t||g(this,Zn,-1),a(this,os).clear(),this}bboxToClipBoxDropOperation(e){return a(this,Zn)!==-1&&(g(this,Zn,-1),a(this,_t)[0]=Math.max(a(this,_t)[0],a(this,Nt)[0]),a(this,_t)[1]=Math.max(a(this,_t)[1],a(this,Nt)[1]),a(this,_t)[2]=Math.min(a(this,_t)[2],a(this,Nt)[2]),a(this,_t)[3]=Math.min(a(this,_t)[3],a(this,Nt)[3])),a(this,os).clear(),this}_takePendingDependencies(){const e=a(this,os);return g(this,os,new Set),e}_extractOperation(e){const t=a(this,zi).get(e);return a(this,zi).delete(e),t}_pushPendingDependencies(e){for(const t of e)a(this,os).add(t)}take(){return a(this,Mo).clear(),Array.from(a(this,zi),([e,{bbox:t,pairs:s,dependencies:n}])=>(s.forEach(i=>i.forEach(n.add,n)),n.delete(e),{minX:((t==null?void 0:t.minX)??0)/a(this,Wi),maxX:((t==null?void 0:t.maxX)??a(this,Wi))/a(this,Wi),minY:((t==null?void 0:t.minY)??0)/a(this,Xi),maxY:((t==null?void 0:t.maxY)??a(this,Xi))/a(this,Xi),dependencies:Array.from(n).sort((i,r)=>i-r),idx:e}))}}as=new WeakMap,Ue=new WeakMap,Ro=new WeakMap,fn=new WeakMap,ko=new WeakMap,Qn=new WeakMap,_t=new WeakMap,Nt=new WeakMap,Zn=new WeakMap,os=new WeakMap,zi=new WeakMap,Mo=new WeakMap,Wi=new WeakMap,Xi=new WeakMap;var Mt,Qt,Lo,Yi,Do;const up=class up{constructor(e,t){b(this,Mt);b(this,Qt);b(this,Lo,0);b(this,Yi);b(this,Do,0);if(e instanceof up)return e;g(this,Mt,e),g(this,Yi,e._takePendingDependencies()),g(this,Qt,t)}save(e){return ce(this,Do)._++,a(this,Mt).save(a(this,Qt)),this}restore(e){return a(this,Do)>0&&(a(this,Mt).restore(a(this,Qt)),ce(this,Do)._--),this}recordOpenMarker(e){return ce(this,Lo)._++,this}getOpenMarker(){return a(this,Lo)>0?a(this,Qt):a(this,Mt).getOpenMarker()}recordCloseMarker(e){return ce(this,Lo)._--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return a(this,Mt).pushBaseTransform(e),this}popBaseTransform(){return a(this,Mt).popBaseTransform(),this}recordSimpleData(e,t){return a(this,Mt).recordSimpleData(e,a(this,Qt)),this}recordIncrementalData(e,t){return a(this,Mt).recordIncrementalData(e,a(this,Qt)),this}resetIncrementalData(e,t){return a(this,Mt).resetIncrementalData(e,a(this,Qt)),this}recordNamedData(e,t){return this}recordFutureForcedDependency(e,t){return a(this,Mt).recordFutureForcedDependency(e,a(this,Qt)),this}inheritSimpleDataAsFutureForcedDependencies(e){return a(this,Mt).inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return a(this,Mt).inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return a(this,Mt).hasPendingBBox||a(this,Mt).resetBBox(a(this,Qt)),this}get hasPendingBBox(){return a(this,Mt).hasPendingBBox}recordClipBox(e,t,s,n,i,r){return a(this,Mt).recordClipBox(a(this,Qt),t,s,n,i,r),this}recordBBox(e,t,s,n,i,r){return a(this,Mt).recordBBox(a(this,Qt),t,s,n,i,r),this}recordCharacterBBox(e,t,s,n,i,r,o){return a(this,Mt).recordCharacterBBox(a(this,Qt),t,s,n,i,r,o),this}recordFullPageBBox(e){return a(this,Mt).recordFullPageBBox(a(this,Qt)),this}getSimpleIndex(e){return a(this,Mt).getSimpleIndex(e)}recordDependencies(e,t){return a(this,Mt).recordDependencies(a(this,Qt),t),this}copyDependenciesFromIncrementalOperation(e,t){return a(this,Mt).copyDependenciesFromIncrementalOperation(a(this,Qt),t),this}recordNamedDependency(e,t){return a(this,Mt).recordNamedDependency(a(this,Qt),t),this}recordOperation(e){a(this,Mt).recordOperation(a(this,Qt),!0);const t=a(this,Mt)._extractOperation(a(this,Qt));for(const s of t.dependencies)a(this,Yi).add(s);return a(this,Yi).delete(a(this,Qt)),a(this,Yi).delete(null),this}bboxToClipBoxDropOperation(e){return a(this,Mt).bboxToClipBoxDropOperation(a(this,Qt)),this}recordNestedDependencies(){a(this,Mt)._pushPendingDependencies(a(this,Yi))}take(){throw new Error("Unreachable")}};Mt=new WeakMap,Qt=new WeakMap,Lo=new WeakMap,Yi=new WeakMap,Do=new WeakMap;let Sd=up;const Cs={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation"],transform:["transform"],transformAndFill:["transform","fillColor"]},ke={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Ju(h,e){if(!e)return;const t=e[2]-e[0],s=e[3]-e[1],n=new Path2D;n.rect(e[0],e[1],t,s),h.clip(n)}class rp{isModifyingCurrentTransform(){return!1}getPattern(){$t("Abstract method `getPattern` called.")}}class dS extends rp{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)t.addColorStop(s[0],s[1]);return t}getPattern(e,t,s,n){let i;if(n===ke.STROKE||n===ke.FILL){const r=t.current.getClippedPathBoundingBox(n,Zt(e))||[0,0,0,0],o=Math.ceil(r[2]-r[0])||1,l=Math.ceil(r[3]-r[1])||1,c=t.cachedCanvases.getCanvas("pattern",o,l),d=c.context;d.clearRect(0,0,d.canvas.width,d.canvas.height),d.beginPath(),d.rect(0,0,d.canvas.width,d.canvas.height),d.translate(-r[0],-r[1]),s=Z.transform(s,[1,0,0,1,r[0],r[1]]),d.transform(...t.baseTransform),this.matrix&&d.transform(...this.matrix),Ju(d,this._bbox),d.fillStyle=this._createGradient(d),d.fill(),i=e.createPattern(c.canvas,"no-repeat");const u=new DOMMatrix(s);i.setTransform(u)}else Ju(e,this._bbox),i=this._createGradient(e);return i}}function mu(h,e,t,s,n,i,r,o){const l=e.coords,c=e.colors,d=h.data,u=h.width*4;let f;l[t+1]>l[s+1]&&(f=t,t=s,s=f,f=i,i=r,r=f),l[s+1]>l[n+1]&&(f=s,s=n,n=f,f=r,r=o,o=f),l[t+1]>l[s+1]&&(f=t,t=s,s=f,f=i,i=r,r=f);const p=(l[t]+e.offsetX)*e.scaleX,m=(l[t+1]+e.offsetY)*e.scaleY,v=(l[s]+e.offsetX)*e.scaleX,y=(l[s+1]+e.offsetY)*e.scaleY,A=(l[n]+e.offsetX)*e.scaleX,E=(l[n+1]+e.offsetY)*e.scaleY;if(m>=E)return;const S=c[i],x=c[i+1],T=c[i+2],C=c[r],P=c[r+1],k=c[r+2],R=c[o],L=c[o+1],D=c[o+2],H=Math.round(m),V=Math.round(E);let G,q,j,F,nt,ct,Pt,Kt;for(let ut=H;ut<=V;ut++){if(ut<y){const B=ut<m?0:(m-ut)/(m-y);G=p-(p-v)*B,q=S-(S-C)*B,j=x-(x-P)*B,F=T-(T-k)*B}else{let B;ut>E?B=1:y===E?B=0:B=(y-ut)/(y-E),G=v-(v-A)*B,q=C-(C-R)*B,j=P-(P-L)*B,F=k-(k-D)*B}let mt;ut<m?mt=0:ut>E?mt=1:mt=(m-ut)/(m-E),nt=p-(p-A)*mt,ct=S-(S-R)*mt,Pt=x-(x-L)*mt,Kt=T-(T-D)*mt;const Ht=Math.round(Math.min(G,nt)),ne=Math.round(Math.max(G,nt));let z=u*ut+Ht*4;for(let B=Ht;B<=ne;B++)mt=(G-B)/(G-nt),mt<0?mt=0:mt>1&&(mt=1),d[z++]=q-(q-ct)*mt|0,d[z++]=j-(j-Pt)*mt|0,d[z++]=F-(F-Kt)*mt|0,d[z++]=255}}function uS(h,e,t){const s=e.coords,n=e.colors;let i,r;switch(e.type){case"lattice":const o=e.verticesPerRow,l=Math.floor(s.length/o)-1,c=o-1;for(i=0;i<l;i++){let d=i*o;for(let u=0;u<c;u++,d++)mu(h,t,s[d],s[d+1],s[d+o],n[d],n[d+1],n[d+o]),mu(h,t,s[d+o+1],s[d+1],s[d+o],n[d+o+1],n[d+1],n[d+o])}break;case"triangles":for(i=0,r=s.length;i<r;i+=3)mu(h,t,s[i],s[i+1],s[i+2],n[i],n[i+1],n[i+2]);break;default:throw new Error("illegal figure")}}class fS extends rp{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,s){const o=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),c=Math.ceil(this._bounds[2])-o,d=Math.ceil(this._bounds[3])-l,u=Math.min(Math.ceil(Math.abs(c*e[0]*1.1)),3e3),f=Math.min(Math.ceil(Math.abs(d*e[1]*1.1)),3e3),p=c/u,m=d/f,v={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-l,scaleX:1/p,scaleY:1/m},y=u+2*2,A=f+2*2,E=s.getCanvas("mesh",y,A),S=E.context,x=S.createImageData(u,f);if(t){const C=x.data;for(let P=0,k=C.length;P<k;P+=4)C[P]=t[0],C[P+1]=t[1],C[P+2]=t[2],C[P+3]=255}for(const C of this._figures)uS(x,C,v);return S.putImageData(x,2,2),{canvas:E.canvas,offsetX:o-2*p,offsetY:l-2*m,scaleX:p,scaleY:m}}isModifyingCurrentTransform(){return!0}getPattern(e,t,s,n){Ju(e,this._bbox);const i=new Float32Array(2);if(n===ke.SHADING)Z.singularValueDecompose2dScale(Zt(e),i);else if(this.matrix){Z.singularValueDecompose2dScale(this.matrix,i);const[o,l]=i;Z.singularValueDecompose2dScale(t.baseTransform,i),i[0]*=o,i[1]*=l}else Z.singularValueDecompose2dScale(t.baseTransform,i);const r=this._createMeshCanvas(i,n===ke.SHADING?null:this._background,t.cachedCanvases);return n!==ke.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(r.offsetX,r.offsetY),e.scale(r.scaleX,r.scaleY),e.createPattern(r.canvas,"no-repeat")}}class pS extends rp{getPattern(){return"hotpink"}}function gS(h){switch(h[0]){case"RadialAxial":return new dS(h);case"Mesh":return new fS(h);case"Dummy":return new pS}throw new Error(`Unknown IR type: ${h[0]}`)}const Rp={COLORED:1,UNCOLORED:2},Fd=class Fd{constructor(e,t,s,n){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=s,this.baseTransform=n}createPatternCanvas(e){var nt,ct,Pt,Kt;const{bbox:t,operatorList:s,paintType:n,tilingType:i,color:r,canvasGraphicsFactory:o}=this;let{xstep:l,ystep:c}=this;l=Math.abs(l),c=Math.abs(c),iu("TilingType: "+i);const d=t[0],u=t[1],f=t[2],p=t[3],m=f-d,v=p-u,y=new Float32Array(2);Z.singularValueDecompose2dScale(this.matrix,y);const[A,E]=y;Z.singularValueDecompose2dScale(this.baseTransform,y);const S=A*y[0],x=E*y[1];let T=m,C=v,P=!1,k=!1;const R=Math.ceil(l*S),L=Math.ceil(c*x),D=Math.ceil(m*S),H=Math.ceil(v*x);R>=D?T=l:P=!0,L>=H?C=c:k=!0;const V=this.getSizeAndScale(T,this.ctx.canvas.width,S),G=this.getSizeAndScale(C,this.ctx.canvas.height,x),q=e.cachedCanvases.getCanvas("pattern",V.size,G.size),j=q.context,F=o.createCanvasGraphics(j);if(F.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(F,n,r),j.translate(-V.scale*d,-G.scale*u),F.transform(0,V.scale,0,0,G.scale,0,0),j.save(),(nt=F.dependencyTracker)==null||nt.save(),this.clipBbox(F,d,u,f,p),F.baseTransform=Zt(F.ctx),F.executeOperatorList(s),F.endDrawing(),(Kt=(ct=F.dependencyTracker)==null?void 0:(Pt=ct.restore()).recordNestedDependencies)==null||Kt.call(Pt),j.restore(),P||k){const ut=q.canvas;P&&(T=l),k&&(C=c);const mt=this.getSizeAndScale(T,this.ctx.canvas.width,S),Ht=this.getSizeAndScale(C,this.ctx.canvas.height,x),ne=mt.size,z=Ht.size,B=e.cachedCanvases.getCanvas("pattern-workaround",ne,z),X=B.context,ft=P?Math.floor(m/l):0,Dt=k?Math.floor(v/c):0;for(let it=0;it<=ft;it++)for(let kt=0;kt<=Dt;kt++)X.drawImage(ut,ne*it,z*kt,ne,z,0,0,ne,z);return{canvas:B.canvas,scaleX:mt.scale,scaleY:Ht.scale,offsetX:d,offsetY:u}}return{canvas:q.canvas,scaleX:V.scale,scaleY:G.scale,offsetX:d,offsetY:u}}getSizeAndScale(e,t,s){const n=Math.max(Fd.MAX_PATTERN_SIZE,t);let i=Math.ceil(e*s);return i>=n?i=n:s=i/e,{scale:s,size:i}}clipBbox(e,t,s,n,i){const r=n-t,o=i-s;e.ctx.rect(t,s,r,o),Z.axialAlignedBoundingBox([t,s,n,i],Zt(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,s){const n=e.ctx,i=e.current;switch(t){case Rp.COLORED:const{fillStyle:r,strokeStyle:o}=this.ctx;n.fillStyle=i.fillColor=r,n.strokeStyle=i.strokeColor=o;break;case Rp.UNCOLORED:n.fillStyle=n.strokeStyle=s,i.fillColor=i.strokeColor=s;break;default:throw new Dw(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,s,n){let i=s;n!==ke.SHADING&&(i=Z.transform(i,t.baseTransform),this.matrix&&(i=Z.transform(i,this.matrix)));const r=this.createPatternCanvas(t);let o=new DOMMatrix(i);o=o.translate(r.offsetX,r.offsetY),o=o.scale(1/r.scaleX,1/r.scaleY);const l=e.createPattern(r.canvas,"repeat");return l.setTransform(o),l}};U(Fd,"MAX_PATTERN_SIZE",3e3);let Qu=Fd;function mS({src:h,srcPos:e=0,dest:t,width:s,height:n,nonBlackColor:i=4294967295,inverseDecode:r=!1}){const o=De.isLittleEndian?4278190080:255,[l,c]=r?[i,o]:[o,i],d=s>>3,u=s&7,f=h.length;t=new Uint32Array(t.buffer);let p=0;for(let m=0;m<n;m++){for(const y=e+d;e<y;e++){const A=e<f?h[e]:255;t[p++]=A&128?c:l,t[p++]=A&64?c:l,t[p++]=A&32?c:l,t[p++]=A&16?c:l,t[p++]=A&8?c:l,t[p++]=A&4?c:l,t[p++]=A&2?c:l,t[p++]=A&1?c:l}if(u===0)continue;const v=e<f?h[e++]:255;for(let y=0;y<u;y++)t[p++]=v&1<<7-y?c:l}return{srcPos:e,destPos:p}}const kp=16,Mp=100,vS=15,Lp=10,es=16,vu=new DOMMatrix,ws=new Float32Array(2),to=new Float32Array([1/0,1/0,-1/0,-1/0]);function yS(h,e){if(h._removeMirroring)throw new Error("Context is already forwarding operations.");h.__originalSave=h.save,h.__originalRestore=h.restore,h.__originalRotate=h.rotate,h.__originalScale=h.scale,h.__originalTranslate=h.translate,h.__originalTransform=h.transform,h.__originalSetTransform=h.setTransform,h.__originalResetTransform=h.resetTransform,h.__originalClip=h.clip,h.__originalMoveTo=h.moveTo,h.__originalLineTo=h.lineTo,h.__originalBezierCurveTo=h.bezierCurveTo,h.__originalRect=h.rect,h.__originalClosePath=h.closePath,h.__originalBeginPath=h.beginPath,h._removeMirroring=()=>{h.save=h.__originalSave,h.restore=h.__originalRestore,h.rotate=h.__originalRotate,h.scale=h.__originalScale,h.translate=h.__originalTranslate,h.transform=h.__originalTransform,h.setTransform=h.__originalSetTransform,h.resetTransform=h.__originalResetTransform,h.clip=h.__originalClip,h.moveTo=h.__originalMoveTo,h.lineTo=h.__originalLineTo,h.bezierCurveTo=h.__originalBezierCurveTo,h.rect=h.__originalRect,h.closePath=h.__originalClosePath,h.beginPath=h.__originalBeginPath,delete h._removeMirroring},h.save=function(){e.save(),this.__originalSave()},h.restore=function(){e.restore(),this.__originalRestore()},h.translate=function(t,s){e.translate(t,s),this.__originalTranslate(t,s)},h.scale=function(t,s){e.scale(t,s),this.__originalScale(t,s)},h.transform=function(t,s,n,i,r,o){e.transform(t,s,n,i,r,o),this.__originalTransform(t,s,n,i,r,o)},h.setTransform=function(t,s,n,i,r,o){e.setTransform(t,s,n,i,r,o),this.__originalSetTransform(t,s,n,i,r,o)},h.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},h.rotate=function(t){e.rotate(t),this.__originalRotate(t)},h.clip=function(t){e.clip(t),this.__originalClip(t)},h.moveTo=function(t,s){e.moveTo(t,s),this.__originalMoveTo(t,s)},h.lineTo=function(t,s){e.lineTo(t,s),this.__originalLineTo(t,s)},h.bezierCurveTo=function(t,s,n,i,r,o){e.bezierCurveTo(t,s,n,i,r,o),this.__originalBezierCurveTo(t,s,n,i,r,o)},h.rect=function(t,s,n,i){e.rect(t,s,n,i),this.__originalRect(t,s,n,i)},h.closePath=function(){e.closePath(),this.__originalClosePath()},h.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class bS{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,s){let n;return this.cache[e]!==void 0?(n=this.cache[e],this.canvasFactory.reset(n,t,s)):(n=this.canvasFactory.create(t,s),this.cache[e]=n),n}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Nh(h,e,t,s,n,i,r,o,l,c){const[d,u,f,p,m,v]=Zt(h);if(u===0&&f===0){const E=r*d+m,S=Math.round(E),x=o*p+v,T=Math.round(x),C=(r+l)*d+m,P=Math.abs(Math.round(C)-S)||1,k=(o+c)*p+v,R=Math.abs(Math.round(k)-T)||1;return h.setTransform(Math.sign(d),0,0,Math.sign(p),S,T),h.drawImage(e,t,s,n,i,0,0,P,R),h.setTransform(d,u,f,p,m,v),[P,R]}if(d===0&&p===0){const E=o*f+m,S=Math.round(E),x=r*u+v,T=Math.round(x),C=(o+c)*f+m,P=Math.abs(Math.round(C)-S)||1,k=(r+l)*u+v,R=Math.abs(Math.round(k)-T)||1;return h.setTransform(0,Math.sign(u),Math.sign(f),0,S,T),h.drawImage(e,t,s,n,i,0,0,R,P),h.setTransform(d,u,f,p,m,v),[R,P]}h.drawImage(e,t,s,n,i,r,o,l,c);const y=Math.hypot(d,u),A=Math.hypot(f,p);return[y*l,A*c]}class Dp{constructor(e,t,s){U(this,"alphaIsShape",!1);U(this,"fontSize",0);U(this,"fontSizeScale",1);U(this,"textMatrix",null);U(this,"textMatrixScale",1);U(this,"fontMatrix",xu);U(this,"leading",0);U(this,"x",0);U(this,"y",0);U(this,"lineX",0);U(this,"lineY",0);U(this,"charSpacing",0);U(this,"wordSpacing",0);U(this,"textHScale",1);U(this,"textRenderingMode",Ee.FILL);U(this,"textRise",0);U(this,"fillColor","#000000");U(this,"strokeColor","#000000");U(this,"patternFill",!1);U(this,"patternStroke",!1);U(this,"fillAlpha",1);U(this,"strokeAlpha",1);U(this,"lineWidth",1);U(this,"activeSMask",null);U(this,"transferMaps","none");s==null||s(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=to.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=ke.FILL,t=null){const s=this.minMax.slice();if(e===ke.STROKE){t||$t("Stroke bounding box must include transform."),Z.singularValueDecompose2dScale(t,ws);const n=ws[0]*this.lineWidth/2,i=ws[1]*this.lineWidth/2;s[0]-=n,s[1]-=i,s[2]+=n,s[3]+=i}return s}updateClipFromPath(){const e=Z.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(to,0)}getClippedPathBoundingBox(e=ke.FILL,t=null){return Z.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function Op(h,e){if(e instanceof ImageData){h.putImageData(e,0,0);return}const t=e.height,s=e.width,n=t%es,i=(t-n)/es,r=n===0?i:i+1,o=h.createImageData(s,es);let l=0,c;const d=e.data,u=o.data;let f,p,m,v;if(e.kind===Vh.GRAYSCALE_1BPP){const y=d.byteLength,A=new Uint32Array(u.buffer,0,u.byteLength>>2),E=A.length,S=s+7>>3,x=4294967295,T=De.isLittleEndian?4278190080:255;for(f=0;f<r;f++){for(m=f<i?es:n,c=0,p=0;p<m;p++){const C=y-l;let P=0;const k=C>S?s:C*8-7,R=k&-8;let L=0,D=0;for(;P<R;P+=8)D=d[l++],A[c++]=D&128?x:T,A[c++]=D&64?x:T,A[c++]=D&32?x:T,A[c++]=D&16?x:T,A[c++]=D&8?x:T,A[c++]=D&4?x:T,A[c++]=D&2?x:T,A[c++]=D&1?x:T;for(;P<k;P++)L===0&&(D=d[l++],L=128),A[c++]=D&L?x:T,L>>=1}for(;c<E;)A[c++]=0;h.putImageData(o,0,f*es)}}else if(e.kind===Vh.RGBA_32BPP){for(p=0,v=s*es*4,f=0;f<i;f++)u.set(d.subarray(l,l+v)),l+=v,h.putImageData(o,0,p),p+=es;f<r&&(v=s*n*4,u.set(d.subarray(l,l+v)),h.putImageData(o,0,p))}else if(e.kind===Vh.RGB_24BPP)for(m=es,v=s*m,f=0;f<r;f++){for(f>=i&&(m=n,v=s*m),c=0,p=v;p--;)u[c++]=d[l++],u[c++]=d[l++],u[c++]=d[l++],u[c++]=255;h.putImageData(o,0,f*es)}else throw new Error(`bad image kind: ${e.kind}`)}function _p(h,e){if(e.bitmap){h.drawImage(e.bitmap,0,0);return}const t=e.height,s=e.width,n=t%es,i=(t-n)/es,r=n===0?i:i+1,o=h.createImageData(s,es);let l=0;const c=e.data,d=o.data;for(let u=0;u<r;u++){const f=u<i?es:n;({srcPos:l}=mS({src:c,srcPos:l,dest:d,width:s,height:f,nonBlackColor:0})),h.putImageData(o,0,u*es)}}function Al(h,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of t)h[s]!==void 0&&(e[s]=h[s]);h.setLineDash!==void 0&&(e.setLineDash(h.getLineDash()),e.lineDashOffset=h.lineDashOffset)}function Fh(h){h.strokeStyle=h.fillStyle="#000000",h.fillRule="nonzero",h.globalAlpha=1,h.lineWidth=1,h.lineCap="butt",h.lineJoin="miter",h.miterLimit=10,h.globalCompositeOperation="source-over",h.font="10px sans-serif",h.setLineDash!==void 0&&(h.setLineDash([]),h.lineDashOffset=0);const{filter:e}=h;e!=="none"&&e!==""&&(h.filter="none")}function Np(h,e){if(e)return!0;Z.singularValueDecompose2dScale(h,ws);const t=Math.fround(Pn.pixelRatio*Sr.PDF_TO_CSS_UNITS);return ws[0]<=t&&ws[1]<=t}const AS=["butt","round","square"],wS=["miter","round","bevel"],SS={},Fp={};var Zs,Zu,qu,tf;const fp=class fp{constructor(e,t,s,n,i,{optionalContentConfig:r,markedContentStack:o=null},l,c,d){b(this,Zs);this.ctx=e,this.current=new Dp(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=s,this.canvasFactory=n,this.filterFactory=i,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=r,this.cachedCanvases=new bS(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=d??null}getObject(e,t,s=null){var n;return typeof t=="string"?((n=this.dependencyTracker)==null||n.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):s}beginDrawing({transform:e,viewport:t,transparency:s=!1,background:n=null}){const i=this.ctx.canvas.width,r=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=n||"#ffffff",this.ctx.fillRect(0,0,i,r),this.ctx.fillStyle=o,s){const l=this.cachedCanvases.getCanvas("transparent",i,r);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...Zt(this.compositeCtx))}this.ctx.save(),Fh(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Zt(this.ctx)}executeOperatorList(e,t,s,n,i){var A;const r=e.argsArray,o=e.fnArray;let l=t||0;const c=r.length;if(c===l)return l;const d=c-l>Lp&&typeof s=="function",u=d?Date.now()+vS:0;let f=0;const p=this.commonObjs,m=this.objs;let v,y;for(;;){if(n!==void 0&&l===n.nextBreakPoint)return n.breakIt(l,s),l;if(!i||i.has(l))if(v=o[l],y=r[l]??null,v!==Gl.dependency)y===null?this[v](l):this[v](l,...y);else for(const E of y){(A=this.dependencyTracker)==null||A.recordNamedData(E,l);const S=E.startsWith("g_")?p:m;if(!S.has(E))return S.get(E,s),l}if(l++,l===c)return l;if(d&&++f>Lp){if(Date.now()>u)return s(),l;f=0}}}endDrawing(){w(this,Zs,Zu).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),w(this,Zs,qu).call(this)}_scaleImage(e,t){const s=e.width??e.displayWidth,n=e.height??e.displayHeight;let i=Math.max(Math.hypot(t[0],t[1]),1),r=Math.max(Math.hypot(t[2],t[3]),1),o=s,l=n,c="prescale1",d,u;for(;i>2&&o>1||r>2&&l>1;){let f=o,p=l;i>2&&o>1&&(f=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),i/=o/f),r>2&&l>1&&(p=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,r/=l/p),d=this.cachedCanvases.getCanvas(c,f,p),u=d.context,u.clearRect(0,0,f,p),u.drawImage(e,0,0,o,l,0,0,f,p),e=d.canvas,o=f,l=p,c=c==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:l}}_createMaskCanvas(e,t){var L,D;const s=this.ctx,{width:n,height:i}=t,r=this.current.fillColor,o=this.current.patternFill,l=Zt(s);let c,d,u,f;if((t.bitmap||t.data)&&t.count>1){const H=t.bitmap||t.data.buffer;d=JSON.stringify(o?l:[l.slice(0,4),r]),c=this._cachedBitmapsMap.get(H),c||(c=new Map,this._cachedBitmapsMap.set(H,c));const V=c.get(d);if(V&&!o){const G=Math.round(Math.min(l[0],l[2])+l[4]),q=Math.round(Math.min(l[1],l[3])+l[5]);return(L=this.dependencyTracker)==null||L.recordDependencies(e,Cs.transformAndFill),{canvas:V,offsetX:G,offsetY:q}}u=V}u||(f=this.cachedCanvases.getCanvas("maskCanvas",n,i),_p(f.context,t));let p=Z.transform(l,[1/n,0,0,-1/i,0,0]);p=Z.transform(p,[1,0,0,1,0,-i]);const m=to.slice();Z.axialAlignedBoundingBox([0,0,n,i],p,m);const[v,y,A,E]=m,S=Math.round(A-v)||1,x=Math.round(E-y)||1,T=this.cachedCanvases.getCanvas("fillCanvas",S,x),C=T.context,P=v,k=y;C.translate(-P,-k),C.transform(...p),u||(u=this._scaleImage(f.canvas,qs(C)),u=u.img,c&&o&&c.set(d,u)),C.imageSmoothingEnabled=Np(Zt(C),t.interpolate),Nh(C,u,0,0,u.width,u.height,0,0,n,i),C.globalCompositeOperation="source-in";const R=Z.transform(qs(C),[1,0,0,1,-P,-k]);return C.fillStyle=o?r.getPattern(s,this,R,ke.FILL):r,C.fillRect(0,0,n,i),c&&!o&&(this.cachedCanvases.delete("fillCanvas"),c.set(d,T.canvas)),(D=this.dependencyTracker)==null||D.recordDependencies(e,Cs.transformAndFill),{canvas:T.canvas,offsetX:Math.round(P),offsetY:Math.round(k)}}setLineWidth(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("lineCap",e),this.ctx.lineCap=AS[t]}setLineJoin(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("lineJoin",e),this.ctx.lineJoin=wS[t]}setMiterLimit(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,s){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("dash",e);const n=this.ctx;n.setLineDash!==void 0&&(n.setLineDash(t),n.lineDashOffset=s)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){var s,n,i,r,o;for(const[l,c]of t)switch(l){case"LW":this.setLineWidth(e,c);break;case"LC":this.setLineCap(e,c);break;case"LJ":this.setLineJoin(e,c);break;case"ML":this.setMiterLimit(e,c);break;case"D":this.setDash(e,c[0],c[1]);break;case"RI":this.setRenderingIntent(e,c);break;case"FL":this.setFlatness(e,c);break;case"Font":this.setFont(e,c[0],c[1]);break;case"CA":(s=this.dependencyTracker)==null||s.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=c;break;case"ca":(n=this.dependencyTracker)==null||n.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=c;break;case"BM":(i=this.dependencyTracker)==null||i.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=c;break;case"SMask":(r=this.dependencyTracker)==null||r.recordSimpleData("SMask",e),this.current.activeSMask=c?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":(o=this.dependencyTracker)==null||o.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(c);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,s=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(n,t,s);this.suspendedCtx=this.ctx;const r=this.ctx=i.context;r.setTransform(this.suspendedCtx.getTransform()),Al(this.suspendedCtx,r),yS(r,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Al(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,s,n){const i=n[0],r=n[1],o=n[2]-i,l=n[3]-r;o===0||l===0||(this.genericComposeSMask(t.context,s,o,l,t.subtype,t.backdrop,t.transferMap,i,r,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(s.canvas,0,0),e.restore())}genericComposeSMask(e,t,s,n,i,r,o,l,c,d,u){let f=e.canvas,p=l-d,m=c-u;if(r)if(p<0||m<0||p+s>f.width||m+n>f.height){const y=this.cachedCanvases.getCanvas("maskExtension",s,n),A=y.context;A.drawImage(f,-p,-m),A.globalCompositeOperation="destination-atop",A.fillStyle=r,A.fillRect(0,0,s,n),A.globalCompositeOperation="source-over",f=y.canvas,p=m=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const y=new Path2D;y.rect(p,m,s,n),e.clip(y),e.globalCompositeOperation="destination-atop",e.fillStyle=r,e.fillRect(p,m,s,n),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),i==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):i==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));const v=new Path2D;v.rect(l,c,s,n),t.clip(v),t.globalCompositeOperation="destination-in",t.drawImage(f,p,m,s,n,l,c,s,n),t.restore()}save(e){var s;this.inSMaskMode&&Al(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),(s=this.dependencyTracker)==null||s.save(e)}restore(e){var t;if((t=this.dependencyTracker)==null||t.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Al(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,s,n,i,r,o){var l;(l=this.dependencyTracker)==null||l.recordIncrementalData("transform",e),this.ctx.transform(t,s,n,i,r,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,s,n){let[i]=s;if(!n){i||(i=s[0]=new Path2D),this[t](e,i);return}if(this.dependencyTracker!==null){const r=t===Gl.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,n[0]-r,n[2]+r,n[1]-r,n[3]+r).recordDependencies(e,["transform"])}if(!(i instanceof Path2D)){const r=s[0]=new Path2D;for(let o=0,l=i.length;o<l;)switch(i[o++]){case Lh.moveTo:r.moveTo(i[o++],i[o++]);break;case Lh.lineTo:r.lineTo(i[o++],i[o++]);break;case Lh.curveTo:r.bezierCurveTo(i[o++],i[o++],i[o++],i[o++],i[o++],i[o++]);break;case Lh.closePath:r.closePath();break;default:lt(`Unrecognized drawing path operator: ${i[o-1]}`);break}i=r}Z.axialAlignedBoundingBox(n,Zt(this.ctx),this.current.minMax),this[t](e,i),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,s=!0){var r;const n=this.ctx,i=this.current.strokeColor;if(n.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof i=="object"&&(i!=null&&i.getPattern)){const o=i.isModifyingCurrentTransform()?n.getTransform():null;if(n.save(),n.strokeStyle=i.getPattern(n,this,qs(n),ke.STROKE),o){const l=new Path2D;l.addPath(t,n.getTransform().invertSelf().multiplySelf(o)),t=l}this.rescaleAndStroke(t,!1),n.restore()}else this.rescaleAndStroke(t,!0);(r=this.dependencyTracker)==null||r.recordDependencies(e,Cs.stroke),s&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(ke.STROKE,Zt(this.ctx))),n.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,s=!0){var c,d,u;const n=this.ctx,i=this.current.fillColor,r=this.current.patternFill;let o=!1;if(r){const f=i.isModifyingCurrentTransform()?n.getTransform():null;if((c=this.dependencyTracker)==null||c.save(e),n.save(),n.fillStyle=i.getPattern(n,this,qs(n),ke.FILL),f){const p=new Path2D;p.addPath(t,n.getTransform().invertSelf().multiplySelf(f)),t=p}o=!0}const l=this.current.getClippedPathBoundingBox();this.contentVisible&&l!==null&&(this.pendingEOFill?(n.fill(t,"evenodd"),this.pendingEOFill=!1):n.fill(t)),(d=this.dependencyTracker)==null||d.recordDependencies(e,Cs.fill),o&&(n.restore(),(u=this.dependencyTracker)==null||u.restore(e)),s&&this.consumePath(e,t,l)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){var s;this.ctx.fill(t),(s=this.dependencyTracker)==null||s.recordDependencies(e,Cs.rawFillPath).recordOperation(e)}clip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=SS}eoClip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=Fp}beginText(e){var t;this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,(t=this.dependencyTracker)==null||t.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,s=this.ctx;if(this.dependencyTracker){const{dependencyTracker:n}=this;t!==void 0&&n.recordFutureForcedDependency("textClip",n.getOpenMarker()).recordFutureForcedDependency("textClip",e),n.recordCloseMarker(e)}if(t!==void 0){const n=new Path2D,i=s.getTransform().invertSelf();for(const{transform:r,x:o,y:l,fontSize:c,path:d}of t)d&&n.addPath(d,new DOMMatrix(r).preMultiplySelf(i).translate(o,l).scale(c,-c));s.clip(n)}delete this.pendingTextPaths}setCharSpacing(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,s){var u,f;(u=this.dependencyTracker)==null||u.recordSimpleData("font",e).recordNamedDependency(e,t);const n=this.commonObjs.get(t),i=this.current;if(!n)throw new Error(`Can't find font for ${t}`);if(i.fontMatrix=n.fontMatrix||xu,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&lt("Invalid font matrix for font "+t),s<0?(s=-s,i.fontDirection=-1):i.fontDirection=1,this.current.font=n,this.current.fontSize=s,n.isType3Font)return;const r=n.loadedName||"sans-serif",o=((f=n.systemFontInfo)==null?void 0:f.css)||`"${r}", ${n.fallbackName}`;let l="normal";n.black?l="900":n.bold&&(l="bold");const c=n.italic?"italic":"normal";let d=s;s<kp?d=kp:s>Mp&&(d=Mp),this.current.fontSizeScale=s/d,this.ctx.font=`${c} ${l} ${d}px ${o}`}setTextRenderingMode(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,s){var n;(n=this.dependencyTracker)==null||n.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=s}setLeadingMoveText(e,t,s){this.setLeading(e,-s),this.moveText(e,t,s)}setTextMatrix(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("textMatrix",e);const{current:s}=this;s.textMatrix=t,s.textMatrixScale=Math.hypot(t[0],t[1]),s.x=s.lineX=0,s.y=s.lineY=0}nextLine(e){var t;this.moveText(e,0,this.current.leading),(t=this.dependencyTracker)==null||t.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}paintChar(e,t,s,n,i,r){var A,E,S,x;const o=this.ctx,l=this.current,c=l.font,d=l.textRenderingMode,u=l.fontSize/l.fontSizeScale,f=d&Ee.FILL_STROKE_MASK,p=!!(d&Ee.ADD_TO_PATH_FLAG),m=l.patternFill&&!c.missingFile,v=l.patternStroke&&!c.missingFile;let y;if((c.disableFontFace||p||m||v)&&!c.missingFile&&(y=c.getPathGenerator(this.commonObjs,t)),y&&(c.disableFontFace||m||v)){o.save(),o.translate(s,n),o.scale(u,-u),(A=this.dependencyTracker)==null||A.recordCharacterBBox(e,o,c);let T;if(f===Ee.FILL||f===Ee.FILL_STROKE)if(i){T=o.getTransform(),o.setTransform(...i);const C=w(this,Zs,tf).call(this,y,T,i);o.fill(C)}else o.fill(y);if(f===Ee.STROKE||f===Ee.FILL_STROKE)if(r){T||(T=o.getTransform()),o.setTransform(...r);const{a:C,b:P,c:k,d:R}=T,L=Z.inverseTransform(r),D=Z.transform([C,P,k,R,0,0],L);Z.singularValueDecompose2dScale(D,ws),o.lineWidth*=Math.max(ws[0],ws[1])/u,o.stroke(w(this,Zs,tf).call(this,y,T,r))}else o.lineWidth/=u,o.stroke(y);o.restore()}else(f===Ee.FILL||f===Ee.FILL_STROKE)&&(o.fillText(t,s,n),(E=this.dependencyTracker)==null||E.recordCharacterBBox(e,o,c,u,s,n,()=>o.measureText(t))),(f===Ee.STROKE||f===Ee.FILL_STROKE)&&(this.dependencyTracker&&((S=this.dependencyTracker)==null||S.recordCharacterBBox(e,o,c,u,s,n,()=>o.measureText(t)).recordDependencies(e,Cs.stroke)),o.strokeText(t,s,n));p&&((this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Zt(o),x:s,y:n,fontSize:u,path:y}),(x=this.dependencyTracker)==null||x.recordCharacterBBox(e,o,c,u,s,n))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let s=!1;for(let n=3;n<t.length;n+=4)if(t[n]>0&&t[n]<255){s=!0;break}return At(this,"isFontSubpixelAAEnabled",s)}showText(e,t){var k,R,L,D;this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,Cs.showText).copyDependenciesFromIncrementalOperation(e,"sameLineText").resetBBox(e),this.current.textRenderingMode&Ee.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const s=this.current,n=s.font;if(n.isType3Font){this.showType3Text(e,t),(k=this.dependencyTracker)==null||k.recordOperation(e).recordIncrementalData("sameLineText",e);return}const i=s.fontSize;if(i===0){(R=this.dependencyTracker)==null||R.recordOperation(e);return}const r=this.ctx,o=s.fontSizeScale,l=s.charSpacing,c=s.wordSpacing,d=s.fontDirection,u=s.textHScale*d,f=t.length,p=n.vertical,m=p?1:-1,v=n.defaultVMetrics,y=i*s.fontMatrix[0],A=s.textRenderingMode===Ee.FILL&&!n.disableFontFace&&!s.patternFill;r.save(),s.textMatrix&&r.transform(...s.textMatrix),r.translate(s.x,s.y+s.textRise),d>0?r.scale(u,-1):r.scale(u,1);let E,S;if(s.patternFill){r.save();const H=s.fillColor.getPattern(r,this,qs(r),ke.FILL);E=Zt(r),r.restore(),r.fillStyle=H}if(s.patternStroke){r.save();const H=s.strokeColor.getPattern(r,this,qs(r),ke.STROKE);S=Zt(r),r.restore(),r.strokeStyle=H}let x=s.lineWidth;const T=s.textMatrixScale;if(T===0||x===0){const H=s.textRenderingMode&Ee.FILL_STROKE_MASK;(H===Ee.STROKE||H===Ee.FILL_STROKE)&&(x=this.getSinglePixelWidth())}else x/=T;if(o!==1&&(r.scale(o,o),x/=o),r.lineWidth=x,n.isInvalidPDFjsFont){const H=[];let V=0;for(const q of t)H.push(q.unicode),V+=q.width;const G=H.join("");if(r.fillText(G,0,0),this.dependencyTracker!==null){const q=r.measureText(G);this.dependencyTracker.recordBBox(e,this.ctx,-q.actualBoundingBoxLeft,q.actualBoundingBoxRight,-q.actualBoundingBoxAscent,q.actualBoundingBoxDescent).recordOperation(e).recordIncrementalData("sameLineText",e)}s.x+=V*y*u,r.restore(),this.compose();return}let C=0,P;for(P=0;P<f;++P){const H=t[P];if(typeof H=="number"){C+=m*H*i/1e3;continue}let V=!1;const G=(H.isSpace?c:0)+l,q=H.fontChar,j=H.accent;let F,nt,ct=H.width;if(p){const ut=H.vmetric||v,mt=-(H.vmetric?ut[1]:ct*.5)*y,Ht=ut[2]*y;ct=ut?-ut[0]:ct,F=mt/o,nt=(C+Ht)/o}else F=C/o,nt=0;let Pt;if(n.remeasure&&ct>0){Pt=r.measureText(q);const ut=Pt.width*1e3/i*o;if(ct<ut&&this.isFontSubpixelAAEnabled){const mt=ct/ut;V=!0,r.save(),r.scale(mt,1),F/=mt}else ct!==ut&&(F+=(ct-ut)/2e3*i/o)}if(this.contentVisible&&(H.isInFont||n.missingFile)){if(A&&!j)r.fillText(q,F,nt),(L=this.dependencyTracker)==null||L.recordCharacterBBox(e,r,Pt?{bbox:null}:n,i/o,F,nt,()=>Pt??r.measureText(q));else if(this.paintChar(e,q,F,nt,E,S),j){const ut=F+i*j.offset.x/o,mt=nt-i*j.offset.y/o;this.paintChar(e,j.fontChar,ut,mt,E,S)}}const Kt=p?ct*y-G*d:ct*y+G*d;C+=Kt,V&&r.restore()}p?s.y-=C:s.x+=C*u,r.restore(),this.compose(),(D=this.dependencyTracker)==null||D.recordOperation(e).recordIncrementalData("sameLineText",e)}showType3Text(e,t){const s=this.ctx,n=this.current,i=n.font,r=n.fontSize,o=n.fontDirection,l=i.vertical?1:-1,c=n.charSpacing,d=n.wordSpacing,u=n.textHScale*o,f=n.fontMatrix||xu,p=t.length,m=n.textRenderingMode===Ee.INVISIBLE;let v,y,A,E;if(m||r===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,s.save(),n.textMatrix&&s.transform(...n.textMatrix),s.translate(n.x,n.y+n.textRise),s.scale(u,o);const S=this.dependencyTracker;for(this.dependencyTracker=S?new Sd(S,e):null,v=0;v<p;++v){if(y=t[v],typeof y=="number"){E=l*y*r/1e3,this.ctx.translate(E,0),n.x+=E*u;continue}const x=(y.isSpace?d:0)+c,T=i.charProcOperatorList[y.operatorListId];T?this.contentVisible&&(this.save(),s.scale(r,r),s.transform(...f),this.executeOperatorList(T),this.restore()):lt(`Type3 character "${y.operatorListId}" is not available.`);const C=[y.width,0];Z.applyTransform(C,f),A=C[0]*r+x,s.translate(A,0),n.x+=A*u}s.restore(),S&&(this.dependencyTracker.recordNestedDependencies(),this.dependencyTracker=S)}setCharWidth(e,t,s){}setCharWidthAndBounds(e,t,s,n,i,r,o){var c;const l=new Path2D;l.rect(n,i,r-n,o-i),this.ctx.clip(l),(c=this.dependencyTracker)==null||c.recordBBox(e,this.ctx,n,r,i,o).recordClipBox(e,this.ctx,n,r,i,o),this.endPath(e)}getColorN_Pattern(e,t){let s;if(t[0]==="TilingPattern"){const n=this.baseTransform||Zt(this.ctx),i={createCanvasGraphics:r=>new fp(r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new Sd(this.dependencyTracker,e):null)};s=new Qu(t,this.ctx,i,n)}else s=this._getPattern(e,t[1],t[2]);return s}setStrokeColorN(e,...t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,s=null){let n;return this.cachedPatterns.has(t)?n=this.cachedPatterns.get(t):(n=gS(this.getObject(e,t)),this.cachedPatterns.set(t,n)),s&&(n.matrix=s),n}shadingFill(e,t){var r;if(!this.contentVisible)return;const s=this.ctx;this.save(e);const n=this._getPattern(e,t);s.fillStyle=n.getPattern(s,this,qs(s),ke.SHADING);const i=qs(s);if(i){const{width:o,height:l}=s.canvas,c=to.slice();Z.axialAlignedBoundingBox([0,0,o,l],i,c);const[d,u,f,p]=c;this.ctx.fillRect(d,u,f-d,p-u)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);(r=this.dependencyTracker)==null||r.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,Cs.transform).recordDependencies(e,Cs.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){$t("Should not call beginInlineImage")}beginImageData(){$t("Should not call beginImageData")}paintFormXObjectBegin(e,t,s){var n;if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=Zt(this.ctx),s)){Z.axialAlignedBoundingBox(s,this.baseTransform,this.current.minMax);const[i,r,o,l]=s,c=new Path2D;c.rect(i,r,o-i,l-r),this.ctx.clip(c),(n=this.dependencyTracker)==null||n.recordClipBox(e,this.ctx,i,o,r,l),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){var S;if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const s=this.ctx;t.isolated||iu("TODO: Support non-isolated groups."),t.knockout&&lt("Knockout groups not supported.");const n=Zt(s);if(t.matrix&&s.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let i=to.slice();Z.axialAlignedBoundingBox(t.bbox,Zt(s),i);const r=[0,0,s.canvas.width,s.canvas.height];i=Z.intersect(i,r)||[0,0,0,0];const o=Math.floor(i[0]),l=Math.floor(i[1]),c=Math.max(Math.ceil(i[2])-o,1),d=Math.max(Math.ceil(i[3])-l,1);this.current.startNewPathAndClipBox([0,0,c,d]);let u="groupAt"+this.groupLevel;t.smask&&(u+="_smask_"+this.smaskCounter++%2);const f=this.cachedCanvases.getCanvas(u,c,d),p=f.context;p.translate(-o,-l),p.transform(...n);let m=new Path2D;const[v,y,A,E]=t.bbox;if(m.rect(v,y,A-v,E-y),t.matrix){const x=new Path2D;x.addPath(m,new DOMMatrix(t.matrix)),m=x}p.clip(m),t.smask&&this.smaskStack.push({canvas:f.canvas,context:p,offsetX:o,offsetY:l,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(s.setTransform(1,0,0,1,0,0),s.translate(o,l),s.save()),Al(s,p),this.ctx=p,(S=this.dependencyTracker)==null||S.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(s),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(s),this.groupLevel++}endGroup(e,t){var i;if(!this.contentVisible)return;this.groupLevel--;const s=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,(i=this.dependencyTracker)==null||i.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const r=Zt(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...r);const o=to.slice();Z.axialAlignedBoundingBox([0,0,s.canvas.width,s.canvas.height],r,o),this.ctx.drawImage(s.canvas,0,0),this.ctx.restore(),this.compose(o)}}beginAnnotation(e,t,s,n,i,r){if(w(this,Zs,Zu).call(this),Fh(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),s){const o=s[2]-s[0],l=s[3]-s[1];if(r&&this.annotationCanvasMap){n=n.slice(),n[4]-=s[0],n[5]-=s[1],s=s.slice(),s[0]=s[1]=0,s[2]=o,s[3]=l,Z.singularValueDecompose2dScale(Zt(this.ctx),ws);const{viewportScale:c}=this,d=Math.ceil(o*this.outputScaleX*c),u=Math.ceil(l*this.outputScaleY*c);this.annotationCanvas=this.canvasFactory.create(d,u);const{canvas:f,context:p}=this.annotationCanvas;this.annotationCanvasMap.set(t,f),this.annotationCanvas.savedCtx=this.ctx,this.ctx=p,this.ctx.save(),this.ctx.setTransform(ws[0],0,0,-ws[1],0,l*ws[1]),Fh(this.ctx)}else{Fh(this.ctx),this.endPath(e);const c=new Path2D;c.rect(s[0],s[1],o,l),this.ctx.clip(c)}}this.current=new Dp(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...n),this.transform(e,...i)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),w(this,Zs,qu).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){var o;if(!this.contentVisible)return;const s=t.count;t=this.getObject(e,t.data,t),t.count=s;const n=this.ctx,i=this._createMaskCanvas(e,t),r=i.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(r,i.offsetX,i.offsetY),(o=this.dependencyTracker)==null||o.resetBBox(e).recordBBox(e,this.ctx,i.offsetX,i.offsetX+r.width,i.offsetY,i.offsetY+r.height).recordOperation(e),n.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,s,n=0,i=0,r,o){var u,f,p;if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const l=this.ctx;l.save();const c=Zt(l);l.transform(s,n,i,r,0,0);const d=this._createMaskCanvas(e,t);l.setTransform(1,0,0,1,d.offsetX-c[4],d.offsetY-c[5]),(u=this.dependencyTracker)==null||u.resetBBox(e);for(let m=0,v=o.length;m<v;m+=2){const y=Z.transform(c,[s,n,i,r,o[m],o[m+1]]);l.drawImage(d.canvas,y[4],y[5]),(f=this.dependencyTracker)==null||f.recordBBox(e,this.ctx,y[4],y[4]+d.canvas.width,y[5],y[5]+d.canvas.height)}l.restore(),this.compose(),(p=this.dependencyTracker)==null||p.recordOperation(e)}paintImageMaskXObjectGroup(e,t){var r,o,l;if(!this.contentVisible)return;const s=this.ctx,n=this.current.fillColor,i=this.current.patternFill;(r=this.dependencyTracker)==null||r.resetBBox(e).recordDependencies(e,Cs.transformAndFill);for(const c of t){const{data:d,width:u,height:f,transform:p}=c,m=this.cachedCanvases.getCanvas("maskCanvas",u,f),v=m.context;v.save();const y=this.getObject(e,d,c);_p(v,y),v.globalCompositeOperation="source-in",v.fillStyle=i?n.getPattern(v,this,qs(s),ke.FILL):n,v.fillRect(0,0,u,f),v.restore(),s.save(),s.transform(...p),s.scale(1,-1),Nh(s,m.canvas,0,0,u,f,0,-1,1,1),(o=this.dependencyTracker)==null||o.recordBBox(e,s,0,u,0,f),s.restore()}this.compose(),(l=this.dependencyTracker)==null||l.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const s=this.getObject(e,t);if(!s){lt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,s)}paintImageXObjectRepeat(e,t,s,n,i){if(!this.contentVisible)return;const r=this.getObject(e,t);if(!r){lt("Dependent image isn't ready yet");return}const o=r.width,l=r.height,c=[];for(let d=0,u=i.length;d<u;d+=2)c.push({transform:[s,0,0,n,i[d],i[d+1]],x:0,y:0,w:o,h:l});this.paintInlineImageXObjectGroup(e,r,c)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:s,height:n}=e,i=this.cachedCanvases.getCanvas("inlineImage",s,n),r=i.context;return r.filter=this.current.transferMaps,r.drawImage(t,0,0),r.filter="none",i.canvas}paintInlineImageXObject(e,t){var c;if(!this.contentVisible)return;const s=t.width,n=t.height,i=this.ctx;this.save(e);const{filter:r}=i;r!=="none"&&r!==""&&(i.filter="none"),i.scale(1/s,-1/n);let o;if(t.bitmap)o=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)o=t;else{const u=this.cachedCanvases.getCanvas("inlineImage",s,n).context;Op(u,t),o=this.applyTransferMapsToCanvas(u)}const l=this._scaleImage(o,qs(i));i.imageSmoothingEnabled=Np(Zt(i),t.interpolate),(c=this.dependencyTracker)==null||c.resetBBox(e).recordBBox(e,i,0,s,-n,0).recordDependencies(e,Cs.imageXObject).recordOperation(e),Nh(i,l.img,0,0,l.paintWidth,l.paintHeight,0,-n,s,n),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,s){var r,o,l;if(!this.contentVisible)return;const n=this.ctx;let i;if(t.bitmap)i=t.bitmap;else{const c=t.width,d=t.height,f=this.cachedCanvases.getCanvas("inlineImage",c,d).context;Op(f,t),i=this.applyTransferMapsToCanvas(f)}(r=this.dependencyTracker)==null||r.resetBBox(e);for(const c of s)n.save(),n.transform(...c.transform),n.scale(1,-1),Nh(n,i,c.x,c.y,c.w,c.h,0,-1,1,1),(o=this.dependencyTracker)==null||o.recordBBox(e,n,0,1,-1,0),n.restore();(l=this.dependencyTracker)==null||l.recordOperation(e),this.compose()}paintSolidColorImageMask(e){var t;this.contentVisible&&((t=this.dependencyTracker)==null||t.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,Cs.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,s){}beginMarkedContent(e,t){var s;(s=this.dependencyTracker)==null||s.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,s){var n;(n=this.dependencyTracker)==null||n.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(s)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){var t;(t=this.dependencyTracker)==null||t.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,s){var r,o;const n=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const i=this.ctx;this.pendingClip?(n||(this.pendingClip===Fp?i.clip(t,"evenodd"):i.clip(t)),this.pendingClip=null,(r=this.dependencyTracker)==null||r.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):(o=this.dependencyTracker)==null||o.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Zt(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),s=Math.hypot(e[0],e[2]),n=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(s,n)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:s,c:n,d:i}=this.ctx.getTransform();let r,o;if(s===0&&n===0){const l=Math.abs(t),c=Math.abs(i);if(l===c)if(e===0)r=o=1/l;else{const d=l*e;r=o=d<1?1/d:1}else if(e===0)r=1/l,o=1/c;else{const d=l*e,u=c*e;r=d<1?1/d:1,o=u<1?1/u:1}}else{const l=Math.abs(t*i-s*n),c=Math.hypot(t,s),d=Math.hypot(n,i);if(e===0)r=d/l,o=c/l;else{const u=e*l;r=d>u?d/u:1,o=c>u?c/u:1}}this._cachedScaleForStroking[0]=r,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:s,current:{lineWidth:n}}=this,[i,r]=this.getScaleForStroking();if(i===r){s.lineWidth=(n||1)*i,s.stroke(e);return}const o=s.getLineDash();t&&s.save(),s.scale(i,r),vu.a=1/i,vu.d=1/r;const l=new Path2D;if(l.addPath(e,vu),o.length>0){const c=Math.max(i,r);s.setLineDash(o.map(d=>d/c)),s.lineDashOffset/=c}s.lineWidth=n||1,s.stroke(l),t&&s.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};Zs=new WeakSet,Zu=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},qu=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},tf=function(e,t,s){const n=new Path2D;return n.addPath(e,new DOMMatrix(s).invertSelf().multiplySelf(t)),n};let no=fp;for(const h in Gl)no.prototype[h]!==void 0&&(no.prototype[Gl[h]]=no.prototype[h]);var Sc,Ec;class Tn{static get workerPort(){return a(this,Sc)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");g(this,Sc,e)}static get workerSrc(){return a(this,Ec)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");g(this,Ec,e)}}Sc=new WeakMap,Ec=new WeakMap,b(Tn,Sc,null),b(Tn,Ec,"");var Oo,Tc;class ES{constructor({parsedData:e,rawData:t}){b(this,Oo);b(this,Tc);g(this,Oo,e),g(this,Tc,t)}getRaw(){return a(this,Tc)}get(e){return a(this,Oo).get(e)??null}[Symbol.iterator](){return a(this,Oo).entries()}}Oo=new WeakMap,Tc=new WeakMap;const Qa=Symbol("INTERNAL");var xc,Cc,Pc,_o;class TS{constructor(e,{name:t,intent:s,usage:n,rbGroups:i}){b(this,xc,!1);b(this,Cc,!1);b(this,Pc,!1);b(this,_o,!0);g(this,xc,!!(e&As.DISPLAY)),g(this,Cc,!!(e&As.PRINT)),this.name=t,this.intent=s,this.usage=n,this.rbGroups=i}get visible(){if(a(this,Pc))return a(this,_o);if(!a(this,_o))return!1;const{print:e,view:t}=this.usage;return a(this,xc)?(t==null?void 0:t.viewState)!=="OFF":a(this,Cc)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,s=!1){e!==Qa&&$t("Internal method `_setVisible` called."),g(this,Pc,s),g(this,_o,t)}}xc=new WeakMap,Cc=new WeakMap,Pc=new WeakMap,_o=new WeakMap;var Ki,Ft,No,Fo,Ic,ef;class xS{constructor(e,t=As.DISPLAY){b(this,Ic);b(this,Ki,null);b(this,Ft,new Map);b(this,No,null);b(this,Fo,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,g(this,Fo,e.order);for(const s of e.groups)a(this,Ft).set(s.id,new TS(t,s));if(e.baseState==="OFF")for(const s of a(this,Ft).values())s._setVisible(Qa,!1);for(const s of e.on)a(this,Ft).get(s)._setVisible(Qa,!0);for(const s of e.off)a(this,Ft).get(s)._setVisible(Qa,!1);g(this,No,this.getHash())}}isVisible(e){if(a(this,Ft).size===0)return!0;if(!e)return iu("Optional content group not defined."),!0;if(e.type==="OCG")return a(this,Ft).has(e.id)?a(this,Ft).get(e.id).visible:(lt(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return w(this,Ic,ef).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!a(this,Ft).has(t))return lt(`Optional content group not found: ${t}`),!0;if(a(this,Ft).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!a(this,Ft).has(t))return lt(`Optional content group not found: ${t}`),!0;if(!a(this,Ft).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!a(this,Ft).has(t))return lt(`Optional content group not found: ${t}`),!0;if(!a(this,Ft).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!a(this,Ft).has(t))return lt(`Optional content group not found: ${t}`),!0;if(a(this,Ft).get(t).visible)return!1}return!0}return lt(`Unknown optional content policy ${e.policy}.`),!0}return lt(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,s=!0){var i;const n=a(this,Ft).get(e);if(!n){lt(`Optional content group not found: ${e}`);return}if(s&&t&&n.rbGroups.length)for(const r of n.rbGroups)for(const o of r)o!==e&&((i=a(this,Ft).get(o))==null||i._setVisible(Qa,!1,!0));n._setVisible(Qa,!!t,!0),g(this,Ki,null)}setOCGState({state:e,preserveRB:t}){let s;for(const n of e){switch(n){case"ON":case"OFF":case"Toggle":s=n;continue}const i=a(this,Ft).get(n);if(i)switch(s){case"ON":this.setVisibility(n,!0,t);break;case"OFF":this.setVisibility(n,!1,t);break;case"Toggle":this.setVisibility(n,!i.visible,t);break}}g(this,Ki,null)}get hasInitialVisibility(){return a(this,No)===null||this.getHash()===a(this,No)}getOrder(){return a(this,Ft).size?a(this,Fo)?a(this,Fo).slice():[...a(this,Ft).keys()]:null}getGroup(e){return a(this,Ft).get(e)||null}getHash(){if(a(this,Ki)!==null)return a(this,Ki);const e=new Fg;for(const[t,s]of a(this,Ft))e.update(`${t}:${s.visible}`);return g(this,Ki,e.hexdigest())}[Symbol.iterator](){return a(this,Ft).entries()}}Ki=new WeakMap,Ft=new WeakMap,No=new WeakMap,Fo=new WeakMap,Ic=new WeakSet,ef=function(e){const t=e.length;if(t<2)return!0;const s=e[0];for(let n=1;n<t;n++){const i=e[n];let r;if(Array.isArray(i))r=w(this,Ic,ef).call(this,i);else if(a(this,Ft).has(i))r=a(this,Ft).get(i).visible;else return lt(`Optional content group not found: ${i}`),!0;switch(s){case"And":if(!r)return!1;break;case"Or":if(r)return!0;break;case"Not":return!r;default:return!0}}return s==="And"};class CS{constructor(e,{disableRange:t=!1,disableStream:s=!1}){oe(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:n,initialData:i,progressiveDone:r,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=r,this._contentDispositionFilename=o,(i==null?void 0:i.length)>0){const l=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!s,this._isRangeSupported=!t,this._contentLength=n,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,c)=>{this._onReceiveData({begin:l,chunk:c})}),e.addProgressListener((l,c)=>{this._onProgress({loaded:l,total:c})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const s=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const n=this._rangeReaders.some(function(i){return i._begin!==e?!1:(i._enqueue(s),!0)});oe(n,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,s,n,i;e.total===void 0?(s=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||s.call(t,{loaded:e.loaded}):(i=(n=this._fullRequestReader)==null?void 0:n.onProgress)==null||i.call(n,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){oe(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new PS(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new IS(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeReaders.slice(0))s.cancel(e);this._pdfDataRangeTransport.abort()}}class PS{constructor(e,t,s=!1,n=null){this._stream=e,this._done=s||!1,this._filename=sp(n)?n:null,this._queuedChunks=t||[],this._loaded=0;for(const i of this._queuedChunks)this._loaded+=i.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class IS{constructor(e,t,s){this._stream=e,this._begin=t,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function RS(h){let e=!0,t=s("filename\\*","i").exec(h);if(t){t=t[1];let d=o(t);return d=unescape(d),d=l(d),d=c(d),i(d)}if(t=r(h),t){const d=c(t);return i(d)}if(t=s("filename","i").exec(h),t){t=t[1];let d=o(t);return d=c(d),i(d)}function s(d,u){return new RegExp("(?:^|;)\\s*"+d+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',u)}function n(d,u){if(d){if(!/^[\x00-\xFF]+$/.test(u))return u;try{const f=new TextDecoder(d,{fatal:!0}),p=xh(u);u=f.decode(p),e=!1}catch{}}return u}function i(d){return e&&/[\x80-\xff]/.test(d)&&(d=n("utf-8",d),e&&(d=n("iso-8859-1",d))),d}function r(d){const u=[];let f;const p=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(f=p.exec(d))!==null;){let[,v,y,A]=f;if(v=parseInt(v,10),v in u){if(v===0)break;continue}u[v]=[y,A]}const m=[];for(let v=0;v<u.length&&v in u;++v){let[y,A]=u[v];A=o(A),y&&(A=unescape(A),v===0&&(A=l(A))),m.push(A)}return m.join("")}function o(d){if(d.startsWith('"')){const u=d.slice(1).split('\\"');for(let f=0;f<u.length;++f){const p=u[f].indexOf('"');p!==-1&&(u[f]=u[f].slice(0,p),u.length=f+1),u[f]=u[f].replaceAll(/\\(.)/g,"$1")}d=u.join('"')}return d}function l(d){const u=d.indexOf("'");if(u===-1)return d;const f=d.slice(0,u),m=d.slice(u+1).replace(/^[^']*'/,"");return n(f,m)}function c(d){return!d.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(d)?d:d.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(u,f,p,m){if(p==="q"||p==="Q")return m=m.replaceAll("_"," "),m=m.replaceAll(/=([0-9a-fA-F]{2})/g,function(v,y){return String.fromCharCode(parseInt(y,16))}),n(f,m);try{m=atob(m)}catch{}return n(f,m)})}return""}function Kg(h,e){const t=new Headers;if(!h||!e||typeof e!="object")return t;for(const s in e){const n=e[s];n!==void 0&&t.append(s,n)}return t}function ou(h){var e;return((e=URL.parse(h))==null?void 0:e.origin)??null}function Jg({responseHeaders:h,isHttp:e,rangeChunkSize:t,disableRange:s}){const n={allowRangeRequests:!1,suggestedLength:void 0},i=parseInt(h.get("Content-Length"),10);return!Number.isInteger(i)||(n.suggestedLength=i,i<=2*t)||s||!e||h.get("Accept-Ranges")!=="bytes"||(h.get("Content-Encoding")||"identity")!=="identity"||(n.allowRangeRequests=!0),n}function Qg(h){const e=h.get("Content-Disposition");if(e){let t=RS(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(sp(t))return t}return null}function Rh(h,e){return new yd(`Unexpected server response (${h}) while retrieving PDF "${e}".`,h,h===404||h===0&&e.startsWith("file:"))}function Zg(h){return h===200||h===206}function qg(h,e,t){return{method:"GET",headers:h,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function tm(h){return h instanceof Uint8Array?h.buffer:h instanceof ArrayBuffer?h:(lt(`getArrayBuffer - unexpected data format: ${h}`),new Uint8Array(h).buffer)}class kS{constructor(e){U(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=Kg(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return oe(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new MS(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new LS(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class MS{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const s=new Headers(e.headers),n=t.url;fetch(n,qg(s,this._withCredentials,this._abortController)).then(i=>{if(e._responseOrigin=ou(i.url),!Zg(i.status))throw Rh(i.status,n);this._reader=i.body.getReader(),this._headersCapability.resolve();const r=i.headers,{allowRangeRequests:o,suggestedLength:l}=Jg({responseHeaders:r,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=l||this._contentLength,this._filename=Qg(r),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new wr("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:tm(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class LS{constructor(e,t,s){this._stream=e,this._reader=null,this._loaded=0;const n=e.source;this._withCredentials=n.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!n.disableStream,this._abortController=new AbortController;const i=new Headers(e.headers);i.append("Range",`bytes=${t}-${s-1}`);const r=n.url;fetch(r,qg(i,this._withCredentials,this._abortController)).then(o=>{const l=ou(o.url);if(l!==e._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${e._responseOrigin}".`);if(!Zg(o.status))throw Rh(o.status,r);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:tm(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const yu=200,bu=206;function DS(h){const e=h.response;return typeof e!="string"?e:xh(e).buffer}class OS{constructor({url:e,httpHeaders:t,withCredentials:s}){U(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=Kg(this.isHttp,t),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,s=this.currXhrId++,n=this.pendingRequests[s]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[i,r]of this.headers)t.setRequestHeader(i,r);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),n.expectedStatus=bu):n.expectedStatus=yu,t.responseType="arraybuffer",oe(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,s),t.onprogress=this.onProgress.bind(this,s),n.onHeadersReceived=e.onHeadersReceived,n.onDone=e.onDone,n.onError=e.onError,n.onProgress=e.onProgress,t.send(null),s}onProgress(e,t){var n;const s=this.pendingRequests[e];s&&((n=s.onProgress)==null||n.call(s,t))}onStateChange(e,t){const s=this.pendingRequests[e];if(!s)return;const n=s.xhr;if(n.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),n.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],n.status===0&&this.isHttp){s.onError(n.status);return}const i=n.status||yu;if(!(i===yu&&s.expectedStatus===bu)&&i!==s.expectedStatus){s.onError(n.status);return}const o=DS(n);if(i===bu){const l=n.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);c?s.onDone({begin:parseInt(c[1],10),chunk:o}):(lt('Missing or invalid "Content-Range" header.'),s.onError(0))}else o?s.onDone({begin:0,chunk:o}):s.onError(n.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class _S{constructor(e){this._source=e,this._manager=new OS(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return oe(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new NS(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const s=new FS(this._manager,e,t);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class NS{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=ou(t.responseURL);const s=t.getAllResponseHeaders(),n=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(o=>{const[l,...c]=o.split(": ");return[l,c.join(": ")]}):[]),{allowRangeRequests:i,suggestedLength:r}=Jg({responseHeaders:n,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=r||this._contentLength,this._filename=Qg(n),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Rh(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class FS{constructor(e,t,s){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=ou((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=Rh(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const BS=/^[a-z][a-z0-9\-+.]+:/i;function $S(h){if(BS.test(h))return new URL(h);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(h))}class HS{constructor(e){this.source=e,this.url=$S(e.url),oe(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return oe(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new VS(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new US(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class VS{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(n=>{this._contentLength=n.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},n=>{n.code==="ENOENT"&&(n=Rh(0,this._url.href)),this._storedError=n,this._headersCapability.reject(n)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new wr("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class US{constructor(e,t,s){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const n=e.source;this._isStreamingSupported=!n.disableStream;const i=process.getBuiltinModule("fs");this._setReadableStream(i.createReadStream(this._url,{start:t,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const wl=Symbol("INITIAL_DATA");var ls,Rc,sf;class em{constructor(){b(this,Rc);b(this,ls,Object.create(null))}get(e,t=null){if(t){const n=w(this,Rc,sf).call(this,e);return n.promise.then(()=>t(n.data)),null}const s=a(this,ls)[e];if(!s||s.data===wl)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return s.data}has(e){const t=a(this,ls)[e];return!!t&&t.data!==wl}delete(e){const t=a(this,ls)[e];return!t||t.data===wl?!1:(delete a(this,ls)[e],!0)}resolve(e,t=null){const s=w(this,Rc,sf).call(this,e);s.data=t,s.resolve()}clear(){var e;for(const t in a(this,ls)){const{data:s}=a(this,ls)[t];(e=s==null?void 0:s.bitmap)==null||e.close()}g(this,ls,Object.create(null))}*[Symbol.iterator](){for(const e in a(this,ls)){const{data:t}=a(this,ls)[e];t!==wl&&(yield[e,t])}}}ls=new WeakMap,Rc=new WeakSet,sf=function(e){var t;return(t=a(this,ls))[e]||(t[e]={...Promise.withResolvers(),data:wl})};const jS=1e5,Bp=30;var jp,Ji,qe,kc,Mc,Qr,qn,Lc,Dc,Zr,Bo,$o,Qi,Ho,Oc,Vo,qr,_c,Nc,Uo,ta,Fc,Zi,jo,Ti,sm,nm,nf,Es,Jh,rf,im,rm;const he=class he{constructor({textContentSource:e,container:t,viewport:s}){b(this,Ti);b(this,Ji,Promise.withResolvers());b(this,qe,null);b(this,kc,!1);b(this,Mc,!!((jp=globalThis.FontInspector)!=null&&jp.enabled));b(this,Qr,null);b(this,qn,null);b(this,Lc,0);b(this,Dc,0);b(this,Zr,null);b(this,Bo,null);b(this,$o,0);b(this,Qi,0);b(this,Ho,Object.create(null));b(this,Oc,[]);b(this,Vo,null);b(this,qr,[]);b(this,_c,new WeakMap);b(this,Nc,null);var l;if(e instanceof ReadableStream)g(this,Vo,e);else if(typeof e=="object")g(this,Vo,new ReadableStream({start(c){c.enqueue(e),c.close()}}));else throw new Error('No "textContentSource" parameter specified.');g(this,qe,g(this,Bo,t)),g(this,Qi,s.scale*Pn.pixelRatio),g(this,$o,s.rotation),g(this,qn,{div:null,properties:null,ctx:null});const{pageWidth:n,pageHeight:i,pageX:r,pageY:o}=s.rawDims;g(this,Nc,[1,0,0,-1,-r,o+i]),g(this,Dc,n),g(this,Lc,i),w(l=he,Es,im).call(l),Fa(t,s),a(this,Ji).promise.finally(()=>{a(he,jo).delete(this),g(this,qn,null),g(this,Ho,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=De.platform;return At(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{a(this,Zr).read().then(({value:t,done:s})=>{if(s){a(this,Ji).resolve();return}a(this,Qr)??g(this,Qr,t.lang),Object.assign(a(this,Ho),t.styles),w(this,Ti,sm).call(this,t.items),e()},a(this,Ji).reject)};return g(this,Zr,a(this,Vo).getReader()),a(he,jo).add(this),e(),a(this,Ji).promise}update({viewport:e,onBefore:t=null}){var i;const s=e.scale*Pn.pixelRatio,n=e.rotation;if(n!==a(this,$o)&&(t==null||t(),g(this,$o,n),Fa(a(this,Bo),{rotation:n})),s!==a(this,Qi)){t==null||t(),g(this,Qi,s);const r={div:null,properties:null,ctx:w(i=he,Es,Jh).call(i,a(this,Qr))};for(const o of a(this,qr))r.properties=a(this,_c).get(o),r.div=o,w(this,Ti,nf).call(this,r)}}cancel(){var t;const e=new wr("TextLayer task cancelled.");(t=a(this,Zr))==null||t.cancel(e).catch(()=>{}),g(this,Zr,null),a(this,Ji).reject(e)}get textDivs(){return a(this,qr)}get textContentItemsStr(){return a(this,Oc)}static cleanup(){if(!(a(this,jo).size>0)){a(this,Uo).clear();for(const{canvas:e}of a(this,ta).values())e.remove();a(this,ta).clear()}}};Ji=new WeakMap,qe=new WeakMap,kc=new WeakMap,Mc=new WeakMap,Qr=new WeakMap,qn=new WeakMap,Lc=new WeakMap,Dc=new WeakMap,Zr=new WeakMap,Bo=new WeakMap,$o=new WeakMap,Qi=new WeakMap,Ho=new WeakMap,Oc=new WeakMap,Vo=new WeakMap,qr=new WeakMap,_c=new WeakMap,Nc=new WeakMap,Uo=new WeakMap,ta=new WeakMap,Fc=new WeakMap,Zi=new WeakMap,jo=new WeakMap,Ti=new WeakSet,sm=function(e){var n,i;if(a(this,kc))return;(i=a(this,qn)).ctx??(i.ctx=w(n=he,Es,Jh).call(n,a(this,Qr)));const t=a(this,qr),s=a(this,Oc);for(const r of e){if(t.length>jS){lt("Ignoring additional textDivs for performance reasons."),g(this,kc,!0);return}if(r.str===void 0){if(r.type==="beginMarkedContentProps"||r.type==="beginMarkedContent"){const o=a(this,qe);g(this,qe,document.createElement("span")),a(this,qe).classList.add("markedContent"),r.id&&a(this,qe).setAttribute("id",`${r.id}`),o.append(a(this,qe))}else r.type==="endMarkedContent"&&g(this,qe,a(this,qe).parentNode);continue}s.push(r.str),w(this,Ti,nm).call(this,r)}},nm=function(e){var v;const t=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};a(this,qr).push(t);const n=Z.transform(a(this,Nc),e.transform);let i=Math.atan2(n[1],n[0]);const r=a(this,Ho)[e.fontName];r.vertical&&(i+=Math.PI/2);let o=a(this,Mc)&&r.fontSubstitution||r.fontFamily;o=he.fontFamilyMap.get(o)||o;const l=Math.hypot(n[2],n[3]),c=l*w(v=he,Es,rm).call(v,o,r,a(this,Qr));let d,u;i===0?(d=n[4],u=n[5]-c):(d=n[4]+c*Math.sin(i),u=n[5]-c*Math.cos(i));const f="calc(var(--total-scale-factor) *",p=t.style;a(this,qe)===a(this,Bo)?(p.left=`${(100*d/a(this,Dc)).toFixed(2)}%`,p.top=`${(100*u/a(this,Lc)).toFixed(2)}%`):(p.left=`${f}${d.toFixed(2)}px)`,p.top=`${f}${u.toFixed(2)}px)`),p.fontSize=`${f}${(a(he,Zi)*l).toFixed(2)}px)`,p.fontFamily=o,s.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,a(this,Mc)&&(t.dataset.fontName=r.fontSubstitutionLoadedName||e.fontName),i!==0&&(s.angle=i*(180/Math.PI));let m=!1;if(e.str.length>1)m=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const y=Math.abs(e.transform[0]),A=Math.abs(e.transform[3]);y!==A&&Math.max(y,A)/Math.min(y,A)>1.5&&(m=!0)}if(m&&(s.canvasWidth=r.vertical?e.height:e.width),a(this,_c).set(t,s),a(this,qn).div=t,a(this,qn).properties=s,w(this,Ti,nf).call(this,a(this,qn)),s.hasText&&a(this,qe).append(t),s.hasEOL){const y=document.createElement("br");y.setAttribute("role","presentation"),a(this,qe).append(y)}},nf=function(e){var o;const{div:t,properties:s,ctx:n}=e,{style:i}=t;let r="";if(a(he,Zi)>1&&(r=`scale(${1/a(he,Zi)})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:l}=i,{canvasWidth:c,fontSize:d}=s;w(o=he,Es,rf).call(o,n,d*a(this,Qi),l);const{width:u}=n.measureText(t.textContent);u>0&&(r=`scaleX(${c*a(this,Qi)/u}) ${r}`)}s.angle!==0&&(r=`rotate(${s.angle}deg) ${r}`),r.length>0&&(i.transform=r)},Es=new WeakSet,Jh=function(e=null){let t=a(this,ta).get(e||(e=""));if(!t){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=e,document.body.append(s),t=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),a(this,ta).set(e,t),a(this,Fc).set(t,{size:0,family:""})}return t},rf=function(e,t,s){const n=a(this,Fc).get(e);t===n.size&&s===n.family||(e.font=`${t}px ${s}`,n.size=t,n.family=s)},im=function(){if(a(this,Zi)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),g(this,Zi,e.getBoundingClientRect().height),e.remove()},rm=function(e,t,s){const n=a(this,Uo).get(e);if(n)return n;const i=w(this,Es,Jh).call(this,s);i.canvas.width=i.canvas.height=Bp,w(this,Es,rf).call(this,i,Bp,e);const r=i.measureText(""),o=r.fontBoundingBoxAscent,l=Math.abs(r.fontBoundingBoxDescent);i.canvas.width=i.canvas.height=0;let c=.8;return o?c=o/(o+l):(De.platform.isFirefox&&lt("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?c=t.ascent:t.descent&&(c=1+t.descent)),a(this,Uo).set(e,c),c},b(he,Es),b(he,Uo,new Map),b(he,ta,new Map),b(he,Fc,new WeakMap),b(he,Zi,null),b(he,jo,new Set);let zl=he;class Wl{static textContent(e){const t=[],s={items:t,styles:Object.create(null)};function n(i){var l;if(!i)return;let r=null;const o=i.name;if(o==="#text")r=i.value;else if(Wl.shouldBuildText(o))(l=i==null?void 0:i.attributes)!=null&&l.textContent?r=i.attributes.textContent:i.value&&(r=i.value);else return;if(r!==null&&t.push({str:r}),!!i.children)for(const c of i.children)n(c)}return n(e),s}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const GS=100;function am(h={}){typeof h=="string"||h instanceof URL?h={url:h}:(h instanceof ArrayBuffer||ArrayBuffer.isView(h))&&(h={data:h});const e=new af,{docId:t}=e,s=h.url?Zw(h.url):null,n=h.data?qw(h.data):null,i=h.httpHeaders||null,r=h.withCredentials===!0,o=h.password??null,l=h.range instanceof om?h.range:null,c=Number.isInteger(h.rangeChunkSize)&&h.rangeChunkSize>0?h.rangeChunkSize:2**16;let d=h.worker instanceof Xl?h.worker:null;const u=h.verbosity,f=typeof h.docBaseUrl=="string"&&!ru(h.docBaseUrl)?h.docBaseUrl:null,p=Oh(h.cMapUrl),m=h.cMapPacked!==!1,v=h.CMapReaderFactory||(We?oS:Cp),y=Oh(h.iccUrl),A=Oh(h.standardFontDataUrl),E=h.StandardFontDataFactory||(We?lS:Pp),S=Oh(h.wasmUrl),x=h.WasmFactory||(We?cS:Ip),T=h.stopAtErrors!==!0,C=Number.isInteger(h.maxImageSize)&&h.maxImageSize>-1?h.maxImageSize:-1,P=h.isEvalSupported!==!1,k=typeof h.isOffscreenCanvasSupported=="boolean"?h.isOffscreenCanvasSupported:!We,R=typeof h.isImageDecoderSupported=="boolean"?h.isImageDecoderSupported:!We&&(De.platform.isFirefox||!globalThis.chrome),L=Number.isInteger(h.canvasMaxAreaInBytes)?h.canvasMaxAreaInBytes:-1,D=typeof h.disableFontFace=="boolean"?h.disableFontFace:We,H=h.fontExtraProperties===!0,V=h.enableXfa===!0,G=h.ownerDocument||globalThis.document,q=h.disableRange===!0,j=h.disableStream===!0,F=h.disableAutoFetch===!0,nt=h.pdfBug===!0,ct=h.CanvasFactory||(We?aS:nS),Pt=h.FilterFactory||(We?rS:iS),Kt=h.enableHWA===!0,ut=h.useWasm!==!1,mt=l?l.length:h.length??NaN,Ht=typeof h.useSystemFonts=="boolean"?h.useSystemFonts:!We&&!D,ne=typeof h.useWorkerFetch=="boolean"?h.useWorkerFetch:!!(v===Cp&&E===Pp&&x===Ip&&p&&A&&S&&Tl(p,document.baseURI)&&Tl(A,document.baseURI)&&Tl(S,document.baseURI)),z=null;kw(u);const B={canvasFactory:new ct({ownerDocument:G,enableHWA:Kt}),filterFactory:new Pt({docId:t,ownerDocument:G}),cMapReaderFactory:ne?null:new v({baseUrl:p,isCompressed:m}),standardFontDataFactory:ne?null:new E({baseUrl:A}),wasmFactory:ne?null:new x({baseUrl:S})};d||(d=Xl.create({verbosity:u,port:Tn.workerPort}),e._worker=d);const X={docId:t,apiVersion:"5.4.149",data:n,password:o,disableAutoFetch:F,rangeChunkSize:c,length:mt,docBaseUrl:f,enableXfa:V,evaluatorOptions:{maxImageSize:C,disableFontFace:D,ignoreErrors:T,isEvalSupported:P,isOffscreenCanvasSupported:k,isImageDecoderSupported:R,canvasMaxAreaInBytes:L,fontExtraProperties:H,useSystemFonts:Ht,useWasm:ut,useWorkerFetch:ne,cMapUrl:p,iccUrl:y,standardFontDataUrl:A,wasmUrl:S}},ft={ownerDocument:G,pdfBug:nt,styleElement:z,loadingParams:{disableAutoFetch:F,enableXfa:V}};return d.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const Dt=d.messageHandler.sendWithPromise("GetDocRequest",X,n?[n.buffer]:null);let it;if(l)it=new CS(l,{disableRange:q,disableStream:j});else if(!n){if(!s)throw new Error("getDocument - no `url` parameter provided.");const kt=Tl(s)?kS:We?HS:_S;it=new kt({url:s,length:mt,httpHeaders:i,withCredentials:r,rangeChunkSize:c,disableRange:q,disableStream:j})}return Dt.then(kt=>{if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const jt=new kl(t,kt,d.port),Ts=new XS(jt,e,it,ft,B,Kt);e._transport=Ts,jt.send("Ready",null)})}).catch(e._capability.reject),e}var Bd;const $d=class $d{constructor(){U(this,"_capability",Promise.withResolvers());U(this,"_transport",null);U(this,"_worker",null);U(this,"docId",`d${ce($d,Bd)._++}`);U(this,"destroyed",!1);U(this,"onPassword",null);U(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,s,n;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(i){throw(s=this._worker)!=null&&s.port&&delete this._worker._pendingDestroy,i}this._transport=null,(n=this._worker)==null||n.destroy(),this._worker=null}async getData(){return this._transport.getData()}};Bd=new WeakMap,b($d,Bd,0);let af=$d;var ea,Bc,$c,Hc,Vc;class om{constructor(e,t,s=!1,n=null){b(this,ea,Promise.withResolvers());b(this,Bc,[]);b(this,$c,[]);b(this,Hc,[]);b(this,Vc,[]);this.length=e,this.initialData=t,this.progressiveDone=s,this.contentDispositionFilename=n}addRangeListener(e){a(this,Vc).push(e)}addProgressListener(e){a(this,Hc).push(e)}addProgressiveReadListener(e){a(this,$c).push(e)}addProgressiveDoneListener(e){a(this,Bc).push(e)}onDataRange(e,t){for(const s of a(this,Vc))s(e,t)}onDataProgress(e,t){a(this,ea).promise.then(()=>{for(const s of a(this,Hc))s(e,t)})}onDataProgressiveRead(e){a(this,ea).promise.then(()=>{for(const t of a(this,$c))t(e)})}onDataProgressiveDone(){a(this,ea).promise.then(()=>{for(const e of a(this,Bc))e()})}transportReady(){a(this,ea).resolve()}requestDataRange(e,t){$t("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}ea=new WeakMap,Bc=new WeakMap,$c=new WeakMap,Hc=new WeakMap,Vc=new WeakMap;class zS{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return At(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var ti,sa,_l;class WS{constructor(e,t,s,n=!1){b(this,sa);b(this,ti,!1);this._pageIndex=e,this._pageInfo=t,this._transport=s,this._stats=n?new Ep:null,this._pdfBug=n,this.commonObjs=s.commonObjs,this.objs=new em,this._intentStates=new Map,this.destroyed=!1,this.recordedGroups=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:s=0,offsetY:n=0,dontFlip:i=!1}={}){return new Ph({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:n,dontFlip:i})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return At(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,canvas:t=e.canvas,viewport:s,intent:n="display",annotationMode:i=Pi.ENABLE,transform:r=null,background:o=null,optionalContentConfigPromise:l=null,annotationCanvasMap:c=null,pageColors:d=null,printAnnotationStorage:u=null,isEditing:f=!1,recordOperations:p=!1,filteredOperationIndexes:m=null}){var k,R,L;(k=this._stats)==null||k.time("Overall");const v=this._transport.getRenderingIntent(n,i,u,f),{renderingIntent:y,cacheKey:A}=v;g(this,ti,!1),l||(l=this._transport.getOptionalContentConfig(y));let E=this._intentStates.get(A);E||(E=Object.create(null),this._intentStates.set(A,E)),E.streamReaderCancelTimeout&&(clearTimeout(E.streamReaderCancelTimeout),E.streamReaderCancelTimeout=null);const S=!!(y&As.PRINT);E.displayReadyCapability||(E.displayReadyCapability=Promise.withResolvers(),E.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(R=this._stats)==null||R.time("Page Request"),this._pumpOperatorList(v));const x=!this.recordedGroups&&(p||this._pdfBug&&((L=globalThis.StepperManager)==null?void 0:L.enabled)),T=D=>{var H,V,G;if(E.renderTasks.delete(C),x){const q=(H=C.gfx)==null?void 0:H.dependencyTracker.take();q?((V=C.stepper)==null||V.setOperatorGroups(q),p&&(this.recordedGroups=q)):p&&(this.recordedGroups=[])}S&&g(this,ti,!0),w(this,sa,_l).call(this),D?(C.capability.reject(D),this._abortOperatorList({intentState:E,reason:D instanceof Error?D:new Error(D)})):C.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(G=globalThis.Stats)!=null&&G.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},C=new of({callback:T,params:{canvas:t,canvasContext:e,dependencyTracker:x?new hS(t):null,viewport:s,transform:r,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:c,operatorList:E.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!S,pdfBug:this._pdfBug,pageColors:d,enableHWA:this._transport.enableHWA,filteredOperationIndexes:m});(E.renderTasks||(E.renderTasks=new Set)).add(C);const P=C.task;return Promise.all([E.displayReadyCapability.promise,l]).then(([D,H])=>{var V;if(this.destroyed){T();return}if((V=this._stats)==null||V.time("Rendering"),!(H.renderingIntent&y))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");C.initializeGraphics({transparency:D,optionalContentConfig:H}),C.operatorListChanged()}).catch(T),P}getOperatorList({intent:e="display",annotationMode:t=Pi.ENABLE,printAnnotationStorage:s=null,isEditing:n=!1}={}){var c;function i(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(l))}const r=this._transport.getRenderingIntent(e,t,s,n,!0);let o=this._intentStates.get(r.cacheKey);o||(o=Object.create(null),this._intentStates.set(r.cacheKey,o));let l;return o.opListReadCapability||(l=Object.create(null),l.operatorListChanged=i,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(l),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(c=this._stats)==null||c.time("Page Request"),this._pumpOperatorList(r)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(n){return n.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>Wl.textContent(s));const t=this.streamTextContent(e);return new Promise(function(s,n){function i(){r.read().then(function({value:l,done:c}){if(c){s(o);return}o.lang??(o.lang=l.lang),Object.assign(o.styles,l.styles),o.items.push(...l.items),i()},n)}const r=t.getReader(),o={items:[],styles:Object.create(null),lang:null};i()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const s of t.renderTasks)e.push(s.completed),s.cancel();return this.objs.clear(),g(this,ti,!1),Promise.all(e)}cleanup(e=!1){g(this,ti,!0);const t=w(this,sa,_l).call(this);return e&&t&&this._stats&&(this._stats=new Ep),t}_startRenderPage(e,t){var n,i;const s=this._intentStates.get(t);s&&((n=this._stats)==null||n.timeEnd("Page Request"),(i=s.displayReadyCapability)==null||i.resolve(e))}_renderPageChunk(e,t){for(let s=0,n=e.length;s<n;s++)t.operatorList.fnArray.push(e.fnArray[s]),t.operatorList.argsArray.push(e.argsArray[s]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const s of t.renderTasks)s.operatorListChanged();e.lastChunk&&w(this,sa,_l).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:s,modifiedIds:n}){const{map:i,transfer:r}=s,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:i,modifiedIds:n},r).getReader(),c=this._intentStates.get(t);c.streamReader=l;const d=()=>{l.read().then(({value:u,done:f})=>{if(f){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(u,c),d())},u=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const f of c.renderTasks)f.operatorListChanged();w(this,sa,_l).call(this)}if(c.displayReadyCapability)c.displayReadyCapability.reject(u);else if(c.opListReadCapability)c.opListReadCapability.reject(u);else throw u}})};d()}_abortOperatorList({intentState:e,reason:t,force:s=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!s){if(e.renderTasks.size>0)return;if(t instanceof ep){let n=GS;t.extraDelay>0&&t.extraDelay<1e3&&(n+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},n);return}}if(e.streamReader.cancel(new wr(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[n,i]of this._intentStates)if(i===e){this._intentStates.delete(n);break}this.cleanup()}}}get stats(){return this._stats}}ti=new WeakMap,sa=new WeakSet,_l=function(){if(!a(this,ti)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),g(this,ti,!1),!0};var qi,Gs,ei,na,Hd,ia,ra,Ye,Qh,lm,cm,Nl,Go,Zh;const zt=class zt{constructor({name:e=null,port:t=null,verbosity:s=Mw()}={}){b(this,Ye);b(this,qi,Promise.withResolvers());b(this,Gs,null);b(this,ei,null);b(this,na,null);if(this.name=e,this.destroyed=!1,this.verbosity=s,t){if(a(zt,ra).has(t))throw new Error("Cannot use more than one PDFWorker per port.");a(zt,ra).set(t,this),w(this,Ye,lm).call(this,t)}else w(this,Ye,cm).call(this)}get promise(){return a(this,qi).promise}get port(){return a(this,ei)}get messageHandler(){return a(this,Gs)}destroy(){var e,t;this.destroyed=!0,(e=a(this,na))==null||e.terminate(),g(this,na,null),a(zt,ra).delete(a(this,ei)),g(this,ei,null),(t=a(this,Gs))==null||t.destroy(),g(this,Gs,null)}static create(e){const t=a(this,ra).get(e==null?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new zt(e)}static get workerSrc(){if(Tn.workerSrc)return Tn.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return At(this,"_setupFakeWorkerGlobal",(async()=>a(this,Go,Zh)?a(this,Go,Zh):(await import(this.workerSrc)).WorkerMessageHandler)())}};qi=new WeakMap,Gs=new WeakMap,ei=new WeakMap,na=new WeakMap,Hd=new WeakMap,ia=new WeakMap,ra=new WeakMap,Ye=new WeakSet,Qh=function(){a(this,qi).resolve(),a(this,Gs).send("configure",{verbosity:this.verbosity})},lm=function(e){g(this,ei,e),g(this,Gs,new kl("main","worker",e)),a(this,Gs).on("ready",()=>{}),w(this,Ye,Qh).call(this)},cm=function(){if(a(zt,ia)||a(zt,Go,Zh)){w(this,Ye,Nl).call(this);return}let{workerSrc:e}=zt;try{zt._isSameOrigin(window.location,e)||(e=zt._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),s=new kl("main","worker",t),n=()=>{i.abort(),s.destroy(),t.terminate(),this.destroyed?a(this,qi).reject(new Error("Worker was destroyed")):w(this,Ye,Nl).call(this)},i=new AbortController;t.addEventListener("error",()=>{a(this,na)||n()},{signal:i.signal}),s.on("test",o=>{if(i.abort(),this.destroyed||!o){n();return}g(this,Gs,s),g(this,ei,t),g(this,na,t),w(this,Ye,Qh).call(this)}),s.on("ready",o=>{if(i.abort(),this.destroyed){n();return}try{r()}catch{w(this,Ye,Nl).call(this)}});const r=()=>{const o=new Uint8Array;s.send("test",o,[o.buffer])};r();return}catch{iu("The worker has been disabled.")}w(this,Ye,Nl).call(this)},Nl=function(){a(zt,ia)||(lt("Setting up fake worker."),g(zt,ia,!0)),zt._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){a(this,qi).reject(new Error("Worker was destroyed"));return}const t=new sS;g(this,ei,t);const s=`fake${ce(zt,Hd)._++}`,n=new kl(s+"_worker",s,t);e.setup(n,t),g(this,Gs,new kl(s,s+"_worker",t)),w(this,Ye,Qh).call(this)}).catch(e=>{a(this,qi).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},Go=new WeakSet,Zh=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},b(zt,Go),b(zt,Hd,0),b(zt,ia,!1),b(zt,ra,new WeakMap),We&&(g(zt,ia,!0),Tn.workerSrc||(Tn.workerSrc="./pdf.worker.mjs")),zt._isSameOrigin=(e,t)=>{const s=URL.parse(e);if(!(s!=null&&s.origin)||s.origin==="null")return!1;const n=new URL(t,s);return s.origin===n.origin},zt._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},zt.fromPort=e=>{if(jw("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return zt.create(e)};let Xl=zt;var si,pn,zo,Wo,ni,aa,Fl;class XS{constructor(e,t,s,n,i,r){b(this,aa);b(this,si,new Map);b(this,pn,new Map);b(this,zo,new Map);b(this,Wo,new Map);b(this,ni,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new em,this.fontLoader=new Jw({ownerDocument:n.ownerDocument,styleElement:n.styleElement}),this.loadingParams=n.loadingParams,this._params=n,this.canvasFactory=i.canvasFactory,this.filterFactory=i.filterFactory,this.cMapReaderFactory=i.cMapReaderFactory,this.standardFontDataFactory=i.standardFontDataFactory,this.wasmFactory=i.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=r,this.setupMessageHandler()}get annotationStorage(){return At(this,"annotationStorage",new np)}getRenderingIntent(e,t=Pi.ENABLE,s=null,n=!1,i=!1){let r=As.DISPLAY,o=Wu;switch(e){case"any":r=As.ANY;break;case"display":break;case"print":r=As.PRINT;break;default:lt(`getRenderingIntent - invalid intent: ${e}`)}const l=r&As.PRINT&&s instanceof $g?s:this.annotationStorage;switch(t){case Pi.DISABLE:r+=As.ANNOTATIONS_DISABLE;break;case Pi.ENABLE:break;case Pi.ENABLE_FORMS:r+=As.ANNOTATIONS_FORMS;break;case Pi.ENABLE_STORAGE:r+=As.ANNOTATIONS_STORAGE,o=l.serializable;break;default:lt(`getRenderingIntent - invalid annotationMode: ${t}`)}n&&(r+=As.IS_EDITING),i&&(r+=As.OPLIST);const{ids:c,hash:d}=l.modifiedIds,u=[r,o.hash,d];return{renderingIntent:r,cacheKey:u.join("_"),annotationStorageSerializable:o,modifiedIds:c}}destroy(){var s;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(s=a(this,ni))==null||s.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const n of a(this,pn).values())e.push(n._destroy());a(this,pn).clear(),a(this,zo).clear(),a(this,Wo).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var n,i;this.commonObjs.clear(),this.fontLoader.clear(),a(this,si).clear(),this.filterFactory.destroy(),zl.cleanup(),(n=this._networkStream)==null||n.cancelAllRequests(new wr("Worker was terminated.")),(i=this.messageHandler)==null||i.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(s,n)=>{oe(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=i=>{this._lastProgress={loaded:i.loaded,total:i.total}},n.onPull=()=>{this._fullReader.read().then(function({value:i,done:r}){if(r){n.close();return}oe(i instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(i),1,[i])}).catch(i=>{n.error(i)})},n.onCancel=i=>{this._fullReader.cancel(i),n.ready.catch(r=>{if(!this.destroyed)throw r})}}),e.on("ReaderHeadersReady",async s=>{var o;await this._fullReader.headersReady;const{isStreamingSupported:n,isRangeSupported:i,contentLength:r}=this._fullReader;return(!n||!i)&&(this._lastProgress&&((o=t.onProgress)==null||o.call(t,this._lastProgress)),this._fullReader.onProgress=l=>{var c;(c=t.onProgress)==null||c.call(t,{loaded:l.loaded,total:l.total})}),{isStreamingSupported:n,isRangeSupported:i,contentLength:r}}),e.on("GetRangeReader",(s,n)=>{oe(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const i=this._networkStream.getRangeReader(s.begin,s.end);if(!i){n.close();return}n.onPull=()=>{i.read().then(function({value:r,done:o}){if(o){n.close();return}oe(r instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{n.error(r)})},n.onCancel=r=>{i.cancel(r),n.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,t._capability.resolve(new zS(s,this))}),e.on("DocException",s=>{t._capability.reject(Je(s))}),e.on("PasswordRequest",s=>{g(this,ni,Promise.withResolvers());try{if(!t.onPassword)throw Je(s);const n=i=>{i instanceof Error?a(this,ni).reject(i):a(this,ni).resolve({password:i})};t.onPassword(n,s.code)}catch(n){a(this,ni).reject(n)}return a(this,ni).promise}),e.on("DataLoaded",s=>{var n;(n=t.onProgress)==null||n.call(t,{loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),e.on("StartRenderPage",s=>{if(this.destroyed)return;a(this,pn).get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),e.on("commonobj",([s,n,i])=>{var r;if(this.destroyed||this.commonObjs.has(s))return null;switch(n){case"Font":if("error"in i){const d=i.error;lt(`Error during font loading: ${d}`),this.commonObjs.resolve(s,d);break}const o=this._params.pdfBug&&((r=globalThis.FontInspector)!=null&&r.enabled)?(d,u)=>globalThis.FontInspector.fontAdded(d,u):null,l=new Qw(i,o);this.fontLoader.bind(l).catch(()=>e.sendWithPromise("FontFallback",{id:s})).finally(()=>{!l.fontExtraProperties&&l.data&&(l.data=null),this.commonObjs.resolve(s,l)});break;case"CopyLocalImage":const{imageRef:c}=i;oe(c,"The imageRef must be defined.");for(const d of a(this,pn).values())for(const[,u]of d.objs)if((u==null?void 0:u.ref)===c)return u.dataLen?(this.commonObjs.resolve(s,structuredClone(u)),u.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,i);break;default:throw new Error(`Got unknown common object type ${n}`)}return null}),e.on("obj",([s,n,i,r])=>{var l;if(this.destroyed)return;const o=a(this,pn).get(n);if(!o.objs.has(s)){if(o._intentStates.size===0){(l=r==null?void 0:r.bitmap)==null||l.close();return}switch(i){case"Image":case"Pattern":o.objs.resolve(s,r);break;default:throw new Error(`Got unknown object type ${i}`)}}}),e.on("DocProgress",s=>{var n;this.destroyed||(n=t.onProgress)==null||n.call(t,{loaded:s.loaded,total:s.total})}),e.on("FetchBinaryData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");const n=this[s.type];if(!n)throw new Error(`${s.type} not initialized, see the \`useWorkerFetch\` parameter.`);return n.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var s;this.annotationStorage.size<=0&&lt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((s=this._fullReader)==null?void 0:s.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,s=a(this,zo).get(t);if(s)return s;const n=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(i=>{if(this.destroyed)throw new Error("Transport destroyed");i.refStr&&a(this,Wo).set(i.refStr,e);const r=new WS(t,i,this,this._params.pdfBug);return a(this,pn).set(t,r),r});return a(this,zo).set(t,n),n}getPageIndex(e){return Xu(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return w(this,aa,Fl).call(this,"GetFieldObjects")}hasJSActions(){return w(this,aa,Fl).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return w(this,aa,Fl).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return w(this,aa,Fl).call(this,"GetOptionalContentConfig").then(t=>new xS(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=a(this,si).get(e);if(t)return t;const s=this.messageHandler.sendWithPromise(e,null).then(n=>{var i,r;return{info:n[0],metadata:n[1]?new ES(n[1]):null,contentDispositionFilename:((i=this._fullReader)==null?void 0:i.filename)??null,contentLength:((r=this._fullReader)==null?void 0:r.contentLength)??null}});return a(this,si).set(e,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of a(this,pn).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),a(this,si).clear(),this.filterFactory.destroy(!0),zl.cleanup()}}cachedPageNumber(e){if(!Xu(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return a(this,Wo).get(t)??null}}si=new WeakMap,pn=new WeakMap,zo=new WeakMap,Wo=new WeakMap,ni=new WeakMap,aa=new WeakSet,Fl=function(e,t=null){const s=a(this,si).get(e);if(s)return s;const n=this.messageHandler.sendWithPromise(e,t);return a(this,si).set(e,n),n};var tr;class YS{constructor(e){b(this,tr,null);U(this,"onContinue",null);U(this,"onError",null);g(this,tr,e)}get promise(){return a(this,tr).capability.promise}cancel(e=0){a(this,tr).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=a(this,tr).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=a(this,tr);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}tr=new WeakMap;var er,oa;const Rr=class Rr{constructor({callback:e,params:t,objs:s,commonObjs:n,annotationCanvasMap:i,operatorList:r,pageIndex:o,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:d=!1,pdfBug:u=!1,pageColors:f=null,enableHWA:p=!1,filteredOperationIndexes:m=null}){b(this,er,null);this.callback=e,this.params=t,this.objs=s,this.commonObjs=n,this.annotationCanvasMap=i,this.operatorListIdx=null,this.operatorList=r,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=u,this.pageColors=f,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=d===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new YS(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=p,this._dependencyTracker=t.dependencyTracker,this._filteredOperationIndexes=m}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var l,c;if(this.cancelled)return;if(this._canvas){if(a(Rr,oa).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");a(Rr,oa).add(this._canvas)}this._pdfBug&&((l=globalThis.StepperManager)!=null&&l.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:s,transform:n,background:i,dependencyTracker:r}=this.params,o=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new no(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,r),this.gfx.beginDrawing({transform:n,viewport:s,transparency:e,background:i}),this.operatorListIdx=0,this.graphicsReady=!0,(c=this.graphicsReadyCallback)==null||c.call(this)}cancel(e=null,t=0){var s,n,i;this.running=!1,this.cancelled=!0,(s=this.gfx)==null||s.endDrawing(),a(this,er)&&(window.cancelAnimationFrame(a(this,er)),g(this,er,null)),a(Rr,oa).delete(this._canvas),e||(e=new ep(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(i=(n=this.task).onError)==null||i.call(n,e)}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?g(this,er,window.requestAnimationFrame(()=>{g(this,er,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._filteredOperationIndexes),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),a(Rr,oa).delete(this._canvas),this.callback())))}};er=new WeakMap,oa=new WeakMap,b(Rr,oa,new WeakSet);let of=Rr;const KS="5.4.149",JS="9e2e9e209";var cs,la,Xo,pe,Uc,Yo,ii,jc,sr,zs,Gc,Bt,lf,cf,hf,xr,hm,Ci;const Qe=class Qe{constructor({editor:e=null,uiManager:t=null}){b(this,Bt);b(this,cs,null);b(this,la,null);b(this,Xo);b(this,pe,null);b(this,Uc,!1);b(this,Yo,!1);b(this,ii,null);b(this,jc);b(this,sr,null);b(this,zs,null);var s,n;e?(g(this,Yo,!1),g(this,ii,e)):g(this,Yo,!0),g(this,zs,(e==null?void 0:e._uiManager)||t),g(this,jc,a(this,zs)._eventBus),g(this,Xo,((s=e==null?void 0:e.color)==null?void 0:s.toUpperCase())||((n=a(this,zs))==null?void 0:n.highlightColors.values().next().value)||"#FFFF98"),a(Qe,Gc)||g(Qe,Gc,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return At(this,"_keyboardManager",new Ih([[["Escape","mac+Escape"],Qe.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Qe.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Qe.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Qe.prototype._moveToPrevious],[["Home","mac+Home"],Qe.prototype._moveToBeginning],[["End","mac+End"],Qe.prototype._moveToEnd]]))}renderButton(){const e=g(this,cs,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",a(this,ii)&&(e.ariaControls=`${a(this,ii).id}_colorpicker_dropdown`);const t=a(this,zs)._signal;e.addEventListener("click",w(this,Bt,xr).bind(this),{signal:t}),e.addEventListener("keydown",w(this,Bt,hf).bind(this),{signal:t});const s=g(this,la,document.createElement("span"));return s.className="swatch",s.ariaHidden="true",s.style.backgroundColor=a(this,Xo),e.append(s),e}renderMainDropdown(){const e=g(this,pe,w(this,Bt,lf).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===a(this,cs)){w(this,Bt,xr).call(this,e);return}const t=e.target.getAttribute("data-color");t&&w(this,Bt,cf).call(this,t,e)}_moveToNext(e){var t,s;if(!a(this,Bt,Ci)){w(this,Bt,xr).call(this,e);return}if(e.target===a(this,cs)){(t=a(this,pe).firstChild)==null||t.focus();return}(s=e.target.nextSibling)==null||s.focus()}_moveToPrevious(e){var t,s;if(e.target===((t=a(this,pe))==null?void 0:t.firstChild)||e.target===a(this,cs)){a(this,Bt,Ci)&&this._hideDropdownFromKeyboard();return}a(this,Bt,Ci)||w(this,Bt,xr).call(this,e),(s=e.target.previousSibling)==null||s.focus()}_moveToBeginning(e){var t;if(!a(this,Bt,Ci)){w(this,Bt,xr).call(this,e);return}(t=a(this,pe).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!a(this,Bt,Ci)){w(this,Bt,xr).call(this,e);return}(t=a(this,pe).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=a(this,pe))==null||e.classList.add("hidden"),a(this,cs).ariaExpanded="false",(t=a(this,sr))==null||t.abort(),g(this,sr,null)}_hideDropdownFromKeyboard(){var e;if(!a(this,Yo)){if(!a(this,Bt,Ci)){(e=a(this,ii))==null||e.unselect();return}this.hideDropdown(),a(this,cs).focus({preventScroll:!0,focusVisible:a(this,Uc)})}}updateColor(e){if(a(this,la)&&(a(this,la).style.backgroundColor=e),!a(this,pe))return;const t=a(this,zs).highlightColors.values();for(const s of a(this,pe).children)s.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;(e=a(this,cs))==null||e.remove(),g(this,cs,null),g(this,la,null),(t=a(this,pe))==null||t.remove(),g(this,pe,null)}};cs=new WeakMap,la=new WeakMap,Xo=new WeakMap,pe=new WeakMap,Uc=new WeakMap,Yo=new WeakMap,ii=new WeakMap,jc=new WeakMap,sr=new WeakMap,zs=new WeakMap,Gc=new WeakMap,Bt=new WeakSet,lf=function(){const e=document.createElement("div"),t=a(this,zs)._signal;e.addEventListener("contextmenu",$s,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),a(this,ii)&&(e.id=`${a(this,ii).id}_colorpicker_dropdown`);for(const[s,n]of a(this,zs).highlightColors){const i=document.createElement("button");i.tabIndex="0",i.role="option",i.setAttribute("data-color",n),i.title=s,i.setAttribute("data-l10n-id",a(Qe,Gc)[s]);const r=document.createElement("span");i.append(r),r.className="swatch",r.style.backgroundColor=n,i.ariaSelected=n===a(this,Xo),i.addEventListener("click",w(this,Bt,cf).bind(this,n),{signal:t}),e.append(i)}return e.addEventListener("keydown",w(this,Bt,hf).bind(this),{signal:t}),e},cf=function(e,t){t.stopPropagation(),a(this,jc).dispatch("switchannotationeditorparams",{source:this,type:Et.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)},hf=function(e){Qe._keyboardManager.exec(this,e)},xr=function(e){if(a(this,Bt,Ci)){this.hideDropdown();return}if(g(this,Uc,e.detail===0),a(this,sr)||(g(this,sr,new AbortController),window.addEventListener("pointerdown",w(this,Bt,hm).bind(this),{signal:a(this,zs).combinedSignal(a(this,sr))})),a(this,cs).ariaExpanded="true",a(this,pe)){a(this,pe).classList.remove("hidden");return}const t=g(this,pe,w(this,Bt,lf).call(this));a(this,cs).append(t)},hm=function(e){var t;(t=a(this,pe))!=null&&t.contains(e.target)||this.hideDropdown()},Ci=function(){return a(this,pe)&&!a(this,pe).classList.contains("hidden")},b(Qe,Gc,null);let Ed=Qe;var gn,zc,Ko,Wc;const kr=class kr{constructor(e){b(this,gn,null);b(this,zc,null);b(this,Ko,null);g(this,zc,e),g(this,Ko,e._uiManager),a(kr,Wc)||g(kr,Wc,Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(a(this,gn))return a(this,gn);const{editorType:e,colorType:t,colorValue:s}=a(this,zc),n=g(this,gn,document.createElement("input"));return n.type="color",n.value=s||"#000000",n.className="basicColorPicker",n.tabIndex=0,n.setAttribute("data-l10n-id",a(kr,Wc)[e]),n.addEventListener("input",()=>{a(this,Ko).updateParams(t,n.value)},{signal:a(this,Ko)._signal}),n}update(e){a(this,gn)&&(a(this,gn).value=e)}destroy(){var e;(e=a(this,gn))==null||e.remove(),g(this,gn,null)}hideDropdown(){}};gn=new WeakMap,zc=new WeakMap,Ko=new WeakMap,Wc=new WeakMap,b(kr,Wc,null);let Td=kr;gt(116);gt(531);function $p(h){return Math.floor(Math.max(0,Math.min(1,h))*255).toString(16).padStart(2,"0")}function Sl(h){return Math.max(0,Math.min(255,255*h))}class Hp{static CMYK_G([e,t,s,n]){return["G",1-Math.min(1,.3*e+.59*s+.11*t+n)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Sl(e),[e,e,e]}static G_HTML([e]){const t=$p(e);return`#${t}${t}${t}`}static RGB_G([e,t,s]){return["G",.3*e+.59*t+.11*s]}static RGB_rgb(e){return e.map(Sl)}static RGB_HTML(e){return`#${e.map($p).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,s,n]){return["RGB",1-Math.min(1,e+n),1-Math.min(1,s+n),1-Math.min(1,t+n)]}static CMYK_rgb([e,t,s,n]){return[Sl(1-Math.min(1,e+n)),Sl(1-Math.min(1,s+n)),Sl(1-Math.min(1,t+n))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,s]){const n=1-e,i=1-t,r=1-s,o=Math.min(n,i,r);return["CMYK",n,i,r,o]}}class QS{create(e,t,s=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const n=this._createSVG("svg:svg");return n.setAttribute("version","1.1"),s||(n.setAttribute("width",`${e}px`),n.setAttribute("height",`${t}px`)),n.setAttribute("preserveAspectRatio","none"),n.setAttribute("viewBox",`0 0 ${e} ${t}`),n}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){$t("Abstract method `_createSVG` called.")}}class xd extends QS{_createSVG(e){return document.createElementNS(kn,e)}}class dm{static setupStorage(e,t,s,n,i){const r=n.getValue(t,{value:null});switch(s.name){case"textarea":if(r.value!==null&&(e.textContent=r.value),i==="print")break;e.addEventListener("input",o=>{n.setValue(t,{value:o.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(r.value===s.attributes.xfaOn?e.setAttribute("checked",!0):r.value===s.attributes.xfaOff&&e.removeAttribute("checked"),i==="print")break;e.addEventListener("change",o=>{n.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(r.value!==null&&e.setAttribute("value",r.value),i==="print")break;e.addEventListener("input",o=>{n.setValue(t,{value:o.target.value})})}break;case"select":if(r.value!==null){e.setAttribute("value",r.value);for(const o of s.children)o.attributes.value===r.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{const l=o.target.options,c=l.selectedIndex===-1?"":l[l.selectedIndex].value;n.setValue(t,{value:c})});break}}static setAttributes({html:e,element:t,storage:s=null,intent:n,linkService:i}){const{attributes:r}=t,o=e instanceof HTMLAnchorElement;r.type==="radio"&&(r.name=`${r.name}-${n}`);for(const[l,c]of Object.entries(r))if(c!=null)switch(l){case"class":c.length&&e.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",c);break;case"style":Object.assign(e.style,c);break;case"textContent":e.textContent=c;break;default:(!o||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,c)}o&&i.addLinkAttributes(e,r.href,r.newWindow),s&&r.dataId&&this.setupStorage(e,r.dataId,t,s)}static render(e){var u,f;const t=e.annotationStorage,s=e.linkService,n=e.xfaHtml,i=e.intent||"display",r=document.createElement(n.name);n.attributes&&this.setAttributes({html:r,element:n,intent:i,linkService:s});const o=i!=="richText",l=e.div;if(l.append(r),e.viewport){const p=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=p}o&&l.setAttribute("class","xfaLayer xfaFont");const c=[];if(n.children.length===0){if(n.value){const p=document.createTextNode(n.value);r.append(p),o&&Wl.shouldBuildText(n.name)&&c.push(p)}return{textDivs:c}}const d=[[n,-1,r]];for(;d.length>0;){const[p,m,v]=d.at(-1);if(m+1===p.children.length){d.pop();continue}const y=p.children[++d.at(-1)[1]];if(y===null)continue;const{name:A}=y;if(A==="#text"){const S=document.createTextNode(y.value);c.push(S),v.append(S);continue}const E=(u=y==null?void 0:y.attributes)!=null&&u.xmlns?document.createElementNS(y.attributes.xmlns,A):document.createElement(A);if(v.append(E),y.attributes&&this.setAttributes({html:E,element:y,storage:t,intent:i,linkService:s}),((f=y.children)==null?void 0:f.length)>0)d.push([y,-1,E]);else if(y.value){const S=document.createTextNode(y.value);o&&Wl.shouldBuildText(A)&&c.push(S),E.append(S)}}for(const p of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))p.setAttribute("readOnly",!0);return{textDivs:c}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const ZS=9,$a=new WeakSet,qS=new Date().getTimezoneOffset()*60*1e3;class Vp{static create(e){switch(e.data.annotationType){case re.LINK:return new ap(e);case re.TEXT:return new tE(e);case re.WIDGET:switch(e.data.fieldType){case"Tx":return new eE(e);case"Btn":return e.data.radioButton?new gm(e):e.data.checkBox?new nE(e):new iE(e);case"Ch":return new rE(e);case"Sig":return new sE(e)}return new ja(e);case re.POPUP:return new uf(e);case re.FREETEXT:return new Sm(e);case re.LINE:return new oE(e);case re.SQUARE:return new lE(e);case re.CIRCLE:return new cE(e);case re.POLYLINE:return new Em(e);case re.CARET:return new dE(e);case re.INK:return new op(e);case re.POLYGON:return new hE(e);case re.HIGHLIGHT:return new Tm(e);case re.UNDERLINE:return new uE(e);case re.SQUIGGLY:return new fE(e);case re.STRIKEOUT:return new pE(e);case re.STAMP:return new xm(e);case re.FILEATTACHMENT:return new gE(e);default:return new se(e)}}}var ca,Jo,ri,Ha,um,df;const pp=class pp{constructor(e,{isRenderable:t=!1,ignoreBorder:s=!1,createQuadrilaterals:n=!1}={}){b(this,Ha);b(this,ca,null);b(this,Jo,!1);b(this,ri,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(s)),n&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e!=null&&e.str||t!=null&&t.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return pp._hasPopupData(this.data)}get hasCommentButton(){return this.enableComment&&this._isEditable&&this.hasPopupElement}get commentButtonPosition(){const{quadPoints:e,rect:t}=this.data;let s=-1/0,n=-1/0;if((e==null?void 0:e.length)>=8){for(let i=0;i<e.length;i+=8)e[i+1]>n?(n=e[i+1],s=e[i+2]):e[i+1]===n&&(s=Math.max(s,e[i+2]));return[s,n]}return t?[t[2],t[3]]:null}get commentButtonColor(){if(!this.data.color)return null;const[e,t,s]=this.data.color,i=255*(1-(this.data.opacity??1));return w(this,Ha,um).call(this,Math.min(e+i,255),Math.min(t+i,255),Math.min(s+i,255))}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:s,pageHeight:n,pageX:i,pageY:r}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-i)/s,e[1]=100*(e[1]-r)/n,e}updateEdited(e){var i;if(!this.container)return;e.rect&&(a(this,ca)||g(this,ca,{rect:this.data.rect.slice(0)}));const{rect:t,popup:s}=e;t&&w(this,Ha,df).call(this,t);let n=((i=a(this,ri))==null?void 0:i.popup)||this.popup;!n&&(s!=null&&s.text)&&(this._createPopup(s),n=a(this,ri).popup),n&&(n.updateEdited(e),s!=null&&s.deleted&&(n.remove(),g(this,ri,null),this.popup=null))}resetEdited(){var e;a(this,ca)&&(w(this,Ha,df).call(this,a(this,ca).rect),(e=a(this,ri))==null||e.popup.resetEdited(),g(this,ca,null))}_createContainer(e){const{data:t,parent:{page:s,viewport:n}}=this,i=document.createElement("section");i.setAttribute("data-annotation-id",t.id),!(this instanceof ja)&&!(this instanceof ap)&&(i.tabIndex=0);const{style:r}=i;if(r.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(i.title=t.alternativeText),t.noRotate&&i.classList.add("norotate"),!t.rect||this instanceof uf){const{rotation:v}=t;return!t.hasOwnCanvas&&v!==0&&this.setRotation(v,i),i}const{width:o,height:l}=this;if(!e&&t.borderStyle.width>0){r.borderWidth=`${t.borderStyle.width}px`;const v=t.borderStyle.horizontalCornerRadius,y=t.borderStyle.verticalCornerRadius;if(v>0||y>0){const E=`calc(${v}px * var(--total-scale-factor)) / calc(${y}px * var(--total-scale-factor))`;r.borderRadius=E}else if(this instanceof gm){const E=`calc(${o}px * var(--total-scale-factor)) / calc(${l}px * var(--total-scale-factor))`;r.borderRadius=E}switch(t.borderStyle.style){case Wa.SOLID:r.borderStyle="solid";break;case Wa.DASHED:r.borderStyle="dashed";break;case Wa.BEVELED:lt("Unimplemented border style: beveled");break;case Wa.INSET:lt("Unimplemented border style: inset");break;case Wa.UNDERLINE:r.borderBottomStyle="solid";break}const A=t.borderColor||null;A?(g(this,Jo,!0),r.borderColor=Z.makeHexColor(A[0]|0,A[1]|0,A[2]|0)):r.borderWidth=0}const c=Z.normalizeRect([t.rect[0],s.view[3]-t.rect[1]+s.view[1],t.rect[2],s.view[3]-t.rect[3]+s.view[1]]),{pageWidth:d,pageHeight:u,pageX:f,pageY:p}=n.rawDims;r.left=`${100*(c[0]-f)/d}%`,r.top=`${100*(c[1]-p)/u}%`;const{rotation:m}=t;return t.hasOwnCanvas||m===0?(r.width=`${100*o/d}%`,r.height=`${100*l/u}%`):this.setRotation(m,i),i}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:n}=this.parent.viewport.rawDims;let{width:i,height:r}=this;e%180!==0&&([i,r]=[r,i]),t.style.width=`${100*i/s}%`,t.style.height=`${100*r/n}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,s,n)=>{const i=n.detail[t],r=i[0],o=i.slice(1);n.target.style[s]=Hp[`${r}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[s]:Hp[`${r}_rgb`](o)})};return At(this,"_commonActions",{display:t=>{const{display:s}=t.detail,n=s%2===1;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:n,noPrint:s===1||s===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:s}=t.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const s=t.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(e,t){const s=this._commonActions;for(const n of Object.keys(t.detail)){const i=e[n]||s[n];i==null||i(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const s=this._commonActions;for(const[n,i]of Object.entries(t)){const r=s[n];if(r){const o={detail:{[n]:i},target:e};r(o),delete t[n]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,s,n,i]=this.data.rect.map(v=>Math.fround(v));if(e.length===8){const[v,y,A,E]=e.subarray(2,6);if(n===v&&i===y&&t===A&&s===E)return}const{style:r}=this.container;let o;if(a(this,Jo)){const{borderColor:v,borderWidth:y}=r;r.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${v}" stroke-width="${y}">`],this.container.classList.add("hasBorder")}const l=n-t,c=i-s,{svgFactory:d}=this,u=d.createElement("svg");u.classList.add("quadrilateralsContainer"),u.setAttribute("width",0),u.setAttribute("height",0),u.role="none";const f=d.createElement("defs");u.append(f);const p=d.createElement("clipPath"),m=`clippath_${this.data.id}`;p.setAttribute("id",m),p.setAttribute("clipPathUnits","objectBoundingBox"),f.append(p);for(let v=2,y=e.length;v<y;v+=8){const A=e[v],E=e[v+1],S=e[v+2],x=e[v+3],T=d.createElement("rect"),C=(S-t)/l,P=(i-E)/c,k=(A-S)/l,R=(E-x)/c;T.setAttribute("x",C),T.setAttribute("y",P),T.setAttribute("width",k),T.setAttribute("height",R),p.append(T),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${C}" y="${P}" width="${k}" height="${R}"/>`)}a(this,Jo)&&(o.push("</g></svg>')"),r.backgroundImage=o.join("")),this.container.append(u),this.container.style.clipPath=`url(#${m})`}_createPopup(e=null){const{data:t}=this;let s,n;e?(s={str:e.text},n=e.date):(s=t.contentsObj,n=t.modificationDate);const i=g(this,ri,new uf({data:{color:t.color,titleObj:t.titleObj,modificationDate:n,contentsObj:s,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}));this.parent.div.append(i.render())}get hasPopupElement(){return!!(a(this,ri)||this.popup||this.data.popupRef)}render(){$t("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const s=[];if(this._fieldObjects){const n=this._fieldObjects[e];if(n)for(const{page:i,id:r,exportValues:o}of n){if(i===-1||r===t)continue;const l=typeof o=="string"?o:null,c=document.querySelector(`[data-element-id="${r}"]`);if(c&&!$a.has(c)){lt(`_getElementsByName - element not allowed: ${r}`);continue}s.push({id:r,exportValue:l,domElement:c})}return s}for(const n of document.getElementsByName(e)){const{exportValue:i}=n,r=n.getAttribute("data-element-id");r!==t&&$a.has(n)&&s.push({id:r,exportValue:i,domElement:n})}return s}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var s;(s=this.linkService.eventBus)==null||s.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};ca=new WeakMap,Jo=new WeakMap,ri=new WeakMap,Ha=new WeakSet,um=function(e,t,s){e/=255,t/=255,s/=255;const n=Math.max(e,t,s),i=Math.min(e,t,s),r=(n+i)/2,o=((1+Math.sqrt(r))/2*100).toFixed(2);if(n===i)return`hsl(0, 0%, ${o}%)`;const l=n-i;let c;n===e?c=(t-s)/l+(t<s?6:0):n===t?c=(s-e)/l+2:c=(e-t)/l+4,c=(c*60).toFixed(2);const d=(l/(1-Math.abs(2*r-1))*100).toFixed(2);return`hsl(${c}, ${d}%, ${o}%)`},df=function(e){const{container:{style:t},data:{rect:s,rotation:n},parent:{viewport:{rawDims:{pageWidth:i,pageHeight:r,pageX:o,pageY:l}}}}=this;s==null||s.splice(0,4,...e),t.left=`${100*(e[0]-o)/i}%`,t.top=`${100*(r-e[3]+l)/r}%`,n===0?(t.width=`${100*(e[2]-e[0])/i}%`,t.height=`${100*(e[3]-e[1])/r}%`):this.setRotation(n)};let se=pp;var Ss,Cr,fm,pm;class ap extends se{constructor(t,s=null){super(t,{isRenderable:!0,ignoreBorder:!!(s!=null&&s.ignoreBorder),createQuadrilaterals:!0});b(this,Ss);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:s}=this,n=document.createElement("a");n.setAttribute("data-element-id",t.id);let i=!1;return t.url?(s.addLinkAttributes(n,t.url,t.newWindow),i=!0):t.action?(this._bindNamedAction(n,t.action,t.overlaidText),i=!0):t.attachment?(w(this,Ss,fm).call(this,n,t.attachment,t.overlaidText,t.attachmentDest),i=!0):t.setOCGState?(w(this,Ss,pm).call(this,n,t.setOCGState,t.overlaidText),i=!0):t.dest?(this._bindLink(n,t.dest,t.overlaidText),i=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,t),i=!0),t.resetForm?(this._bindResetFormAction(n,t.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(n,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&this.container.append(n),this.container}_bindLink(t,s,n=""){t.href=this.linkService.getDestinationHash(s),t.onclick=()=>(s&&this.linkService.goToDestination(s),!1),(s||s==="")&&w(this,Ss,Cr).call(this),n&&(t.title=n)}_bindNamedAction(t,s,n=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(s),!1),n&&(t.title=n),w(this,Ss,Cr).call(this)}_bindJSAction(t,s){t.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(s.actions)){const r=n.get(i);r&&(t[r]=()=>{var o;return(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s.id,name:i}}),!1})}s.overlaidText&&(t.title=s.overlaidText),t.onclick||(t.onclick=()=>!1),w(this,Ss,Cr).call(this)}_bindResetFormAction(t,s){const n=t.onclick;if(n||(t.href=this.linkService.getAnchorUrl("")),w(this,Ss,Cr).call(this),!this._fieldObjects){lt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(t.onclick=()=>!1);return}t.onclick=()=>{var u;n==null||n();const{fields:i,refs:r,include:o}=s,l=[];if(i.length!==0||r.length!==0){const f=new Set(r);for(const p of i){const m=this._fieldObjects[p]||[];for(const{id:v}of m)f.add(v)}for(const p of Object.values(this._fieldObjects))for(const m of p)f.has(m.id)===o&&l.push(m)}else for(const f of Object.values(this._fieldObjects))l.push(...f);const c=this.annotationStorage,d=[];for(const f of l){const{id:p}=f;switch(d.push(p),f.type){case"text":{const v=f.defaultValue||"";c.setValue(p,{value:v});break}case"checkbox":case"radiobutton":{const v=f.defaultValue===f.exportValues;c.setValue(p,{value:v});break}case"combobox":case"listbox":{const v=f.defaultValue||"";c.setValue(p,{value:v});break}default:continue}const m=document.querySelector(`[data-element-id="${p}"]`);if(m){if(!$a.has(m)){lt(`_bindResetFormAction - element not allowed: ${p}`);continue}}else continue;m.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((u=this.linkService.eventBus)==null||u.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}})),!1}}}Ss=new WeakSet,Cr=function(){this.container.setAttribute("data-internal-link","")},fm=function(t,s,n="",i=null){t.href=this.linkService.getAnchorUrl(""),s.description?t.title=s.description:n&&(t.title=n),t.onclick=()=>{var r;return(r=this.downloadManager)==null||r.openOrDownloadData(s.content,s.filename,i),!1},w(this,Ss,Cr).call(this)},pm=function(t,s,n=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(s),!1),n&&(t.title=n),w(this,Ss,Cr).call(this)};class tE extends se{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class ja extends se{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return De.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,s,n,i){s.includes("mouse")?e.addEventListener(s,r=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:i(r),shift:r.shiftKey,modifier:this._getKeyModifier(r)}})}):e.addEventListener(s,r=>{var o;if(s==="blur"){if(!t.focused||!r.relatedTarget)return;t.focused=!1}else if(s==="focus"){if(t.focused)return;t.focused=!0}i&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:i(r)}}))})}_setEventListeners(e,t,s,n){var i,r,o;for(const[l,c]of s)(c==="Action"||(i=this.data.actions)!=null&&i[c])&&((c==="Focus"||c==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,l,c,n),c==="Focus"&&!((r=this.data.actions)!=null&&r.Blur)?this._setEventListener(e,t,"blur","Blur",null):c==="Blur"&&!((o=this.data.actions)!=null&&o.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":Z.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,n=this.data.defaultAppearanceData.fontSize||ZS,i=e.style;let r;const o=2,l=c=>Math.round(10*c)/10;if(this.data.multiLine){const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o),d=Math.round(c/(uu*n))||1,u=c/d;r=Math.min(n,l(u/uu))}else{const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o);r=Math.min(n,l(c/uu))}i.fontSize=`calc(${r}px * var(--total-scale-factor))`,i.color=Z.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(i.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class eE extends ja{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,s,n){const i=this.annotationStorage;for(const r of this._getElementsByName(e.name,e.id))r.domElement&&(r.domElement[t]=s),i.setValue(r.id,{[n]:s})}render(){var n,i;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const r=e.getValue(t,{value:this.data.fieldValue});let o=r.value||"";const l=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let c=r.formattedValue||((n=this.data.textContent)==null?void 0:n.join(`
`))||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const d={userValue:o,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=c??o,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type=this.data.password?"password":"text",s.setAttribute("value",c??o),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),$a.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=0;const{datetimeFormat:u,datetimeType:f,timeStep:p}=this.data,m=!!f&&this.enableScripting;u&&(s.title=u),this._setRequired(s,this.data.required),l&&(s.maxLength=l),s.addEventListener("input",y=>{e.setValue(t,{value:y.target.value}),this.setPropertyOnSiblings(s,"value",y.target.value,"value"),d.formattedValue=null}),s.addEventListener("resetform",y=>{const A=this.data.defaultFieldValue??"";s.value=d.userValue=A,d.formattedValue=null});let v=y=>{const{formattedValue:A}=d;A!=null&&(y.target.value=A),y.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",A=>{var S;if(d.focused)return;const{target:E}=A;if(m&&(E.type=f,p&&(E.step=p)),d.userValue){const x=d.userValue;if(m)if(f==="time"){const T=new Date(x),C=[T.getHours(),T.getMinutes(),T.getSeconds()];E.value=C.map(P=>P.toString().padStart(2,"0")).join(":")}else E.value=new Date(x-qS).toISOString().split(f==="date"?"T":".",1)[0];else E.value=x}d.lastCommittedValue=E.value,d.commitKey=1,(S=this.data.actions)!=null&&S.Focus||(d.focused=!0)}),s.addEventListener("updatefromsandbox",A=>{this.showElementAndHideCanvas(A.target);const E={value(S){d.userValue=S.detail.value??"",m||e.setValue(t,{value:d.userValue.toString()}),S.target.value=d.userValue},formattedValue(S){const{formattedValue:x}=S.detail;d.formattedValue=x,x!=null&&S.target!==document.activeElement&&(S.target.value=x);const T={formattedValue:x};m&&(T.value=x),e.setValue(t,T)},selRange(S){S.target.setSelectionRange(...S.detail.selRange)},charLimit:S=>{var P;const{charLimit:x}=S.detail,{target:T}=S;if(x===0){T.removeAttribute("maxLength");return}T.setAttribute("maxLength",x);let C=d.userValue;!C||C.length<=x||(C=C.slice(0,x),T.value=d.userValue=C,e.setValue(t,{value:C}),(P=this.linkService.eventBus)==null||P.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:C,willCommit:!0,commitKey:1,selStart:T.selectionStart,selEnd:T.selectionEnd}}))}};this._dispatchEventFromSandbox(E,A)}),s.addEventListener("keydown",A=>{var x;d.commitKey=1;let E=-1;if(A.key==="Escape"?E=0:A.key==="Enter"&&!this.data.multiLine?E=2:A.key==="Tab"&&(d.commitKey=3),E===-1)return;const{value:S}=A.target;d.lastCommittedValue!==S&&(d.lastCommittedValue=S,d.userValue=S,(x=this.linkService.eventBus)==null||x.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:S,willCommit:!0,commitKey:E,selStart:A.target.selectionStart,selEnd:A.target.selectionEnd}}))});const y=v;v=null,s.addEventListener("blur",A=>{var x,T;if(!d.focused||!A.relatedTarget)return;(x=this.data.actions)!=null&&x.Blur||(d.focused=!1);const{target:E}=A;let{value:S}=E;if(m){if(S&&f==="time"){const C=S.split(":").map(P=>parseInt(P,10));S=new Date(2e3,0,1,C[0],C[1],C[2]||0).valueOf(),E.step=""}else S=new Date(S).valueOf();E.type="text"}d.userValue=S,d.lastCommittedValue!==S&&((T=this.linkService.eventBus)==null||T.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:S,willCommit:!0,commitKey:d.commitKey,selStart:A.target.selectionStart,selEnd:A.target.selectionEnd}})),y(A)}),(i=this.data.actions)!=null&&i.Keystroke&&s.addEventListener("beforeinput",A=>{var R;d.lastCommittedValue=null;const{data:E,target:S}=A,{value:x,selectionStart:T,selectionEnd:C}=S;let P=T,k=C;switch(A.inputType){case"deleteWordBackward":{const L=x.substring(0,T).match(/\w*[^\w]*$/);L&&(P-=L[0].length);break}case"deleteWordForward":{const L=x.substring(T).match(/^[^\w]*\w*/);L&&(k+=L[0].length);break}case"deleteContentBackward":T===C&&(P-=1);break;case"deleteContentForward":T===C&&(k+=1);break}A.preventDefault(),(R=this.linkService.eventBus)==null||R.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:x,change:E||"",willCommit:!1,selStart:P,selEnd:k}})}),this._setEventListeners(s,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],A=>A.target.value)}if(v&&s.addEventListener("blur",v),this.data.comb){const A=(this.data.rect[2]-this.data.rect[0])/l;s.classList.add("comb"),s.style.letterSpacing=`calc(${A}px * var(--total-scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class sE extends ja{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class nE extends ja{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,s=t.id;let n=e.getValue(s,{value:t.exportValue===t.fieldValue}).value;typeof n=="string"&&(n=n!=="Off",e.setValue(s,{value:n})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const i=document.createElement("input");return $a.add(i),i.setAttribute("data-element-id",s),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="checkbox",i.name=t.fieldName,n&&i.setAttribute("checked",!0),i.setAttribute("exportValue",t.exportValue),i.tabIndex=0,i.addEventListener("change",r=>{const{name:o,checked:l}=r.target;for(const c of this._getElementsByName(o,s)){const d=l&&c.exportValue===t.exportValue;c.domElement&&(c.domElement.checked=d),e.setValue(c.id,{value:d})}e.setValue(s,{value:l})}),i.addEventListener("resetform",r=>{const o=t.defaultFieldValue||"Off";r.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(i.addEventListener("updatefromsandbox",r=>{const o={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(s,{value:l.target.checked})}};this._dispatchEventFromSandbox(o,r)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],r=>r.target.checked)),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class gm extends ja{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,s=t.id;let n=e.getValue(s,{value:t.fieldValue===t.buttonValue}).value;if(typeof n=="string"&&(n=n!==t.buttonValue,e.setValue(s,{value:n})),n)for(const r of this._getElementsByName(t.fieldName,s))e.setValue(r.id,{value:!1});const i=document.createElement("input");if($a.add(i),i.setAttribute("data-element-id",s),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="radio",i.name=t.fieldName,n&&i.setAttribute("checked",!0),i.tabIndex=0,i.addEventListener("change",r=>{const{name:o,checked:l}=r.target;for(const c of this._getElementsByName(o,s))e.setValue(c.id,{value:!1});e.setValue(s,{value:l})}),i.addEventListener("resetform",r=>{const o=t.defaultFieldValue;r.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){const r=t.buttonValue;i.addEventListener("updatefromsandbox",o=>{const l={value:c=>{const d=r===c.detail.value;for(const u of this._getElementsByName(c.target.name)){const f=d&&u.id===s;u.domElement&&(u.domElement.checked=f),e.setValue(u.id,{value:f})}}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class iE extends ap{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),e}}class rE extends ja{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,s=e.getValue(t,{value:this.data.fieldValue}),n=document.createElement("select");$a.add(n),n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,this._setRequired(n,this.data.required),n.name=this.data.fieldName,n.tabIndex=0;let i=this.data.combo&&this.data.options.length>0;this.data.combo||(n.size=this.data.options.length,this.data.multiSelect&&(n.multiple=!0)),n.addEventListener("resetform",d=>{const u=this.data.defaultFieldValue;for(const f of n.options)f.selected=f.value===u});for(const d of this.data.options){const u=document.createElement("option");u.textContent=d.displayValue,u.value=d.exportValue,s.value.includes(d.exportValue)&&(u.setAttribute("selected",!0),i=!1),n.append(u)}let r=null;if(i){const d=document.createElement("option");d.value=" ",d.setAttribute("hidden",!0),d.setAttribute("selected",!0),n.prepend(d),r=()=>{d.remove(),n.removeEventListener("input",r),r=null},n.addEventListener("input",r)}const o=d=>{const u=d?"value":"textContent",{options:f,multiple:p}=n;return p?Array.prototype.filter.call(f,m=>m.selected).map(m=>m[u]):f.selectedIndex===-1?null:f[f.selectedIndex][u]};let l=o(!1);const c=d=>{const u=d.target.options;return Array.prototype.map.call(u,f=>({displayValue:f.textContent,exportValue:f.value}))};return this.enableScripting&&this.hasJSActions?(n.addEventListener("updatefromsandbox",d=>{const u={value(f){r==null||r();const p=f.detail.value,m=new Set(Array.isArray(p)?p:[p]);for(const v of n.options)v.selected=m.has(v.value);e.setValue(t,{value:o(!0)}),l=o(!1)},multipleSelection(f){n.multiple=!0},remove(f){const p=n.options,m=f.detail.remove;p[m].selected=!1,n.remove(m),p.length>0&&Array.prototype.findIndex.call(p,y=>y.selected)===-1&&(p[0].selected=!0),e.setValue(t,{value:o(!0),items:c(f)}),l=o(!1)},clear(f){for(;n.length!==0;)n.remove(0);e.setValue(t,{value:null,items:[]}),l=o(!1)},insert(f){const{index:p,displayValue:m,exportValue:v}=f.detail.insert,y=n.children[p],A=document.createElement("option");A.textContent=m,A.value=v,y?y.before(A):n.append(A),e.setValue(t,{value:o(!0),items:c(f)}),l=o(!1)},items(f){const{items:p}=f.detail;for(;n.length!==0;)n.remove(0);for(const m of p){const{displayValue:v,exportValue:y}=m,A=document.createElement("option");A.textContent=v,A.value=y,n.append(A)}n.options.length>0&&(n.options[0].selected=!0),e.setValue(t,{value:o(!0),items:c(f)}),l=o(!1)},indices(f){const p=new Set(f.detail.indices);for(const m of f.target.options)m.selected=p.has(m.index);e.setValue(t,{value:o(!0)}),l=o(!1)},editable(f){f.target.disabled=!f.detail.editable}};this._dispatchEventFromSandbox(u,d)}),n.addEventListener("input",d=>{var p;const u=o(!0),f=o(!1);e.setValue(t,{value:u}),d.preventDefault(),(p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:f,changeEx:u,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(n,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],d=>d.target.value)):n.addEventListener("input",function(d){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class uf extends se{constructor(e){const{data:t,elements:s}=e;super(e,{isRenderable:se._hasPopupData(t)}),this.elements=s,this.popup=null}render(){const{container:e}=this;e.classList.add("popupAnnotation"),e.role="comment";const t=this.popup=new aE({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,eventBus:this.linkService.eventBus}),s=[];for(const n of this.elements)n.popup=t,n.container.ariaHasPopup="dialog",s.push(n.data.id),n.addHighlightArea();return this.container.setAttribute("aria-controls",s.map(n=>`${tp}${n}`).join(",")),this.container}}var ha,Vd,Ud,da,Qo,qt,ai,nr,oi,Xc,Yc,Zo,mn,hs,li,ci,Kc,ir,qo,Jc,hi,tl,ua,rr,St,qh,mm,vm,td,ff,ym,bm,Am,wm,ed,sd,pf;class aE{constructor({container:e,color:t,elements:s,titleObj:n,modificationDate:i,contentsObj:r,richText:o,parent:l,rect:c,parentRect:d,open:u,eventBus:f=null}){b(this,St);b(this,ha,w(this,St,Am).bind(this));b(this,Vd,w(this,St,pf).bind(this));b(this,Ud,w(this,St,sd).bind(this));b(this,da,w(this,St,ed).bind(this));b(this,Qo,null);b(this,qt,null);b(this,ai,null);b(this,nr,null);b(this,oi,null);b(this,Xc,null);b(this,Yc,null);b(this,Zo,null);b(this,mn,!1);b(this,hs,null);b(this,li,null);b(this,ci,null);b(this,Kc,null);b(this,ir,null);b(this,qo,null);b(this,Jc,null);b(this,hi,null);b(this,tl,null);b(this,ua,null);b(this,rr,!1);g(this,qt,e),g(this,tl,n),g(this,ai,r),g(this,hi,o),g(this,Yc,l),g(this,Qo,t),g(this,Jc,c),g(this,Zo,d),g(this,oi,s),g(this,Xc,f),g(this,nr,bd.toDateObject(i)),this.trigger=s.flatMap(p=>p.getElementsToTriggerPopup()),w(this,St,qh).call(this),a(this,qt).hidden=!0,u&&w(this,St,ed).call(this)}render(){var n;if(a(this,hs))return;const e=g(this,hs,document.createElement("div"));if(e.className="popup",a(this,Qo)){const i=e.style.outlineColor=Z.makeHexColor(...a(this,Qo));e.style.backgroundColor=`color-mix(in srgb, ${i} 30%, white)`}const t=document.createElement("span");if(t.className="header",(n=a(this,tl))!=null&&n.str){const i=document.createElement("span");i.className="title",t.append(i),{dir:i.dir,str:i.textContent}=a(this,tl)}if(e.append(t),a(this,nr)){const i=document.createElement("time");i.className="popupDate",i.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),i.setAttribute("data-l10n-args",JSON.stringify({dateObj:a(this,nr).valueOf()})),i.dateTime=a(this,nr).toISOString(),t.append(i)}const s=a(this,St,td);if(s)dm.render({xfaHtml:s,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const i=this._formatContents(a(this,ai));e.append(i)}a(this,qt).append(e)}_formatContents({str:e,dir:t}){const s=document.createElement("p");s.classList.add("popupContent"),s.dir=t;const n=e.split(/(?:\r\n?|\n)/);for(let i=0,r=n.length;i<r;++i){const o=n[i];s.append(document.createTextNode(o)),i<r-1&&s.append(document.createElement("br"))}return s}updateEdited({rect:e,popup:t,deleted:s}){var n;if(s||t!=null&&t.deleted){this.remove();return}w(this,St,qh).call(this),a(this,ua)||g(this,ua,{contentsObj:a(this,ai),richText:a(this,hi)}),e&&g(this,ci,null),t&&(g(this,hi,w(this,St,bm).call(this,t.text)),g(this,nr,bd.toDateObject(t.date)),g(this,ai,null)),(n=a(this,hs))==null||n.remove(),g(this,hs,null)}resetEdited(){var e;a(this,ua)&&({contentsObj:ce(this,ai)._,richText:ce(this,hi)._}=a(this,ua),g(this,ua,null),(e=a(this,hs))==null||e.remove(),g(this,hs,null),g(this,ci,null))}remove(){var e,t;(e=a(this,li))==null||e.abort(),g(this,li,null),(t=a(this,hs))==null||t.remove(),g(this,hs,null),g(this,rr,!1),g(this,mn,!1);for(const s of this.trigger)s.classList.remove("popupTriggerArea")}forceHide(){g(this,rr,this.isVisible),a(this,rr)&&(a(this,qt).hidden=!0)}maybeShow(){w(this,St,qh).call(this),a(this,rr)&&(a(this,hs)||w(this,St,sd).call(this),g(this,rr,!1),a(this,qt).hidden=!1)}get isVisible(){return a(this,qt).hidden===!1}}ha=new WeakMap,Vd=new WeakMap,Ud=new WeakMap,da=new WeakMap,Qo=new WeakMap,qt=new WeakMap,ai=new WeakMap,nr=new WeakMap,oi=new WeakMap,Xc=new WeakMap,Yc=new WeakMap,Zo=new WeakMap,mn=new WeakMap,hs=new WeakMap,li=new WeakMap,ci=new WeakMap,Kc=new WeakMap,ir=new WeakMap,qo=new WeakMap,Jc=new WeakMap,hi=new WeakMap,tl=new WeakMap,ua=new WeakMap,rr=new WeakMap,St=new WeakSet,qh=function(){var t;if(a(this,li))return;g(this,li,new AbortController);const{signal:e}=a(this,li);for(const s of this.trigger)s.addEventListener("click",a(this,da),{signal:e}),s.addEventListener("mouseenter",a(this,Ud),{signal:e}),s.addEventListener("mouseleave",a(this,Vd),{signal:e}),s.classList.add("popupTriggerArea");for(const s of a(this,oi))(t=s.container)==null||t.addEventListener("keydown",a(this,ha),{signal:e});w(this,St,vm).call(this)},mm=function(){const e=a(this,oi).find(t=>t.hasCommentButton);e&&(g(this,ir,e._normalizePoint(e.commentButtonPosition)),g(this,qo,e.commentButtonColor))},vm=function(){if(a(this,Kc)||(a(this,ir)||w(this,St,mm).call(this),!a(this,ir)))return;const e=g(this,Kc,document.createElement("button"));e.className="annotationCommentButton";const t=a(this,oi)[0].container;e.style.zIndex=t.style.zIndex+1,e.tabIndex=0;const{signal:s}=a(this,li);e.addEventListener("hover",a(this,da),{signal:s}),e.addEventListener("keydown",a(this,ha),{signal:s}),e.addEventListener("click",()=>{var o;const[{data:{id:i},annotationEditorType:r}]=a(this,oi);(o=a(this,Xc))==null||o.dispatch("switchannotationeditormode",{source:this,editId:i,mode:r,editComment:!0})},{signal:s});const{style:n}=e;n.left=`calc(${a(this,ir)[0]}%)`,n.top=`calc(${a(this,ir)[1]}% - var(--comment-button-dim))`,a(this,qo)&&(n.backgroundColor=a(this,qo)),t.after(e)},td=function(){const e=a(this,hi),t=a(this,ai);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&a(this,hi).html||null},ff=function(){var e,t,s;return((s=(t=(e=a(this,St,td))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.fontSize)||0},ym=function(){var e,t,s;return((s=(t=(e=a(this,St,td))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.color)||null},bm=function(e){const t=[],s={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},n={style:{color:a(this,St,ym),fontSize:a(this,St,ff)?`calc(${a(this,St,ff)}px * var(--total-scale-factor))`:""}};for(const i of e.split(`
`))t.push({name:"span",value:i,attributes:n});return s},Am=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&a(this,mn))&&w(this,St,ed).call(this)},wm=function(){if(a(this,ci)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:s,pageX:n,pageY:i}}}=a(this,Yc);let r=!!a(this,Zo),o=r?a(this,Zo):a(this,Jc);for(const m of a(this,oi))if(!o||Z.intersect(m.data.rect,o)!==null){o=m.data.rect,r=!0;break}const l=Z.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),d=r?o[2]-o[0]+5:0,u=l[0]+d,f=l[1];g(this,ci,[100*(u-n)/t,100*(f-i)/s]);const{style:p}=a(this,qt);p.left=`${a(this,ci)[0]}%`,p.top=`${a(this,ci)[1]}%`},ed=function(){g(this,mn,!a(this,mn)),a(this,mn)?(w(this,St,sd).call(this),a(this,qt).addEventListener("click",a(this,da)),a(this,qt).addEventListener("keydown",a(this,ha))):(w(this,St,pf).call(this),a(this,qt).removeEventListener("click",a(this,da)),a(this,qt).removeEventListener("keydown",a(this,ha)))},sd=function(){a(this,hs)||this.render(),this.isVisible?a(this,mn)&&a(this,qt).classList.add("focused"):(w(this,St,wm).call(this),a(this,qt).hidden=!1,a(this,qt).style.zIndex=parseInt(a(this,qt).style.zIndex)+1e3)},pf=function(){a(this,qt).classList.remove("focused"),!(a(this,mn)||!this.isVisible)&&(a(this,qt).hidden=!0,a(this,qt).style.zIndex=parseInt(a(this,qt).style.zIndex)-1e3)};class Sm extends se{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=ht.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const s=document.createElement("span");s.textContent=t,e.append(s)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Qc;class oE extends se{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});b(this,Qc,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:s,height:n}=this,i=this.svgFactory.create(s,n,!0),r=g(this,Qc,this.svgFactory.createElement("svg:line"));return r.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),r.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),r.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),r.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),r.setAttribute("stroke-width",t.borderStyle.width||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),i.append(r),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return a(this,Qc)}addHighlightArea(){this.container.classList.add("highlightArea")}}Qc=new WeakMap;var Zc;class lE extends se{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});b(this,Zc,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:s,height:n}=this,i=this.svgFactory.create(s,n,!0),r=t.borderStyle.width,o=g(this,Zc,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",r/2),o.setAttribute("y",r/2),o.setAttribute("width",s-r),o.setAttribute("height",n-r),o.setAttribute("stroke-width",r||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),i.append(o),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return a(this,Zc)}addHighlightArea(){this.container.classList.add("highlightArea")}}Zc=new WeakMap;var qc;class cE extends se{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});b(this,qc,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:s,height:n}=this,i=this.svgFactory.create(s,n,!0),r=t.borderStyle.width,o=g(this,qc,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",s/2),o.setAttribute("cy",n/2),o.setAttribute("rx",s/2-r/2),o.setAttribute("ry",n/2-r/2),o.setAttribute("stroke-width",r||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),i.append(o),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return a(this,qc)}addHighlightArea(){this.container.classList.add("highlightArea")}}qc=new WeakMap;var th;class Em extends se{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});b(this,th,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:s,borderStyle:n,popupRef:i},width:r,height:o}=this;if(!s)return this.container;const l=this.svgFactory.create(r,o,!0);let c=[];for(let u=0,f=s.length;u<f;u+=2){const p=s[u]-t[0],m=t[3]-s[u+1];c.push(`${p},${m}`)}c=c.join(" ");const d=g(this,th,this.svgFactory.createElement(this.svgElementName));return d.setAttribute("points",c),d.setAttribute("stroke-width",n.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),l.append(d),this.container.append(l),!i&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return a(this,th)}addHighlightArea(){this.container.classList.add("highlightArea")}}th=new WeakMap;class hE extends Em{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class dE extends se{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var eh,fa,sh,gf;class op extends se{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});b(this,sh);b(this,eh,null);b(this,fa,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?ht.HIGHLIGHT:ht.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:s,inkLists:n,borderStyle:i,popupRef:r}}=this,{transform:o,width:l,height:c}=w(this,sh,gf).call(this,s,t),d=this.svgFactory.create(l,c,!0),u=g(this,eh,this.svgFactory.createElement("svg:g"));d.append(u),u.setAttribute("stroke-width",i.width||1),u.setAttribute("stroke-linecap","round"),u.setAttribute("stroke-linejoin","round"),u.setAttribute("stroke-miterlimit",10),u.setAttribute("stroke","transparent"),u.setAttribute("fill","transparent"),u.setAttribute("transform",o);for(let f=0,p=n.length;f<p;f++){const m=this.svgFactory.createElement(this.svgElementName);a(this,fa).push(m),m.setAttribute("points",n[f].join(",")),u.append(m)}return!r&&this.hasPopupData&&this._createPopup(),this.container.append(d),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:s,points:n,rect:i}=t,r=a(this,eh);if(s>=0&&r.setAttribute("stroke-width",s||1),n)for(let o=0,l=a(this,fa).length;o<l;o++)a(this,fa)[o].setAttribute("points",n[o].join(","));if(i){const{transform:o,width:l,height:c}=w(this,sh,gf).call(this,this.data.rotation,i);r.parentElement.setAttribute("viewBox",`0 0 ${l} ${c}`),r.setAttribute("transform",o)}}getElementsToTriggerPopup(){return a(this,fa)}addHighlightArea(){this.container.classList.add("highlightArea")}get commentButtonPosition(){const{inkLists:t,rect:s}=this.data;if((t==null?void 0:t.length)>=1){let n=-1/0,i=-1/0;for(const r of t)for(let o=0,l=r.length;o<l;o+=2)r[o+1]>i?(i=r[o+1],n=r[o]):r[o+1]===i&&(n=Math.max(n,r[o]));if(n!==1/0)return[n,i]}return s?[s[2],s[3]]:null}}eh=new WeakMap,fa=new WeakMap,sh=new WeakSet,gf=function(t,s){switch(t){case 90:return{transform:`rotate(90) translate(${-s[0]},${s[1]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};case 180:return{transform:`rotate(180) translate(${-s[2]},${s[1]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]};case 270:return{transform:`rotate(270) translate(${-s[2]},${s[3]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};default:return{transform:`translate(${-s[0]},${s[3]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]}}};class Tm extends se{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=ht.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const s=document.createElement("mark");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class uE extends se{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),e){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class fE extends se{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),e){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class pE extends se{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),e){const s=document.createElement("s");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class xm extends se{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=ht.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var nh,ih,mf;class gE extends se{constructor(t){var n;super(t,{isRenderable:!0});b(this,ih);b(this,nh,null);const{file:s}=this.data;this.filename=s.filename,this.content=s.content,(n=this.linkService.eventBus)==null||n.dispatch("fileattachmentannotation",{source:this,...s})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:s}=this;let n;s.hasAppearance||s.fillAlpha===0?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(s.name)?"paperclip":"pushpin"}.svg`,s.fillAlpha&&s.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(s.fillAlpha*100)}%);`)),n.addEventListener("dblclick",w(this,ih,mf).bind(this)),g(this,nh,n);const{isMac:i}=De.platform;return t.addEventListener("keydown",r=>{r.key==="Enter"&&(i?r.metaKey:r.ctrlKey)&&w(this,ih,mf).call(this)}),!s.popupRef&&this.hasPopupData?this._createPopup():n.classList.add("popupTriggerArea"),t.append(n),t}getElementsToTriggerPopup(){return a(this,nh)}addHighlightArea(){this.container.classList.add("highlightArea")}}nh=new WeakMap,ih=new WeakSet,mf=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var rh,pa,ar,ah,Tr,yf,bf;const gp=class gp{constructor({div:e,accessibilityManager:t,annotationCanvasMap:s,annotationEditorUIManager:n,page:i,viewport:r,structTreeLayer:o}){b(this,Tr);b(this,rh,null);b(this,pa,null);b(this,ar,new Map);b(this,ah,null);this.div=e,g(this,rh,t),g(this,pa,s),g(this,ah,o||null),this.page=i,this.viewport=r,this.zIndex=0,this._annotationEditorUIManager=n}hasEditableAnnotations(){return a(this,ar).size>0}async render(e){var r;const{annotations:t}=e,s=this.div;Fa(s,this.viewport);const n=new Map,i={data:null,layer:s,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new xd,annotationStorage:e.annotationStorage||new np,enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const o of t){if(o.noHTML)continue;const l=o.annotationType===re.POPUP;if(l){const u=n.get(o.id);if(!u)continue;i.elements=u}else if(o.rect[2]===o.rect[0]||o.rect[3]===o.rect[1])continue;i.data=o;const c=Vp.create(i);if(!c.isRenderable)continue;if(!l&&o.popupRef){const u=n.get(o.popupRef);u?u.push(c):n.set(o.popupRef,[c])}const d=c.render();o.hidden&&(d.style.visibility="hidden"),await w(this,Tr,yf).call(this,d,o.id,i.elements),c._isEditable&&(a(this,ar).set(c.data.id,c),(r=this._annotationEditorUIManager)==null||r.renderAnnotationElement(c))}w(this,Tr,bf).call(this)}async addLinkAnnotations(e,t){const s={data:null,layer:this.div,linkService:t,svgFactory:new xd,parent:this};for(const n of e){n.borderStyle||(n.borderStyle=gp._defaultBorderStyle),s.data=n;const i=Vp.create(s);if(!i.isRenderable)continue;const r=i.render();await w(this,Tr,yf).call(this,r,n.id,null)}}update({viewport:e}){const t=this.div;this.viewport=e,Fa(t,{rotation:e.rotation}),w(this,Tr,bf).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(a(this,ar).values())}getEditableAnnotation(e){return a(this,ar).get(e)}static get _defaultBorderStyle(){return At(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Wa.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};rh=new WeakMap,pa=new WeakMap,ar=new WeakMap,ah=new WeakMap,Tr=new WeakSet,yf=async function(e,t,s){var o,l;const n=e.firstChild||e,i=n.id=`${tp}${t}`,r=await((o=a(this,ah))==null?void 0:o.getAriaAttributes(i));if(r)for(const[c,d]of r)n.setAttribute(c,d);s?s.at(-1).container.after(e):(this.div.append(e),(l=a(this,rh))==null||l.moveElementInDOM(this.div,e,n,!1))},bf=function(){var t;if(!a(this,pa))return;const e=this.div;for(const[s,n]of a(this,pa)){const i=e.querySelector(`[data-annotation-id="${s}"]`);if(!i)continue;n.className="annotationContent";const{firstChild:r}=i;r?r.nodeName==="CANVAS"?r.replaceWith(n):r.classList.contains("annotationContent")?r.after(n):r.before(n):i.append(n);const o=a(this,ar).get(s);o&&(o._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(s,i.id,n),o._hasNoCanvas=!1):o.canvas=n)}a(this,pa).clear()};let vf=gp;const Bh=/\r\n?|\n/g;var Ls,ds,oh,ga,us,le,Cm,Pm,Im,nd,wi,id,rd,Rm,wf,km;const Gt=class Gt extends Vt{constructor(t){super({...t,name:"freeTextEditor"});b(this,le);b(this,Ls);b(this,ds,"");b(this,oh,`${this.id}-editor`);b(this,ga,null);b(this,us);U(this,"_colorPicker",null);g(this,Ls,t.color||Gt._defaultColor||Vt._defaultLineColor),g(this,us,t.fontSize||Gt._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static get _keyboardManager(){const t=Gt.prototype,s=r=>r.isEmpty(),n=Ba.TRANSLATE_SMALL,i=Ba.TRANSLATE_BIG;return At(this,"_keyboardManager",new Ih([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-n,0],checker:s}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:s}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[n,0],checker:s}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[i,0],checker:s}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-n],checker:s}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:s}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,n],checker:s}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,i],checker:s}]]))}static initialize(t,s){Vt.initialize(t,s);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,s){switch(t){case Et.FREETEXT_SIZE:Gt._defaultFontSize=s;break;case Et.FREETEXT_COLOR:Gt._defaultColor=s;break}}updateParams(t,s){switch(t){case Et.FREETEXT_SIZE:w(this,le,Cm).call(this,s);break;case Et.FREETEXT_COLOR:w(this,le,Pm).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[Et.FREETEXT_SIZE,Gt._defaultFontSize],[Et.FREETEXT_COLOR,Gt._defaultColor||Vt._defaultLineColor]]}get propertiesToUpdate(){return[[Et.FREETEXT_SIZE,a(this,us)],[Et.FREETEXT_COLOR,a(this,Ls)]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new Td(this)),[["colorPicker",this._colorPicker]]}get colorType(){return Et.FREETEXT_COLOR}get colorValue(){return a(this,Ls)}_translateEmpty(t,s){this._uiManager.translateSelectedEditors(t,s,!0)}getInitialTranslation(){const t=this.parentScale;return[-Gt._internalPadding*t,-(Gt._internalPadding+a(this,us))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),g(this,ga,new AbortController);const t=this._uiManager.combinedSignal(a(this,ga));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",a(this,oh)),this._isDraggable=!0,(t=a(this,ga))==null||t.abort(),g(this,ga,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var s;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(s=this._initialOptions)!=null&&s.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=a(this,ds),s=g(this,ds,w(this,le,Im).call(this).trimEnd());if(t===s)return;const n=i=>{if(g(this,ds,i),!i){this.remove();return}w(this,le,rd).call(this),this._uiManager.rebuild(this),w(this,le,nd).call(this)};this.addCommands({cmd:()=>{n(s)},undo:()=>{n(t)},mustExec:!1}),w(this,le,nd).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Gt._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,s;(this._isCopy||this.annotationElementId)&&(t=this.x,s=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",a(this,oh)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${a(this,us)}px * var(--total-scale-factor))`,n.color=a(this,Ls),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[i,r]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[l,c]=this.getInitialTranslation();[l,c]=this.pageTranslationToScreen(l,c);const[d,u]=this.pageDimensions,[f,p]=this.pageTranslation;let m,v;switch(this.rotation){case 0:m=t+(o[0]-f)/d,v=s+this.height-(o[1]-p)/u;break;case 90:m=t+(o[0]-f)/d,v=s-(o[1]-p)/u,[l,c]=[c,-l];break;case 180:m=t-this.width+(o[0]-f)/d,v=s-(o[1]-p)/u,[l,c]=[-l,-c];break;case 270:m=t+(o[0]-f-this.height*u)/d,v=s+(o[1]-p-this.width*d)/u,[l,c]=[-c,l];break}this.setAt(m*i,v*r,l,c)}else this._moveAfterPaste(t,s);w(this,le,rd).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var m,v,y;const s=t.clipboardData||window.clipboardData,{types:n}=s;if(n.length===1&&n[0]==="text/plain")return;t.preventDefault();const i=w(m=Gt,wi,wf).call(m,s.getData("text")||"").replaceAll(Bh,`
`);if(!i)return;const r=window.getSelection();if(!r.rangeCount)return;this.editorDiv.normalize(),r.deleteFromDocument();const o=r.getRangeAt(0);if(!i.includes(`
`)){o.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),r.collapseToStart();return}const{startContainer:l,startOffset:c}=o,d=[],u=[];if(l.nodeType===Node.TEXT_NODE){const A=l.parentElement;if(u.push(l.nodeValue.slice(c).replaceAll(Bh,"")),A!==this.editorDiv){let E=d;for(const S of this.editorDiv.childNodes){if(S===A){E=u;continue}E.push(w(v=Gt,wi,id).call(v,S))}}d.push(l.nodeValue.slice(0,c).replaceAll(Bh,""))}else if(l===this.editorDiv){let A=d,E=0;for(const S of this.editorDiv.childNodes)E++===c&&(A=u),A.push(w(y=Gt,wi,id).call(y,S))}g(this,ds,`${d.join(`
`)}${i}${u.join(`
`)}`),w(this,le,rd).call(this);const f=new Range;let p=Math.sumPrecise(d.map(A=>A.length));for(const{firstChild:A}of this.editorDiv.childNodes)if(A.nodeType===Node.TEXT_NODE){const E=A.nodeValue.length;if(p<=E){f.setStart(A,p),f.setEnd(A,p);break}p-=E}r.removeAllRanges(),r.addRange(f)}get contentDiv(){return this.editorDiv}getPDFRect(){const t=Gt._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,s,n){var o;let i=null;if(t instanceof Sm){const{data:{defaultAppearanceData:{fontSize:l,fontColor:c},rect:d,rotation:u,id:f,popupRef:p,contentsObj:m},textContent:v,textPosition:y,parent:{page:{pageNumber:A}}}=t;if(!v||v.length===0)return null;i=t={annotationType:ht.FREETEXT,color:Array.from(c),fontSize:l,value:v.join(`
`),position:y,pageIndex:A-1,rect:d.slice(0),rotation:u,annotationElementId:f,id:f,deleted:!1,popupRef:p,comment:(m==null?void 0:m.str)||null}}const r=await super.deserialize(t,s,n);return g(r,us,t.fontSize),g(r,Ls,Z.makeHexColor(...t.color)),g(r,ds,w(o=Gt,wi,wf).call(o,t.value)),r._initialData=i,t.comment&&r.setCommentData(t.comment),r}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=this.getPDFRect(),n=Vt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:a(this,Ls)),i={annotationType:ht.FREETEXT,color:n,fontSize:a(this,us),value:w(this,le,Rm).call(this),pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(i),t?(i.isCopy=!0,i):this.annotationElementId&&!w(this,le,km).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(t){const s=super.renderAnnotationElement(t);if(!s)return null;const{style:n}=s;n.fontSize=`calc(${a(this,us)}px * var(--total-scale-factor))`,n.color=a(this,Ls),s.replaceChildren();for(const r of a(this,ds).split(`
`)){const o=document.createElement("div");o.append(r?document.createTextNode(r):document.createElement("br")),s.append(o)}const i={rect:this.getPDFRect()};return i.popup=this.hasEditedComment?this.comment:{text:a(this,ds)},t.updateEdited(i),s}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};Ls=new WeakMap,ds=new WeakMap,oh=new WeakMap,ga=new WeakMap,us=new WeakMap,le=new WeakSet,Cm=function(t){const s=i=>{this.editorDiv.style.fontSize=`calc(${i}px * var(--total-scale-factor))`,this.translate(0,-(i-a(this,us))*this.parentScale),g(this,us,i),w(this,le,nd).call(this)},n=a(this,us);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Et.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Pm=function(t){const s=i=>{var r;g(this,Ls,this.editorDiv.style.color=i),(r=this._colorPicker)==null||r.update(i)},n=a(this,Ls);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Et.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Im=function(){var n;const t=[];this.editorDiv.normalize();let s=null;for(const i of this.editorDiv.childNodes)(s==null?void 0:s.nodeType)===Node.TEXT_NODE&&i.nodeName==="BR"||(t.push(w(n=Gt,wi,id).call(n,i)),s=i);return t.join(`
`)},nd=function(){const[t,s]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:i,div:r}=this,o=r.style.display,l=r.classList.contains("hidden");r.classList.remove("hidden"),r.style.display="hidden",i.div.append(this.div),n=r.getBoundingClientRect(),r.remove(),r.style.display=o,r.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=n.width/t,this.height=n.height/s):(this.width=n.height/t,this.height=n.width/s),this.fixAndSetPosition()},wi=new WeakSet,id=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Bh,"")},rd=function(){if(this.editorDiv.replaceChildren(),!!a(this,ds))for(const t of a(this,ds).split(`
`)){const s=document.createElement("div");s.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(s)}},Rm=function(){return a(this,ds).replaceAll(" "," ")},wf=function(t){return t.replaceAll(" "," ")},km=function(t){const{value:s,fontSize:n,color:i,pageIndex:r}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==s||t.fontSize!==n||t.color.some((o,l)=>o!==i[l])||t.pageIndex!==r},b(Gt,wi),U(Gt,"_freeTextDefaultContent",""),U(Gt,"_internalPadding",0),U(Gt,"_defaultColor",null),U(Gt,"_defaultFontSize",10),U(Gt,"_type","freetext"),U(Gt,"_editorType",ht.FREETEXT);let Af=Gt;class J{toSVGPath(){$t("Abstract method `toSVGPath` must be implemented.")}get box(){$t("Abstract getter `box` must be implemented.")}serialize(e,t){$t("Abstract method `serialize` must be implemented.")}static _rescale(e,t,s,n,i,r){r||(r=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)r[o]=t+e[o]*n,r[o+1]=s+e[o+1]*i;return r}static _rescaleAndSwap(e,t,s,n,i,r){r||(r=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)r[o]=t+e[o+1]*n,r[o+1]=s+e[o]*i;return r}static _translate(e,t,s,n){n||(n=new Float32Array(e.length));for(let i=0,r=e.length;i<r;i+=2)n[i]=t+e[i],n[i+1]=s+e[i+1];return n}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,s,n,i){switch(i){case 90:return[1-t/s,e/n];case 180:return[1-e/s,1-t/n];case 270:return[t/s,1-e/n];default:return[e/s,t/n]}}static _normalizePagePoint(e,t,s){switch(s){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,s,n,i,r){return[(e+5*s)/6,(t+5*n)/6,(5*s+i)/6,(5*n+r)/6,(s+i)/2,(n+r)/2]}}U(J,"PRECISION",1e-4);var fs,Ws,el,sl,vn,bt,ma,va,lh,ch,nl,il,or,hh,jd,Gd,ge,Bl,Mm,Lm,Dm,Om,_m,Nm;const On=class On{constructor({x:e,y:t},s,n,i,r,o=0){b(this,ge);b(this,fs);b(this,Ws,[]);b(this,el);b(this,sl);b(this,vn,[]);b(this,bt,new Float32Array(18));b(this,ma);b(this,va);b(this,lh);b(this,ch);b(this,nl);b(this,il);b(this,or,[]);g(this,fs,s),g(this,il,i*n),g(this,sl,r),a(this,bt).set([NaN,NaN,NaN,NaN,e,t],6),g(this,el,o),g(this,ch,a(On,hh)*n),g(this,lh,a(On,Gd)*n),g(this,nl,n),a(this,or).push(e,t)}isEmpty(){return isNaN(a(this,bt)[8])}add({x:e,y:t}){var R;g(this,ma,e),g(this,va,t);const[s,n,i,r]=a(this,fs);let[o,l,c,d]=a(this,bt).subarray(8,12);const u=e-c,f=t-d,p=Math.hypot(u,f);if(p<a(this,lh))return!1;const m=p-a(this,ch),v=m/p,y=v*u,A=v*f;let E=o,S=l;o=c,l=d,c+=y,d+=A,(R=a(this,or))==null||R.push(e,t);const x=-A/m,T=y/m,C=x*a(this,il),P=T*a(this,il);return a(this,bt).set(a(this,bt).subarray(2,8),0),a(this,bt).set([c+C,d+P],4),a(this,bt).set(a(this,bt).subarray(14,18),12),a(this,bt).set([c-C,d-P],16),isNaN(a(this,bt)[6])?(a(this,vn).length===0&&(a(this,bt).set([o+C,l+P],2),a(this,vn).push(NaN,NaN,NaN,NaN,(o+C-s)/i,(l+P-n)/r),a(this,bt).set([o-C,l-P],14),a(this,Ws).push(NaN,NaN,NaN,NaN,(o-C-s)/i,(l-P-n)/r)),a(this,bt).set([E,S,o,l,c,d],6),!this.isEmpty()):(a(this,bt).set([E,S,o,l,c,d],6),Math.abs(Math.atan2(S-l,E-o)-Math.atan2(A,y))<Math.PI/2?([o,l,c,d]=a(this,bt).subarray(2,6),a(this,vn).push(NaN,NaN,NaN,NaN,((o+c)/2-s)/i,((l+d)/2-n)/r),[o,l,E,S]=a(this,bt).subarray(14,18),a(this,Ws).push(NaN,NaN,NaN,NaN,((E+o)/2-s)/i,((S+l)/2-n)/r),!0):([E,S,o,l,c,d]=a(this,bt).subarray(0,6),a(this,vn).push(((E+5*o)/6-s)/i,((S+5*l)/6-n)/r,((5*o+c)/6-s)/i,((5*l+d)/6-n)/r,((o+c)/2-s)/i,((l+d)/2-n)/r),[c,d,o,l,E,S]=a(this,bt).subarray(12,18),a(this,Ws).push(((E+5*o)/6-s)/i,((S+5*l)/6-n)/r,((5*o+c)/6-s)/i,((5*l+d)/6-n)/r,((o+c)/2-s)/i,((l+d)/2-n)/r),!0))}toSVGPath(){if(this.isEmpty())return"";const e=a(this,vn),t=a(this,Ws);if(isNaN(a(this,bt)[6])&&!this.isEmpty())return w(this,ge,Mm).call(this);const s=[];s.push(`M${e[4]} ${e[5]}`);for(let n=6;n<e.length;n+=6)isNaN(e[n])?s.push(`L${e[n+4]} ${e[n+5]}`):s.push(`C${e[n]} ${e[n+1]} ${e[n+2]} ${e[n+3]} ${e[n+4]} ${e[n+5]}`);w(this,ge,Dm).call(this,s);for(let n=t.length-6;n>=6;n-=6)isNaN(t[n])?s.push(`L${t[n+4]} ${t[n+5]}`):s.push(`C${t[n]} ${t[n+1]} ${t[n+2]} ${t[n+3]} ${t[n+4]} ${t[n+5]}`);return w(this,ge,Lm).call(this,s),s.join(" ")}newFreeDrawOutline(e,t,s,n,i,r){return new Fm(e,t,s,n,i,r)}getOutlines(){var u;const e=a(this,vn),t=a(this,Ws),s=a(this,bt),[n,i,r,o]=a(this,fs),l=new Float32Array((((u=a(this,or))==null?void 0:u.length)??0)+2);for(let f=0,p=l.length-2;f<p;f+=2)l[f]=(a(this,or)[f]-n)/r,l[f+1]=(a(this,or)[f+1]-i)/o;if(l[l.length-2]=(a(this,ma)-n)/r,l[l.length-1]=(a(this,va)-i)/o,isNaN(s[6])&&!this.isEmpty())return w(this,ge,Om).call(this,l);const c=new Float32Array(a(this,vn).length+24+a(this,Ws).length);let d=e.length;for(let f=0;f<d;f+=2){if(isNaN(e[f])){c[f]=c[f+1]=NaN;continue}c[f]=e[f],c[f+1]=e[f+1]}d=w(this,ge,Nm).call(this,c,d);for(let f=t.length-6;f>=6;f-=6)for(let p=0;p<6;p+=2){if(isNaN(t[f+p])){c[d]=c[d+1]=NaN,d+=2;continue}c[d]=t[f+p],c[d+1]=t[f+p+1],d+=2}return w(this,ge,_m).call(this,c,d),this.newFreeDrawOutline(c,l,a(this,fs),a(this,nl),a(this,el),a(this,sl))}};fs=new WeakMap,Ws=new WeakMap,el=new WeakMap,sl=new WeakMap,vn=new WeakMap,bt=new WeakMap,ma=new WeakMap,va=new WeakMap,lh=new WeakMap,ch=new WeakMap,nl=new WeakMap,il=new WeakMap,or=new WeakMap,hh=new WeakMap,jd=new WeakMap,Gd=new WeakMap,ge=new WeakSet,Bl=function(){const e=a(this,bt).subarray(4,6),t=a(this,bt).subarray(16,18),[s,n,i,r]=a(this,fs);return[(a(this,ma)+(e[0]-t[0])/2-s)/i,(a(this,va)+(e[1]-t[1])/2-n)/r,(a(this,ma)+(t[0]-e[0])/2-s)/i,(a(this,va)+(t[1]-e[1])/2-n)/r]},Mm=function(){const[e,t,s,n]=a(this,fs),[i,r,o,l]=w(this,ge,Bl).call(this);return`M${(a(this,bt)[2]-e)/s} ${(a(this,bt)[3]-t)/n} L${(a(this,bt)[4]-e)/s} ${(a(this,bt)[5]-t)/n} L${i} ${r} L${o} ${l} L${(a(this,bt)[16]-e)/s} ${(a(this,bt)[17]-t)/n} L${(a(this,bt)[14]-e)/s} ${(a(this,bt)[15]-t)/n} Z`},Lm=function(e){const t=a(this,Ws);e.push(`L${t[4]} ${t[5]} Z`)},Dm=function(e){const[t,s,n,i]=a(this,fs),r=a(this,bt).subarray(4,6),o=a(this,bt).subarray(16,18),[l,c,d,u]=w(this,ge,Bl).call(this);e.push(`L${(r[0]-t)/n} ${(r[1]-s)/i} L${l} ${c} L${d} ${u} L${(o[0]-t)/n} ${(o[1]-s)/i}`)},Om=function(e){const t=a(this,bt),[s,n,i,r]=a(this,fs),[o,l,c,d]=w(this,ge,Bl).call(this),u=new Float32Array(36);return u.set([NaN,NaN,NaN,NaN,(t[2]-s)/i,(t[3]-n)/r,NaN,NaN,NaN,NaN,(t[4]-s)/i,(t[5]-n)/r,NaN,NaN,NaN,NaN,o,l,NaN,NaN,NaN,NaN,c,d,NaN,NaN,NaN,NaN,(t[16]-s)/i,(t[17]-n)/r,NaN,NaN,NaN,NaN,(t[14]-s)/i,(t[15]-n)/r],0),this.newFreeDrawOutline(u,e,a(this,fs),a(this,nl),a(this,el),a(this,sl))},_m=function(e,t){const s=a(this,Ws);return e.set([NaN,NaN,NaN,NaN,s[4],s[5]],t),t+=6},Nm=function(e,t){const s=a(this,bt).subarray(4,6),n=a(this,bt).subarray(16,18),[i,r,o,l]=a(this,fs),[c,d,u,f]=w(this,ge,Bl).call(this);return e.set([NaN,NaN,NaN,NaN,(s[0]-i)/o,(s[1]-r)/l,NaN,NaN,NaN,NaN,c,d,NaN,NaN,NaN,NaN,u,f,NaN,NaN,NaN,NaN,(n[0]-i)/o,(n[1]-r)/l],t),t+=24},b(On,hh,8),b(On,jd,2),b(On,Gd,a(On,hh)+a(On,jd));let Cd=On;var rl,ya,di,dh,ps,uh,ee,zd,Bm;class Fm extends J{constructor(t,s,n,i,r,o){super();b(this,zd);b(this,rl);b(this,ya,new Float32Array(4));b(this,di);b(this,dh);b(this,ps);b(this,uh);b(this,ee);g(this,ee,t),g(this,ps,s),g(this,rl,n),g(this,uh,i),g(this,di,r),g(this,dh,o),this.lastPoint=[NaN,NaN],w(this,zd,Bm).call(this,o);const[l,c,d,u]=a(this,ya);for(let f=0,p=t.length;f<p;f+=2)t[f]=(t[f]-l)/d,t[f+1]=(t[f+1]-c)/u;for(let f=0,p=s.length;f<p;f+=2)s[f]=(s[f]-l)/d,s[f+1]=(s[f+1]-c)/u}toSVGPath(){const t=[`M${a(this,ee)[4]} ${a(this,ee)[5]}`];for(let s=6,n=a(this,ee).length;s<n;s+=6){if(isNaN(a(this,ee)[s])){t.push(`L${a(this,ee)[s+4]} ${a(this,ee)[s+5]}`);continue}t.push(`C${a(this,ee)[s]} ${a(this,ee)[s+1]} ${a(this,ee)[s+2]} ${a(this,ee)[s+3]} ${a(this,ee)[s+4]} ${a(this,ee)[s+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,s,n,i],r){const o=n-t,l=i-s;let c,d;switch(r){case 0:c=J._rescale(a(this,ee),t,i,o,-l),d=J._rescale(a(this,ps),t,i,o,-l);break;case 90:c=J._rescaleAndSwap(a(this,ee),t,s,o,l),d=J._rescaleAndSwap(a(this,ps),t,s,o,l);break;case 180:c=J._rescale(a(this,ee),n,s,-o,l),d=J._rescale(a(this,ps),n,s,-o,l);break;case 270:c=J._rescaleAndSwap(a(this,ee),n,i,-o,-l),d=J._rescaleAndSwap(a(this,ps),n,i,-o,-l);break}return{outline:Array.from(c),points:[Array.from(d)]}}get box(){return a(this,ya)}newOutliner(t,s,n,i,r,o=0){return new Cd(t,s,n,i,r,o)}getNewOutline(t,s){const[n,i,r,o]=a(this,ya),[l,c,d,u]=a(this,rl),f=r*d,p=o*u,m=n*d+l,v=i*u+c,y=this.newOutliner({x:a(this,ps)[0]*f+m,y:a(this,ps)[1]*p+v},a(this,rl),a(this,uh),t,a(this,dh),s??a(this,di));for(let A=2;A<a(this,ps).length;A+=2)y.add({x:a(this,ps)[A]*f+m,y:a(this,ps)[A+1]*p+v});return y.getOutlines()}}rl=new WeakMap,ya=new WeakMap,di=new WeakMap,dh=new WeakMap,ps=new WeakMap,uh=new WeakMap,ee=new WeakMap,zd=new WeakSet,Bm=function(t){const s=a(this,ee);let n=s[4],i=s[5];const r=[n,i,n,i];let o=n,l=i;const c=t?Math.max:Math.min;for(let u=6,f=s.length;u<f;u+=6){const p=s[u+4],m=s[u+5];if(isNaN(s[u]))Z.pointBoundingBox(p,m,r),l<m?(o=p,l=m):l===m&&(o=c(o,p));else{const v=[1/0,1/0,-1/0,-1/0];Z.bezierBoundingBox(n,i,...s.slice(u,u+6),v),Z.rectBoundingBox(...v,r),l<v[3]?(o=v[2],l=v[3]):l===v[3]&&(o=c(o,v[2]))}n=p,i=m}const d=a(this,ya);d[0]=r[0]-a(this,di),d[1]=r[1]-a(this,di),d[2]=r[2]-r[0]+2*a(this,di),d[3]=r[3]-r[1]+2*a(this,di),this.lastPoint=[o,l]};var fh,ph,lr,Xs,Ke,$m,ad,Hm,Vm,Ef;class Sf{constructor(e,t=0,s=0,n=!0){b(this,Ke);b(this,fh);b(this,ph);b(this,lr,[]);b(this,Xs,[]);const i=[1/0,1/0,-1/0,-1/0],r=10**-4;for(const{x:p,y:m,width:v,height:y}of e){const A=Math.floor((p-t)/r)*r,E=Math.ceil((p+v+t)/r)*r,S=Math.floor((m-t)/r)*r,x=Math.ceil((m+y+t)/r)*r,T=[A,S,x,!0],C=[E,S,x,!1];a(this,lr).push(T,C),Z.rectBoundingBox(A,S,E,x,i)}const o=i[2]-i[0]+2*s,l=i[3]-i[1]+2*s,c=i[0]-s,d=i[1]-s,u=a(this,lr).at(n?-1:-2),f=[u[0],u[2]];for(const p of a(this,lr)){const[m,v,y]=p;p[0]=(m-c)/o,p[1]=(v-d)/l,p[2]=(y-d)/l}g(this,fh,new Float32Array([c,d,o,l])),g(this,ph,f)}getOutlines(){a(this,lr).sort((t,s)=>t[0]-s[0]||t[1]-s[1]||t[2]-s[2]);const e=[];for(const t of a(this,lr))t[3]?(e.push(...w(this,Ke,Ef).call(this,t)),w(this,Ke,Hm).call(this,t)):(w(this,Ke,Vm).call(this,t),e.push(...w(this,Ke,Ef).call(this,t)));return w(this,Ke,$m).call(this,e)}}fh=new WeakMap,ph=new WeakMap,lr=new WeakMap,Xs=new WeakMap,Ke=new WeakSet,$m=function(e){const t=[],s=new Set;for(const r of e){const[o,l,c]=r;t.push([o,l,r],[o,c,r])}t.sort((r,o)=>r[1]-o[1]||r[0]-o[0]);for(let r=0,o=t.length;r<o;r+=2){const l=t[r][2],c=t[r+1][2];l.push(c),c.push(l),s.add(l),s.add(c)}const n=[];let i;for(;s.size>0;){const r=s.values().next().value;let[o,l,c,d,u]=r;s.delete(r);let f=o,p=l;for(i=[o,c],n.push(i);;){let m;if(s.has(d))m=d;else if(s.has(u))m=u;else break;s.delete(m),[o,l,c,d,u]=m,f!==o&&(i.push(f,p,o,p===l?l:c),f=o),p=p===l?c:l}i.push(f,p)}return new mE(n,a(this,fh),a(this,ph))},ad=function(e){const t=a(this,Xs);let s=0,n=t.length-1;for(;s<=n;){const i=s+n>>1,r=t[i][0];if(r===e)return i;r<e?s=i+1:n=i-1}return n+1},Hm=function([,e,t]){const s=w(this,Ke,ad).call(this,e);a(this,Xs).splice(s,0,[e,t])},Vm=function([,e,t]){const s=w(this,Ke,ad).call(this,e);for(let n=s;n<a(this,Xs).length;n++){const[i,r]=a(this,Xs)[n];if(i!==e)break;if(i===e&&r===t){a(this,Xs).splice(n,1);return}}for(let n=s-1;n>=0;n--){const[i,r]=a(this,Xs)[n];if(i!==e)break;if(i===e&&r===t){a(this,Xs).splice(n,1);return}}},Ef=function(e){const[t,s,n]=e,i=[[t,s,n]],r=w(this,Ke,ad).call(this,n);for(let o=0;o<r;o++){const[l,c]=a(this,Xs)[o];for(let d=0,u=i.length;d<u;d++){const[,f,p]=i[d];if(!(c<=f||p<=l)){if(f>=l){if(p>c)i[d][1]=c;else{if(u===1)return[];i.splice(d,1),d--,u--}continue}i[d][2]=l,p>c&&i.push([t,c,p])}}}return i};var gh,al;class mE extends J{constructor(t,s,n){super();b(this,gh);b(this,al);g(this,al,t),g(this,gh,s),this.lastPoint=n}toSVGPath(){const t=[];for(const s of a(this,al)){let[n,i]=s;t.push(`M${n} ${i}`);for(let r=2;r<s.length;r+=2){const o=s[r],l=s[r+1];o===n?(t.push(`V${l}`),i=l):l===i&&(t.push(`H${o}`),n=o)}t.push("Z")}return t.join(" ")}serialize([t,s,n,i],r){const o=[],l=n-t,c=i-s;for(const d of a(this,al)){const u=new Array(d.length);for(let f=0;f<d.length;f+=2)u[f]=t+d[f]*l,u[f+1]=i-d[f+1]*c;o.push(u)}return o}get box(){return a(this,gh)}get classNamesForOutlining(){return["highlightOutline"]}}gh=new WeakMap,al=new WeakMap;class Tf extends Cd{newFreeDrawOutline(e,t,s,n,i,r){return new vE(e,t,s,n,i,r)}}class vE extends Fm{newOutliner(e,t,s,n,i,r=0){return new Tf(e,t,s,n,i,r)}}var ol,mh,ui,ba,vh,ts,yh,bh,Aa,Ds,gs,Ie,ll,fi,Fe,cl,Os,Ah,pt,xf,od,Um,jm,Gm,Cf,Pr,Ns,Za,zm,ld,$l,Wm,Xm,Ym,Km,Jm;const It=class It extends Vt{constructor(t){super({...t,name:"highlightEditor"});b(this,pt);b(this,ol,null);b(this,mh,0);b(this,ui);b(this,ba,null);b(this,vh,null);b(this,ts,null);b(this,yh,null);b(this,bh,0);b(this,Aa,null);b(this,Ds,null);b(this,gs,null);b(this,Ie,!1);b(this,ll,null);b(this,fi);b(this,Fe,null);b(this,cl,"");b(this,Os);b(this,Ah,"");this.color=t.color||It._defaultColor,g(this,Os,t.thickness||It._defaultThickness),g(this,fi,t.opacity||It._defaultOpacity),g(this,ui,t.boxes||null),g(this,Ah,t.methodOfCreation||""),g(this,cl,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(g(this,Ie,!0),w(this,pt,od).call(this,t),w(this,pt,Pr).call(this)):a(this,ui)&&(g(this,ol,t.anchorNode),g(this,mh,t.anchorOffset),g(this,yh,t.focusNode),g(this,bh,t.focusOffset),w(this,pt,xf).call(this),w(this,pt,Pr).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const t=It.prototype;return At(this,"_keyboardManager",new Ih([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:a(this,Ie)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:a(this,Os),methodOfCreation:a(this,Ah)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}get commentColor(){return this.color}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,s){var n;Vt.initialize(t,s),It._defaultColor||(It._defaultColor=((n=s.highlightColors)==null?void 0:n.values().next().value)||"#fff066")}static updateDefaultParams(t,s){switch(t){case Et.HIGHLIGHT_COLOR:It._defaultColor=s;break;case Et.HIGHLIGHT_THICKNESS:It._defaultThickness=s;break}}translateInPage(t,s){}get toolbarPosition(){return a(this,ll)}updateParams(t,s){switch(t){case Et.HIGHLIGHT_COLOR:w(this,pt,Um).call(this,s);break;case Et.HIGHLIGHT_THICKNESS:w(this,pt,jm).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[Et.HIGHLIGHT_COLOR,It._defaultColor],[Et.HIGHLIGHT_THICKNESS,It._defaultThickness]]}get propertiesToUpdate(){return[[Et.HIGHLIGHT_COLOR,this.color||It._defaultColor],[Et.HIGHLIGHT_THICKNESS,a(this,Os)||It._defaultThickness],[Et.HIGHLIGHT_FREE,a(this,Ie)]]}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",g(this,vh,new Ed({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(w(this,pt,$l).call(this))}getBaseTranslation(){return[0,0]}getRect(t,s){return super.getRect(t,s,w(this,pt,$l).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){w(this,pt,Cf).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(w(this,pt,Pr).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var n;let s=!1;this.parent&&!t?w(this,pt,Cf).call(this):t&&(w(this,pt,Pr).call(this,t),s=!this.parent&&((n=this.div)==null?void 0:n.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),s&&this.select()}rotate(t){var i,r,o;const{drawLayer:s}=this.parent;let n;a(this,Ie)?(t=(t-this.rotation+360)%360,n=w(i=It,Ns,Za).call(i,a(this,Ds).box,t)):n=w(r=It,Ns,Za).call(r,[this.x,this.y,this.width,this.height],t),s.updateProperties(a(this,gs),{bbox:n,root:{"data-main-rotation":t}}),s.updateProperties(a(this,Fe),{bbox:w(o=It,Ns,Za).call(o,a(this,ts).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();a(this,cl)&&(t.setAttribute("aria-label",a(this,cl)),t.setAttribute("role","mark")),a(this,Ie)?t.classList.add("free"):this.div.addEventListener("keydown",w(this,pt,zm).bind(this),{signal:this._uiManager._signal});const s=g(this,Aa,document.createElement("div"));t.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",s.style.clipPath=a(this,ba);const[n,i]=this.parentDimensions;return this.setDims(this.width*n,this.height*i),fg(this,a(this,Aa),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(a(this,Fe),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(a(this,Fe),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:w(this,pt,ld).call(this,!0);break;case 1:case 3:w(this,pt,ld).call(this,!1);break}}select(){var t;super.select(),a(this,Fe)&&((t=this.parent)==null||t.drawLayer.updateProperties(a(this,Fe),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),a(this,Fe)&&((t=this.parent)==null||t.drawLayer.updateProperties(a(this,Fe),{rootClass:{selected:!1}}),a(this,Ie)||w(this,pt,ld).call(this,!1))}get _mustFixPosition(){return!a(this,Ie)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(a(this,gs),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(a(this,Fe),{rootClass:{hidden:!t}}))}static startHighlighting(t,s,{target:n,x:i,y:r}){const{x:o,y:l,width:c,height:d}=n.getBoundingClientRect(),u=new AbortController,f=t.combinedSignal(u),p=m=>{u.abort(),w(this,Ns,Km).call(this,t,m)};window.addEventListener("blur",p,{signal:f}),window.addEventListener("pointerup",p,{signal:f}),window.addEventListener("pointerdown",ae,{capture:!0,passive:!1,signal:f}),window.addEventListener("contextmenu",$s,{signal:f}),n.addEventListener("pointermove",w(this,Ns,Ym).bind(this,t),{signal:f}),this._freeHighlight=new Tf({x:i,y:r},[o,l,c,d],t.scale,this._defaultThickness/2,s,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,s,n){var v,y,A,E;let i=null;if(t instanceof Tm){const{data:{quadPoints:S,rect:x,rotation:T,id:C,color:P,opacity:k,popupRef:R,contentsObj:L},parent:{page:{pageNumber:D}}}=t;i=t={annotationType:ht.HIGHLIGHT,color:Array.from(P),opacity:k,quadPoints:S,boxes:null,pageIndex:D-1,rect:x.slice(0),rotation:T,annotationElementId:C,id:C,deleted:!1,popupRef:R,comment:(L==null?void 0:L.str)||null}}else if(t instanceof op){const{data:{inkLists:S,rect:x,rotation:T,id:C,color:P,borderStyle:{rawWidth:k},popupRef:R,contentsObj:L},parent:{page:{pageNumber:D}}}=t;i=t={annotationType:ht.HIGHLIGHT,color:Array.from(P),thickness:k,inkLists:S,boxes:null,pageIndex:D-1,rect:x.slice(0),rotation:T,annotationElementId:C,id:C,deleted:!1,popupRef:R,comment:(L==null?void 0:L.str)||null}}const{color:r,quadPoints:o,inkLists:l,opacity:c}=t,d=await super.deserialize(t,s,n);d.color=Z.makeHexColor(...r),g(d,fi,c||1),l&&g(d,Os,t.thickness),d._initialData=i,t.comment&&d.setCommentData(t.comment);const[u,f]=d.pageDimensions,[p,m]=d.pageTranslation;if(o){const S=g(d,ui,[]);for(let x=0;x<o.length;x+=8)S.push({x:(o[x]-p)/u,y:1-(o[x+1]-m)/f,width:(o[x+2]-o[x])/u,height:(o[x+1]-o[x+5])/f});w(v=d,pt,xf).call(v),w(y=d,pt,Pr).call(y),d.rotate(d.rotation)}else if(l){g(d,Ie,!0);const S=l[0],x={x:S[0]-p,y:f-(S[1]-m)},T=new Tf(x,[0,0,u,f],1,a(d,Os)/2,!0,.001);for(let k=0,R=S.length;k<R;k+=2)x.x=S[k]-p,x.y=f-(S[k+1]-m),T.add(x);const{id:C,clipPathId:P}=s.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:d.color,"fill-opacity":d._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:T.toSVGPath()}},!0,!0);w(A=d,pt,od).call(A,{highlightOutlines:T.getOutlines(),highlightId:C,clipPathId:P}),w(E=d,pt,Pr).call(E),d.rotate(d.parentRotation)}return d}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const s=this.getPDFRect(),n=Vt._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),i={annotationType:ht.HIGHLIGHT,color:n,opacity:a(this,fi),thickness:a(this,Os),quadPoints:w(this,pt,Wm).call(this),outlines:w(this,pt,Xm).call(this,s),pageIndex:this.pageIndex,rect:s,rotation:w(this,pt,$l).call(this),structTreeParentId:this._structTreeParentId};return this.addComment(i),this.annotationElementId&&!w(this,pt,Jm).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const s={rect:this.getPDFRect()};return this.hasEditedComment&&(s.popup=this.comment),t.updateEdited(s),null}static canCreateNewEmptyEditor(){return!1}};ol=new WeakMap,mh=new WeakMap,ui=new WeakMap,ba=new WeakMap,vh=new WeakMap,ts=new WeakMap,yh=new WeakMap,bh=new WeakMap,Aa=new WeakMap,Ds=new WeakMap,gs=new WeakMap,Ie=new WeakMap,ll=new WeakMap,fi=new WeakMap,Fe=new WeakMap,cl=new WeakMap,Os=new WeakMap,Ah=new WeakMap,pt=new WeakSet,xf=function(){const t=new Sf(a(this,ui),.001);g(this,Ds,t.getOutlines()),[this.x,this.y,this.width,this.height]=a(this,Ds).box;const s=new Sf(a(this,ui),.0025,.001,this._uiManager.direction==="ltr");g(this,ts,s.getOutlines());const{lastPoint:n}=a(this,ts);g(this,ll,[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height])},od=function({highlightOutlines:t,highlightId:s,clipPathId:n}){var u,f;if(g(this,Ds,t),g(this,ts,t.getNewOutline(a(this,Os)/2+1.5,.0025)),s>=0)g(this,gs,s),g(this,ba,n),this.parent.drawLayer.finalizeDraw(s,{bbox:t.box,path:{d:t.toSVGPath()}}),g(this,Fe,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:a(this,ts).box,path:{d:a(this,ts).toSVGPath()}},!0));else if(this.parent){const p=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(a(this,gs),{bbox:w(u=It,Ns,Za).call(u,a(this,Ds).box,(p-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(a(this,Fe),{bbox:w(f=It,Ns,Za).call(f,a(this,ts).box,p),path:{d:a(this,ts).toSVGPath()}})}const[r,o,l,c]=t.box;switch(this.rotation){case 0:this.x=r,this.y=o,this.width=l,this.height=c;break;case 90:{const[p,m]=this.parentDimensions;this.x=o,this.y=1-r,this.width=l*m/p,this.height=c*p/m;break}case 180:this.x=1-r,this.y=1-o,this.width=l,this.height=c;break;case 270:{const[p,m]=this.parentDimensions;this.x=1-o,this.y=r,this.width=l*m/p,this.height=c*p/m;break}}const{lastPoint:d}=a(this,ts);g(this,ll,[(d[0]-r)/l,(d[1]-o)/c])},Um=function(t){const s=(r,o)=>{var l,c;this.color=r,g(this,fi,o),(l=this.parent)==null||l.drawLayer.updateProperties(a(this,gs),{root:{fill:r,"fill-opacity":o}}),(c=a(this,vh))==null||c.updateColor(r)},n=this.color,i=a(this,fi);this.addCommands({cmd:s.bind(this,t,It._defaultOpacity),undo:s.bind(this,n,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Et.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)},jm=function(t){const s=a(this,Os),n=i=>{g(this,Os,i),w(this,pt,Gm).call(this,i)};this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Et.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},Gm=function(t){if(!a(this,Ie))return;w(this,pt,od).call(this,{highlightOutlines:a(this,Ds).getNewOutline(t/2)}),this.fixAndSetPosition();const[s,n]=this.parentDimensions;this.setDims(this.width*s,this.height*n)},Cf=function(){a(this,gs)===null||!this.parent||(this.parent.drawLayer.remove(a(this,gs)),g(this,gs,null),this.parent.drawLayer.remove(a(this,Fe)),g(this,Fe,null))},Pr=function(t=this.parent){a(this,gs)===null&&({id:ce(this,gs)._,clipPathId:ce(this,ba)._}=t.drawLayer.draw({bbox:a(this,Ds).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":a(this,fi)},rootClass:{highlight:!0,free:a(this,Ie)},path:{d:a(this,Ds).toSVGPath()}},!1,!0),g(this,Fe,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:a(this,Ie)},bbox:a(this,ts).box,path:{d:a(this,ts).toSVGPath()}},a(this,Ie))),a(this,Aa)&&(a(this,Aa).style.clipPath=a(this,ba)))},Ns=new WeakSet,Za=function([t,s,n,i],r){switch(r){case 90:return[1-s-i,t,i,n];case 180:return[1-t-n,1-s-i,n,i];case 270:return[s,1-t-n,i,n]}return[t,s,n,i]},zm=function(t){It._keyboardManager.exec(this,t)},ld=function(t){if(!a(this,ol))return;const s=window.getSelection();t?s.setPosition(a(this,ol),a(this,mh)):s.setPosition(a(this,yh),a(this,bh))},$l=function(){return a(this,Ie)?this.rotation:0},Wm=function(){if(a(this,Ie))return null;const[t,s]=this.pageDimensions,[n,i]=this.pageTranslation,r=a(this,ui),o=new Float32Array(r.length*8);let l=0;for(const{x:c,y:d,width:u,height:f}of r){const p=c*t+n,m=(1-d)*s+i;o[l]=o[l+4]=p,o[l+1]=o[l+3]=m,o[l+2]=o[l+6]=p+u*t,o[l+5]=o[l+7]=m-f*s,l+=8}return o},Xm=function(t){return a(this,Ds).serialize(t,w(this,pt,$l).call(this))},Ym=function(t,s){this._freeHighlight.add(s)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},Km=function(t,s){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(s,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},Jm=function(t){const{color:s}=this._initialData;return this.hasEditedComment||t.color.some((n,i)=>n!==s[i])},b(It,Ns),U(It,"_defaultColor",null),U(It,"_defaultOpacity",1),U(It,"_defaultThickness",12),U(It,"_type","highlight"),U(It,"_editorType",ht.HIGHLIGHT),U(It,"_freeHighlightId",-1),U(It,"_freeHighlight",null),U(It,"_freeHighlightClipId","");let Pd=It;var wa;class Qm{constructor(){b(this,wa,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,s]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,s)}updateSVGProperty(e,t){a(this,wa)[e]=t}toSVGProperties(){const e=a(this,wa);return g(this,wa,Object.create(null)),{root:e}}reset(){g(this,wa,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){$t("Not implemented")}}wa=new WeakMap;var ms,hl,ye,Sa,Ea,cr,hr,dr,Ta,xt,Pf,If,Rf,Hl,Zm,cd,Vl,qa;const Q=class Q extends Vt{constructor(t){super(t);b(this,xt);b(this,ms,null);b(this,hl);U(this,"_colorPicker",null);U(this,"_drawId",null);g(this,hl,t.mustBeCommitted||!1),this._addOutlines(t)}_addOutlines(t){t.drawOutlines&&(w(this,xt,Pf).call(this,t),w(this,xt,Hl).call(this))}static _mergeSVGProperties(t,s){const n=new Set(Object.keys(t));for(const[i,r]of Object.entries(s))n.has(i)?Object.assign(t[i],r):t[i]=r;return t}static getDefaultDrawingOptions(t){$t("Not implemented")}static get typesMap(){$t("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,s){const n=this.typesMap.get(t);n&&this._defaultDrawingOptions.updateProperty(n,s),this._currentParent&&(a(Q,ye).updateProperty(n,s),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,s){const n=this.constructor.typesMap.get(t);n&&this._updateProperty(t,n,s)}static get defaultPropertiesToUpdate(){const t=[],s=this._defaultDrawingOptions;for(const[n,i]of this.typesMap)t.push([n,s[i]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:s}=this;for(const[n,i]of this.constructor.typesMap)t.push([n,s[i]]);return t}_updateProperty(t,s,n){const i=this._drawingOptions,r=i[s],o=l=>{var d,u;i.updateProperty(s,l);const c=a(this,ms).updateProperty(s,l);c&&w(this,xt,Vl).call(this,c),(d=this.parent)==null||d.drawLayer.updateProperties(this._drawId,i.toSVGProperties()),t===this.colorType&&((u=this._colorPicker)==null||u.update(l))};this.addCommands({cmd:o.bind(this,n),undo:o.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Q._mergeSVGProperties(a(this,ms).getPathResizingSVGProperties(w(this,xt,cd).call(this)),{bbox:w(this,xt,qa).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Q._mergeSVGProperties(a(this,ms).getPathResizedSVGProperties(w(this,xt,cd).call(this)),{bbox:w(this,xt,qa).call(this)}))}_onTranslating(t,s){var n;(n=this.parent)==null||n.drawLayer.updateProperties(this._drawId,{bbox:w(this,xt,qa).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Q._mergeSVGProperties(a(this,ms).getPathTranslatedSVGProperties(w(this,xt,cd).call(this),this.parentDimensions),{bbox:w(this,xt,qa).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,a(this,hl)&&(g(this,hl,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){w(this,xt,Rf).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(w(this,xt,Hl).call(this),w(this,xt,Vl).call(this,a(this,ms).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var n;let s=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),w(this,xt,Rf).call(this)):t&&(this._uiManager.addShouldRescale(this),w(this,xt,Hl).call(this,t),s=!this.parent&&((n=this.div)==null?void 0:n.classList.contains("selectedEditor"))),super.setParent(t),s&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Q._mergeSVGProperties({bbox:w(this,xt,qa).call(this)},a(this,ms).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&w(this,xt,Vl).call(this,a(this,ms).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,s;this._isCopy&&(t=this.x,s=this.y);const n=super.render();n.classList.add("draw");const i=document.createElement("div");n.append(i),i.setAttribute("aria-hidden","true"),i.className="internal";const[r,o]=this.parentDimensions;return this.setDims(this.width*r,this.height*o),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,s),n}static createDrawerInstance(t,s,n,i,r){$t("Not implemented")}static startDrawing(t,s,n,i){var y;const{target:r,offsetX:o,offsetY:l,pointerId:c,pointerType:d}=i;if(a(Q,hr)&&a(Q,hr)!==d)return;const{viewport:{rotation:u}}=t,{width:f,height:p}=r.getBoundingClientRect(),m=g(Q,Sa,new AbortController),v=t.combinedSignal(m);if(a(Q,cr)||g(Q,cr,c),a(Q,hr)??g(Q,hr,d),window.addEventListener("pointerup",A=>{var E;a(Q,cr)===A.pointerId?this._endDraw(A):(E=a(Q,dr))==null||E.delete(A.pointerId)},{signal:v}),window.addEventListener("pointercancel",A=>{var E;a(Q,cr)===A.pointerId?this._currentParent.endDrawingSession():(E=a(Q,dr))==null||E.delete(A.pointerId)},{signal:v}),window.addEventListener("pointerdown",A=>{a(Q,hr)===A.pointerType&&((a(Q,dr)||g(Q,dr,new Set)).add(A.pointerId),a(Q,ye).isCancellable()&&(a(Q,ye).removeLastElement(),a(Q,ye).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:v}),window.addEventListener("contextmenu",$s,{signal:v}),r.addEventListener("pointermove",this._drawMove.bind(this),{signal:v}),r.addEventListener("touchmove",A=>{A.timeStamp===a(Q,Ta)&&ae(A)},{signal:v}),t.toggleDrawing(),(y=s._editorUndoBar)==null||y.hide(),a(Q,ye)){t.drawLayer.updateProperties(this._currentDrawId,a(Q,ye).startNew(o,l,f,p,u));return}s.updateUIForDefaultProperties(this),g(Q,ye,this.createDrawerInstance(o,l,f,p,u)),g(Q,Ea,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(a(Q,Ea).toSVGProperties(),a(Q,ye).defaultSVGProperties),!0,!1)}static _drawMove(t){var r;if(g(Q,Ta,-1),!a(Q,ye))return;const{offsetX:s,offsetY:n,pointerId:i}=t;if(a(Q,cr)===i){if(((r=a(Q,dr))==null?void 0:r.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,a(Q,ye).add(s,n)),g(Q,Ta,t.timeStamp),ae(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,g(Q,ye,null),g(Q,Ea,null),g(Q,hr,null),g(Q,Ta,NaN)),a(Q,Sa)&&(a(Q,Sa).abort(),g(Q,Sa,null),g(Q,cr,NaN),g(Q,dr,null))}static _endDraw(t){const s=this._currentParent;if(s){if(s.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===s.div&&s.drawLayer.updateProperties(this._currentDrawId,a(Q,ye).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const n=a(Q,ye),i=this._currentDrawId,r=n.getLastElement();s.addCommands({cmd:()=>{s.drawLayer.updateProperties(i,n.setLastElement(r))},undo:()=>{s.drawLayer.updateProperties(i,n.removeLastElement())},mustExec:!1,type:Et.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const s=this._currentParent;if(!s)return null;if(s.toggleDrawing(!0),s.cleanUndoStack(Et.DRAW_STEP),!a(Q,ye).isEmpty()){const{pageDimensions:[n,i],scale:r}=s,o=s.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:a(Q,ye).getOutlines(n*r,i*r,r,this._INNER_MARGIN),drawingOptions:a(Q,Ea),mustBeCommitted:!t});return this._cleanup(!0),o}return s.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,s,n,i,r,o){$t("Not implemented")}static async deserialize(t,s,n){var u,f;const{rawDims:{pageWidth:i,pageHeight:r,pageX:o,pageY:l}}=s.viewport,c=this.deserializeDraw(o,l,i,r,this._INNER_MARGIN,t),d=await super.deserialize(t,s,n);return d.createDrawingOptions(t),w(u=d,xt,Pf).call(u,{drawOutlines:c}),w(f=d,xt,Hl).call(f),d.onScaleChanging(),d.rotate(),d}serializeDraw(t){const[s,n]=this.pageTranslation,[i,r]=this.pageDimensions;return a(this,ms).serialize([s,n,i,r],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}};ms=new WeakMap,hl=new WeakMap,ye=new WeakMap,Sa=new WeakMap,Ea=new WeakMap,cr=new WeakMap,hr=new WeakMap,dr=new WeakMap,Ta=new WeakMap,xt=new WeakSet,Pf=function({drawOutlines:t,drawId:s,drawingOptions:n}){g(this,ms,t),this._drawingOptions||(this._drawingOptions=n),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),s>=0?(this._drawId=s,this.parent.drawLayer.finalizeDraw(s,t.defaultProperties)):this._drawId=w(this,xt,If).call(this,t,this.parent),w(this,xt,Vl).call(this,t.box)},If=function(t,s){const{id:n}=s.drawLayer.draw(Q._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return n},Rf=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},Hl=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=w(this,xt,If).call(this,a(this,ms),t)}},Zm=function([t,s,n,i]){const{parentDimensions:[r,o],rotation:l}=this;switch(l){case 90:return[s,1-t,n*(o/r),i*(r/o)];case 180:return[1-t,1-s,n,i];case 270:return[1-s,t,n*(o/r),i*(r/o)];default:return[t,s,n,i]}},cd=function(){const{x:t,y:s,width:n,height:i,parentDimensions:[r,o],rotation:l}=this;switch(l){case 90:return[1-s,t,n*(r/o),i*(o/r)];case 180:return[1-t,1-s,n,i];case 270:return[s,1-t,n*(r/o),i*(o/r)];default:return[t,s,n,i]}},Vl=function(t){if([this.x,this.y,this.width,this.height]=w(this,xt,Zm).call(this,t),this.div){this.fixAndSetPosition();const[s,n]=this.parentDimensions;this.setDims(this.width*s,this.height*n)}this._onResized()},qa=function(){const{x:t,y:s,width:n,height:i,rotation:r,parentRotation:o,parentDimensions:[l,c]}=this;switch((r*4+o)/90){case 1:return[1-s-i,t,i,n];case 2:return[1-t-n,1-s-i,n,i];case 3:return[s,1-t-n,i,n];case 4:return[t,s-n*(l/c),i*(c/l),n*(l/c)];case 5:return[1-s,t,n*(l/c),i*(c/l)];case 6:return[1-t-i*(c/l),1-s,i*(c/l),n*(l/c)];case 7:return[s-n*(l/c),1-t-i*(c/l),n*(l/c),i*(c/l)];case 8:return[t-n,s-i,n,i];case 9:return[1-s,t-n,i,n];case 10:return[1-t,1-s,n,i];case 11:return[s-i,1-t,i,n];case 12:return[t-i*(c/l),s,i*(c/l),n*(l/c)];case 13:return[1-s-n*(l/c),t-i*(c/l),n*(l/c),i*(c/l)];case 14:return[1-t,1-s-n*(l/c),i*(c/l),n*(l/c)];case 15:return[s,1-t,n*(l/c),i*(c/l)];default:return[t,s,n,i]}},U(Q,"_currentDrawId",-1),U(Q,"_currentParent",null),b(Q,ye,null),b(Q,Sa,null),b(Q,Ea,null),b(Q,cr,NaN),b(Q,hr,null),b(Q,dr,null),b(Q,Ta,NaN),U(Q,"_INNER_MARGIN",3);let Id=Q;var yn,be,Ae,xa,dl,je,Re,_s,Ca,Pa,Ia,ul,hd;class yE{constructor(e,t,s,n,i,r){b(this,ul);b(this,yn,new Float64Array(6));b(this,be);b(this,Ae);b(this,xa);b(this,dl);b(this,je);b(this,Re,"");b(this,_s,0);b(this,Ca,new kh);b(this,Pa);b(this,Ia);g(this,Pa,s),g(this,Ia,n),g(this,xa,i),g(this,dl,r),[e,t]=w(this,ul,hd).call(this,e,t);const o=g(this,be,[NaN,NaN,NaN,NaN,e,t]);g(this,je,[e,t]),g(this,Ae,[{line:o,points:a(this,je)}]),a(this,yn).set(o,0)}updateProperty(e,t){e==="stroke-width"&&g(this,dl,t)}isEmpty(){return!a(this,Ae)||a(this,Ae).length===0}isCancellable(){return a(this,je).length<=10}add(e,t){[e,t]=w(this,ul,hd).call(this,e,t);const[s,n,i,r]=a(this,yn).subarray(2,6),o=e-i,l=t-r;return Math.hypot(a(this,Pa)*o,a(this,Ia)*l)<=2?null:(a(this,je).push(e,t),isNaN(s)?(a(this,yn).set([i,r,e,t],2),a(this,be).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(a(this,yn)[0])&&a(this,be).splice(6,6),a(this,yn).set([s,n,i,r,e,t],0),a(this,be).push(...J.createBezierPoints(s,n,i,r,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const s=this.add(e,t);return s||(a(this,je).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,s,n,i){g(this,Pa,s),g(this,Ia,n),g(this,xa,i),[e,t]=w(this,ul,hd).call(this,e,t);const r=g(this,be,[NaN,NaN,NaN,NaN,e,t]);g(this,je,[e,t]);const o=a(this,Ae).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),a(this,Ae).push({line:r,points:a(this,je)}),a(this,yn).set(r,0),g(this,_s,0),this.toSVGPath(),null}getLastElement(){return a(this,Ae).at(-1)}setLastElement(e){return a(this,Ae)?(a(this,Ae).push(e),g(this,be,e.line),g(this,je,e.points),g(this,_s,0),{path:{d:this.toSVGPath()}}):a(this,Ca).setLastElement(e)}removeLastElement(){if(!a(this,Ae))return a(this,Ca).removeLastElement();a(this,Ae).pop(),g(this,Re,"");for(let e=0,t=a(this,Ae).length;e<t;e++){const{line:s,points:n}=a(this,Ae)[e];g(this,be,s),g(this,je,n),g(this,_s,0),this.toSVGPath()}return{path:{d:a(this,Re)}}}toSVGPath(){const e=J.svgRound(a(this,be)[4]),t=J.svgRound(a(this,be)[5]);if(a(this,je).length===2)return g(this,Re,`${a(this,Re)} M ${e} ${t} Z`),a(this,Re);if(a(this,je).length<=6){const n=a(this,Re).lastIndexOf("M");g(this,Re,`${a(this,Re).slice(0,n)} M ${e} ${t}`),g(this,_s,6)}if(a(this,je).length===4){const n=J.svgRound(a(this,be)[10]),i=J.svgRound(a(this,be)[11]);return g(this,Re,`${a(this,Re)} L ${n} ${i}`),g(this,_s,12),a(this,Re)}const s=[];a(this,_s)===0&&(s.push(`M ${e} ${t}`),g(this,_s,6));for(let n=a(this,_s),i=a(this,be).length;n<i;n+=6){const[r,o,l,c,d,u]=a(this,be).slice(n,n+6).map(J.svgRound);s.push(`C${r} ${o} ${l} ${c} ${d} ${u}`)}return g(this,Re,a(this,Re)+s.join(" ")),g(this,_s,a(this,be).length),a(this,Re)}getOutlines(e,t,s,n){const i=a(this,Ae).at(-1);return i.line=new Float32Array(i.line),i.points=new Float32Array(i.points),a(this,Ca).build(a(this,Ae),e,t,s,a(this,xa),a(this,dl),n),g(this,yn,null),g(this,be,null),g(this,Ae,null),g(this,Re,null),a(this,Ca)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}yn=new WeakMap,be=new WeakMap,Ae=new WeakMap,xa=new WeakMap,dl=new WeakMap,je=new WeakMap,Re=new WeakMap,_s=new WeakMap,Ca=new WeakMap,Pa=new WeakMap,Ia=new WeakMap,ul=new WeakSet,hd=function(e,t){return J._normalizePoint(e,t,a(this,Pa),a(this,Ia),a(this,xa))};var Ge,wh,Sh,vs,bn,An,fl,pl,Ra,Me,Ln,qm,tv,ev;class kh extends J{constructor(){super(...arguments);b(this,Me);b(this,Ge);b(this,wh,0);b(this,Sh);b(this,vs);b(this,bn);b(this,An);b(this,fl);b(this,pl);b(this,Ra)}build(t,s,n,i,r,o,l){g(this,bn,s),g(this,An,n),g(this,fl,i),g(this,pl,r),g(this,Ra,o),g(this,Sh,l??0),g(this,vs,t),w(this,Me,tv).call(this)}get thickness(){return a(this,Ra)}setLastElement(t){return a(this,vs).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return a(this,vs).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:s}of a(this,vs)){if(t.push(`M${J.svgRound(s[4])} ${J.svgRound(s[5])}`),s.length===6){t.push("Z");continue}if(s.length===12&&isNaN(s[6])){t.push(`L${J.svgRound(s[10])} ${J.svgRound(s[11])}`);continue}for(let n=6,i=s.length;n<i;n+=6){const[r,o,l,c,d,u]=s.subarray(n,n+6).map(J.svgRound);t.push(`C${r} ${o} ${l} ${c} ${d} ${u}`)}}return t.join("")}serialize([t,s,n,i],r){const o=[],l=[],[c,d,u,f]=w(this,Me,qm).call(this);let p,m,v,y,A,E,S,x,T;switch(a(this,pl)){case 0:T=J._rescale,p=t,m=s+i,v=n,y=-i,A=t+c*n,E=s+(1-d-f)*i,S=t+(c+u)*n,x=s+(1-d)*i;break;case 90:T=J._rescaleAndSwap,p=t,m=s,v=n,y=i,A=t+d*n,E=s+c*i,S=t+(d+f)*n,x=s+(c+u)*i;break;case 180:T=J._rescale,p=t+n,m=s,v=-n,y=i,A=t+(1-c-u)*n,E=s+d*i,S=t+(1-c)*n,x=s+(d+f)*i;break;case 270:T=J._rescaleAndSwap,p=t+n,m=s+i,v=-n,y=-i,A=t+(1-d-f)*n,E=s+(1-c-u)*i,S=t+(1-d)*n,x=s+(1-c)*i;break}for(const{line:C,points:P}of a(this,vs))o.push(T(C,p,m,v,y,r?new Array(C.length):null)),l.push(T(P,p,m,v,y,r?new Array(P.length):null));return{lines:o,points:l,rect:[A,E,S,x]}}static deserialize(t,s,n,i,r,{paths:{lines:o,points:l},rotation:c,thickness:d}){const u=[];let f,p,m,v,y;switch(c){case 0:y=J._rescale,f=-t/n,p=s/i+1,m=1/n,v=-1/i;break;case 90:y=J._rescaleAndSwap,f=-s/i,p=-t/n,m=1/i,v=1/n;break;case 180:y=J._rescale,f=t/n+1,p=-s/i,m=-1/n,v=1/i;break;case 270:y=J._rescaleAndSwap,f=s/i+1,p=t/n+1,m=-1/i,v=-1/n;break}if(!o){o=[];for(const E of l){const S=E.length;if(S===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1]]));continue}if(S===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1],NaN,NaN,NaN,NaN,E[2],E[3]]));continue}const x=new Float32Array(3*(S-2));o.push(x);let[T,C,P,k]=E.subarray(0,4);x.set([NaN,NaN,NaN,NaN,T,C],0);for(let R=4;R<S;R+=2){const L=E[R],D=E[R+1];x.set(J.createBezierPoints(T,C,P,k,L,D),(R-2)*3),[T,C,P,k]=[P,k,L,D]}}}for(let E=0,S=o.length;E<S;E++)u.push({line:y(o[E].map(x=>x??NaN),f,p,m,v),points:y(l[E].map(x=>x??NaN),f,p,m,v)});const A=new this.prototype.constructor;return A.build(u,n,i,1,c,d,r),A}get box(){return a(this,Ge)}updateProperty(t,s){return t==="stroke-width"?w(this,Me,ev).call(this,s):null}updateParentDimensions([t,s],n){const[i,r]=w(this,Me,Ln).call(this);g(this,bn,t),g(this,An,s),g(this,fl,n);const[o,l]=w(this,Me,Ln).call(this),c=o-i,d=l-r,u=a(this,Ge);return u[0]-=c,u[1]-=d,u[2]+=2*c,u[3]+=2*d,u}updateRotation(t){return g(this,wh,t),{path:{transform:this.rotationTransform}}}get viewBox(){return a(this,Ge).map(J.svgRound).join(" ")}get defaultProperties(){const[t,s]=a(this,Ge);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${J.svgRound(t)} ${J.svgRound(s)}`}}}get rotationTransform(){const[,,t,s]=a(this,Ge);let n=0,i=0,r=0,o=0,l=0,c=0;switch(a(this,wh)){case 90:i=s/t,r=-t/s,l=t;break;case 180:n=-1,o=-1,l=t,c=s;break;case 270:i=-s/t,r=t/s,c=s;break;default:return""}return`matrix(${n} ${i} ${r} ${o} ${J.svgRound(l)} ${J.svgRound(c)})`}getPathResizingSVGProperties([t,s,n,i]){const[r,o]=w(this,Me,Ln).call(this),[l,c,d,u]=a(this,Ge);if(Math.abs(d-r)<=J.PRECISION||Math.abs(u-o)<=J.PRECISION){const y=t+n/2-(l+d/2),A=s+i/2-(c+u/2);return{path:{"transform-origin":`${J.svgRound(t)} ${J.svgRound(s)}`,transform:`${this.rotationTransform} translate(${y} ${A})`}}}const f=(n-2*r)/(d-2*r),p=(i-2*o)/(u-2*o),m=d/n,v=u/i;return{path:{"transform-origin":`${J.svgRound(l)} ${J.svgRound(c)}`,transform:`${this.rotationTransform} scale(${m} ${v}) translate(${J.svgRound(r)} ${J.svgRound(o)}) scale(${f} ${p}) translate(${J.svgRound(-r)} ${J.svgRound(-o)})`}}}getPathResizedSVGProperties([t,s,n,i]){const[r,o]=w(this,Me,Ln).call(this),l=a(this,Ge),[c,d,u,f]=l;if(l[0]=t,l[1]=s,l[2]=n,l[3]=i,Math.abs(u-r)<=J.PRECISION||Math.abs(f-o)<=J.PRECISION){const A=t+n/2-(c+u/2),E=s+i/2-(d+f/2);for(const{line:S,points:x}of a(this,vs))J._translate(S,A,E,S),J._translate(x,A,E,x);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${J.svgRound(t)} ${J.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const p=(n-2*r)/(u-2*r),m=(i-2*o)/(f-2*o),v=-p*(c+r)+t+r,y=-m*(d+o)+s+o;if(p!==1||m!==1||v!==0||y!==0)for(const{line:A,points:E}of a(this,vs))J._rescale(A,v,y,p,m,A),J._rescale(E,v,y,p,m,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${J.svgRound(t)} ${J.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,s],n){const[i,r]=n,o=a(this,Ge),l=t-o[0],c=s-o[1];if(a(this,bn)===i&&a(this,An)===r)for(const{line:d,points:u}of a(this,vs))J._translate(d,l,c,d),J._translate(u,l,c,u);else{const d=a(this,bn)/i,u=a(this,An)/r;g(this,bn,i),g(this,An,r);for(const{line:f,points:p}of a(this,vs))J._rescale(f,l,c,d,u,f),J._rescale(p,l,c,d,u,p);o[2]*=d,o[3]*=u}return o[0]=t,o[1]=s,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${J.svgRound(t)} ${J.svgRound(s)}`}}}get defaultSVGProperties(){const t=a(this,Ge);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${J.svgRound(t[0])} ${J.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}Ge=new WeakMap,wh=new WeakMap,Sh=new WeakMap,vs=new WeakMap,bn=new WeakMap,An=new WeakMap,fl=new WeakMap,pl=new WeakMap,Ra=new WeakMap,Me=new WeakSet,Ln=function(t=a(this,Ra)){const s=a(this,Sh)+t/2*a(this,fl);return a(this,pl)%180===0?[s/a(this,bn),s/a(this,An)]:[s/a(this,An),s/a(this,bn)]},qm=function(){const[t,s,n,i]=a(this,Ge),[r,o]=w(this,Me,Ln).call(this,0);return[t+r,s+o,n-2*r,i-2*o]},tv=function(){const t=g(this,Ge,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:i}of a(this,vs)){if(i.length<=12){for(let l=4,c=i.length;l<c;l+=6)Z.pointBoundingBox(i[l],i[l+1],t);continue}let r=i[4],o=i[5];for(let l=6,c=i.length;l<c;l+=6){const[d,u,f,p,m,v]=i.subarray(l,l+6);Z.bezierBoundingBox(r,o,d,u,f,p,m,v,t),r=m,o=v}}const[s,n]=w(this,Me,Ln).call(this);t[0]=Xe(t[0]-s,0,1),t[1]=Xe(t[1]-n,0,1),t[2]=Xe(t[2]+s,0,1),t[3]=Xe(t[3]+n,0,1),t[2]-=t[0],t[3]-=t[1]},ev=function(t){const[s,n]=w(this,Me,Ln).call(this);g(this,Ra,t);const[i,r]=w(this,Me,Ln).call(this),[o,l]=[i-s,r-n],c=a(this,Ge);return c[0]-=o,c[1]-=l,c[2]+=2*o,c[3]+=2*l,c};class lu extends Qm{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:Vt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new lu(this._viewParameters);return e.updateAll(this),e}}var Wd,sv;const so=class so extends Id{constructor(t){super({...t,name:"inkEditor"});b(this,Wd);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,s){Vt.initialize(t,s),this._defaultDrawingOptions=new lu(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!0}static get typesMap(){return At(this,"typesMap",new Map([[Et.INK_THICKNESS,"stroke-width"],[Et.INK_COLOR,"stroke"],[Et.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,s,n,i,r){return new yE(t,s,n,i,r,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,s,n,i,r,o){return kh.deserialize(t,s,n,i,r,o)}static async deserialize(t,s,n){let i=null;if(t instanceof op){const{data:{inkLists:o,rect:l,rotation:c,id:d,color:u,opacity:f,borderStyle:{rawWidth:p},popupRef:m,contentsObj:v},parent:{page:{pageNumber:y}}}=t;i=t={annotationType:ht.INK,color:Array.from(u),thickness:p,opacity:f,paths:{points:o},boxes:null,pageIndex:y-1,rect:l.slice(0),rotation:c,annotationElementId:d,id:d,deleted:!1,popupRef:m,comment:(v==null?void 0:v.str)||null}}const r=await super.deserialize(t,s,n);return r._initialData=i,t.comment&&r.setCommentData(t.comment),r}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new Td(this)),[["colorPicker",this._colorPicker]]}get colorType(){return Et.INK_COLOR}get colorValue(){return this._drawingOptions.stroke}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:s,parent:n}=this;s.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(t,s.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:s,opacity:n}){this._drawingOptions=so.getDefaultDrawingOptions({stroke:Z.makeHexColor(...t),"stroke-width":s,"stroke-opacity":n})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:s,points:n,rect:i}=this.serializeDraw(t),{_drawingOptions:{stroke:r,"stroke-opacity":o,"stroke-width":l}}=this,c={annotationType:ht.INK,color:Vt._colorManager.convert(r),opacity:o,thickness:l,paths:{lines:s,points:n},pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(c),t?(c.isCopy=!0,c):this.annotationElementId&&!w(this,Wd,sv).call(this,c)?null:(c.id=this.annotationElementId,c)}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:s,rect:n}=this.serializeDraw(!1),i={rect:n,thickness:this._drawingOptions["stroke-width"],points:s};return this.hasEditedComment&&(i.popup=this.comment),t.updateEdited(i),null}};Wd=new WeakSet,sv=function(t){const{color:s,thickness:n,opacity:i,pageIndex:r}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((o,l)=>o!==s[l])||t.thickness!==n||t.opacity!==i||t.pageIndex!==r},U(so,"_type","ink"),U(so,"_editorType",ht.INK),U(so,"_defaultDrawingOptions",null);let kf=so;class Mf extends kh{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const $h=8,El=3;var ka,Lt,Lf,Ys,nv,iv,Df,dd,rv,av,ov,Of,_f,lv;class bi{static extractContoursFromText(e,{fontFamily:t,fontStyle:s,fontWeight:n},i,r,o,l){let c=new OffscreenCanvas(1,1),d=c.getContext("2d",{alpha:!1});const u=200,f=d.font=`${s} ${n} ${u}px ${t}`,{actualBoundingBoxLeft:p,actualBoundingBoxRight:m,actualBoundingBoxAscent:v,actualBoundingBoxDescent:y,fontBoundingBoxAscent:A,fontBoundingBoxDescent:E,width:S}=d.measureText(e),x=1.5,T=Math.ceil(Math.max(Math.abs(p)+Math.abs(m)||0,S)*x),C=Math.ceil(Math.max(Math.abs(v)+Math.abs(y)||u,Math.abs(A)+Math.abs(E)||u)*x);c=new OffscreenCanvas(T,C),d=c.getContext("2d",{alpha:!0,willReadFrequently:!0}),d.font=f,d.filter="grayscale(1)",d.fillStyle="white",d.fillRect(0,0,T,C),d.fillStyle="black",d.fillText(e,T*(x-1)/2,C*(3-x)/2);const P=w(this,Lt,Of).call(this,d.getImageData(0,0,T,C).data),k=w(this,Lt,ov).call(this,P),R=w(this,Lt,_f).call(this,k),L=w(this,Lt,Df).call(this,P,T,C,R);return this.processDrawnLines({lines:{curves:L,width:T,height:C},pageWidth:i,pageHeight:r,rotation:o,innerMargin:l,mustSmooth:!0,areContours:!0})}static process(e,t,s,n,i){const[r,o,l]=w(this,Lt,lv).call(this,e),[c,d]=w(this,Lt,av).call(this,r,o,l,Math.hypot(o,l)*a(this,ka).sigmaSFactor,a(this,ka).sigmaR,a(this,ka).kernelSize),u=w(this,Lt,_f).call(this,d),f=w(this,Lt,Df).call(this,c,o,l,u);return this.processDrawnLines({lines:{curves:f,width:o,height:l},pageWidth:t,pageHeight:s,rotation:n,innerMargin:i,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:s,rotation:n,innerMargin:i,mustSmooth:r,areContours:o}){n%180!==0&&([t,s]=[s,t]);const{curves:l,width:c,height:d}=e,u=e.thickness??0,f=[],p=Math.min(t/c,s/d),m=p/t,v=p/s,y=[];for(const{points:E}of l){const S=r?w(this,Lt,rv).call(this,E):E;if(!S)continue;y.push(S);const x=S.length,T=new Float32Array(x),C=new Float32Array(3*(x===2?2:x-2));if(f.push({line:C,points:T}),x===2){T[0]=S[0]*m,T[1]=S[1]*v,C.set([NaN,NaN,NaN,NaN,T[0],T[1]],0);continue}let[P,k,R,L]=S;P*=m,k*=v,R*=m,L*=v,T.set([P,k,R,L],0),C.set([NaN,NaN,NaN,NaN,P,k],0);for(let D=4;D<x;D+=2){const H=T[D]=S[D]*m,V=T[D+1]=S[D+1]*v;C.set(J.createBezierPoints(P,k,R,L,H,V),(D-2)*3),[P,k,R,L]=[R,L,H,V]}}if(f.length===0)return null;const A=o?new Mf:new kh;return A.build(f,t,s,1,n,o?0:u,i),{outline:A,newCurves:y,areContours:o,thickness:u,width:c,height:d}}static async compressSignature({outlines:e,areContours:t,thickness:s,width:n,height:i}){let r=1/0,o=-1/0,l=0;for(const S of e){l+=S.length;for(let x=2,T=S.length;x<T;x++){const C=S[x]-S[x-2];r=Math.min(r,C),o=Math.max(o,C)}}let c;r>=-128&&o<=127?c=Int8Array:r>=-32768&&o<=32767?c=Int16Array:c=Int32Array;const d=e.length,u=$h+El*d,f=new Uint32Array(u);let p=0;f[p++]=u*Uint32Array.BYTES_PER_ELEMENT+(l-2*d)*c.BYTES_PER_ELEMENT,f[p++]=0,f[p++]=n,f[p++]=i,f[p++]=t?0:1,f[p++]=Math.max(0,Math.floor(s??0)),f[p++]=d,f[p++]=c.BYTES_PER_ELEMENT;for(const S of e)f[p++]=S.length-2,f[p++]=S[0],f[p++]=S[1];const m=new CompressionStream("deflate-raw"),v=m.writable.getWriter();await v.ready,v.write(f);const y=c.prototype.constructor;for(const S of e){const x=new y(S.length-2);for(let T=2,C=S.length;T<C;T++)x[T-2]=S[T]-S[T-2];v.write(x)}v.close();const A=await new Response(m.readable).arrayBuffer(),E=new Uint8Array(A);return og(E)}static async decompressSignature(e){try{const t=Hw(e),{readable:s,writable:n}=new DecompressionStream("deflate-raw"),i=n.getWriter();await i.ready,i.write(t).then(async()=>{await i.ready,await i.close()}).catch(()=>{});let r=null,o=0;for await(const S of s)r||(r=new Uint8Array(new Uint32Array(S.buffer,0,4)[0])),r.set(S,o),o+=S.length;const l=new Uint32Array(r.buffer,0,r.length>>2),c=l[1];if(c!==0)throw new Error(`Invalid version: ${c}`);const d=l[2],u=l[3],f=l[4]===0,p=l[5],m=l[6],v=l[7],y=[],A=($h+El*m)*Uint32Array.BYTES_PER_ELEMENT;let E;switch(v){case Int8Array.BYTES_PER_ELEMENT:E=new Int8Array(r.buffer,A);break;case Int16Array.BYTES_PER_ELEMENT:E=new Int16Array(r.buffer,A);break;case Int32Array.BYTES_PER_ELEMENT:E=new Int32Array(r.buffer,A);break}o=0;for(let S=0;S<m;S++){const x=l[El*S+$h],T=new Float32Array(x+2);y.push(T);for(let C=0;C<El-1;C++)T[C]=l[El*S+$h+C+1];for(let C=0;C<x;C++)T[C+2]=T[C]+E[o++]}return{areContours:f,thickness:p,outlines:y,width:d,height:u}}catch(t){return lt(`decompressSignature: ${t}`),null}}}ka=new WeakMap,Lt=new WeakSet,Lf=function(e,t,s,n){return s-=e,n-=t,s===0?n>0?0:4:s===1?n+6:2-n},Ys=new WeakMap,nv=function(e,t,s,n,i,r,o){const l=w(this,Lt,Lf).call(this,s,n,i,r);for(let c=0;c<8;c++){const d=(-c+l-o+16)%8,u=a(this,Ys)[2*d],f=a(this,Ys)[2*d+1];if(e[(s+u)*t+(n+f)]!==0)return d}return-1},iv=function(e,t,s,n,i,r,o){const l=w(this,Lt,Lf).call(this,s,n,i,r);for(let c=0;c<8;c++){const d=(c+l+o+16)%8,u=a(this,Ys)[2*d],f=a(this,Ys)[2*d+1];if(e[(s+u)*t+(n+f)]!==0)return d}return-1},Df=function(e,t,s,n){const i=e.length,r=new Int32Array(i);for(let d=0;d<i;d++)r[d]=e[d]<=n?1:0;for(let d=1;d<s-1;d++)r[d*t]=r[d*t+t-1]=0;for(let d=0;d<t;d++)r[d]=r[t*s-1-d]=0;let o=1,l;const c=[];for(let d=1;d<s-1;d++){l=1;for(let u=1;u<t-1;u++){const f=d*t+u,p=r[f];if(p===0)continue;let m=d,v=u;if(p===1&&r[f-1]===0)o+=1,v-=1;else if(p>=1&&r[f+1]===0)o+=1,v+=1,p>1&&(l=p);else{p!==1&&(l=Math.abs(p));continue}const y=[u,d],A=v===u+1,E={isHole:A,points:y,id:o,parent:0};c.push(E);let S;for(const D of c)if(D.id===l){S=D;break}S?S.isHole?E.parent=A?S.parent:l:E.parent=A?l:S.parent:E.parent=A?l:0;const x=w(this,Lt,nv).call(this,r,t,d,u,m,v,0);if(x===-1){r[f]=-o,r[f]!==1&&(l=Math.abs(r[f]));continue}let T=a(this,Ys)[2*x],C=a(this,Ys)[2*x+1];const P=d+T,k=u+C;m=P,v=k;let R=d,L=u;for(;;){const D=w(this,Lt,iv).call(this,r,t,R,L,m,v,1);T=a(this,Ys)[2*D],C=a(this,Ys)[2*D+1];const H=R+T,V=L+C;y.push(V,H);const G=R*t+L;if(r[G+1]===0?r[G]=-o:r[G]===1&&(r[G]=o),H===d&&V===u&&R===P&&L===k){r[f]!==1&&(l=Math.abs(r[f]));break}else m=R,v=L,R=H,L=V}}}return c},dd=function(e,t,s,n){if(s-t<=4){for(let P=t;P<s-2;P+=2)n.push(e[P],e[P+1]);return}const i=e[t],r=e[t+1],o=e[s-4]-i,l=e[s-3]-r,c=Math.hypot(o,l),d=o/c,u=l/c,f=d*r-u*i,p=l/o,m=1/c,v=Math.atan(p),y=Math.cos(v),A=Math.sin(v),E=m*(Math.abs(y)+Math.abs(A)),S=m*(1-E+E**2),x=Math.max(Math.atan(Math.abs(A+y)*S),Math.atan(Math.abs(A-y)*S));let T=0,C=t;for(let P=t+2;P<s-2;P+=2){const k=Math.abs(f-d*e[P+1]+u*e[P]);k>T&&(C=P,T=k)}T>(c*x)**2?(w(this,Lt,dd).call(this,e,t,C+2,n),w(this,Lt,dd).call(this,e,C,s,n)):n.push(i,r)},rv=function(e){const t=[],s=e.length;return w(this,Lt,dd).call(this,e,0,s,t),t.push(e[s-2],e[s-1]),t.length<=4?null:t},av=function(e,t,s,n,i,r){const o=new Float32Array(r**2),l=-2*n**2,c=r>>1;for(let v=0;v<r;v++){const y=(v-c)**2;for(let A=0;A<r;A++)o[v*r+A]=Math.exp((y+(A-c)**2)/l)}const d=new Float32Array(256),u=-2*i**2;for(let v=0;v<256;v++)d[v]=Math.exp(v**2/u);const f=e.length,p=new Uint8Array(f),m=new Uint32Array(256);for(let v=0;v<s;v++)for(let y=0;y<t;y++){const A=v*t+y,E=e[A];let S=0,x=0;for(let C=0;C<r;C++){const P=v+C-c;if(!(P<0||P>=s))for(let k=0;k<r;k++){const R=y+k-c;if(R<0||R>=t)continue;const L=e[P*t+R],D=o[C*r+k]*d[Math.abs(L-E)];S+=L*D,x+=D}}const T=p[A]=Math.round(S/x);m[T]++}return[p,m]},ov=function(e){const t=new Uint32Array(256);for(const s of e)t[s]++;return t},Of=function(e){const t=e.length,s=new Uint8ClampedArray(t>>2);let n=-1/0,i=1/0;for(let o=0,l=s.length;o<l;o++){const c=s[o]=e[o<<2];n=Math.max(n,c),i=Math.min(i,c)}const r=255/(n-i);for(let o=0,l=s.length;o<l;o++)s[o]=(s[o]-i)*r;return s},_f=function(e){let t,s=-1/0,n=-1/0;const i=e.findIndex(l=>l!==0);let r=i,o=i;for(t=i;t<256;t++){const l=e[t];l>s&&(t-r>n&&(n=t-r,o=t-1),s=l,r=t)}for(t=o-1;t>=0&&!(e[t]>e[t+1]);t--);return t},lv=function(e){const t=e,{width:s,height:n}=e,{maxDim:i}=a(this,ka);let r=s,o=n;if(s>i||n>i){let f=s,p=n,m=Math.log2(Math.max(s,n)/i);const v=Math.floor(m);m=m===v?v-1:v;for(let A=0;A<m;A++){r=Math.ceil(f/2),o=Math.ceil(p/2);const E=new OffscreenCanvas(r,o);E.getContext("2d").drawImage(e,0,0,f,p,0,0,r,o),f=r,p=o,e!==t&&e.close(),e=E.transferToImageBitmap()}const y=Math.min(i/r,i/o);r=Math.round(r*y),o=Math.round(o*y)}const c=new OffscreenCanvas(r,o).getContext("2d",{willReadFrequently:!0});c.fillStyle="white",c.fillRect(0,0,r,o),c.filter="grayscale(1)",c.drawImage(e,0,0,e.width,e.height,0,0,r,o);const d=c.getImageData(0,0,r,o).data;return[w(this,Lt,Of).call(this,d),r,o]},b(bi,Lt),b(bi,ka,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),b(bi,Ys,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class lp extends Qm{constructor(){super(),super.updateProperties({fill:Vt._defaultLineColor,"stroke-width":0})}clone(){const e=new lp;return e.updateAll(this),e}}class cp extends lu{constructor(e){super(e),super.updateProperties({stroke:Vt._defaultLineColor,"stroke-width":1})}clone(){const e=new cp(this._viewParameters);return e.updateAll(this),e}}var ur,wn,fr,Ma;const ss=class ss extends Id{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});b(this,ur,!1);b(this,wn,null);b(this,fr,null);b(this,Ma,null);this._willKeepAspectRatio=!0,g(this,fr,t.signatureData||null),g(this,wn,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,s){Vt.initialize(t,s),this._defaultDrawingOptions=new lp,this._defaultDrawnSignatureOptions=new cp(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!1}static get typesMap(){return At(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!a(this,wn)}}static computeTelemetryFinalData(t){const s=t.get("hasDescription");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,s;const{_isCopy:n}=this;if(n&&(this._isCopy=!1,t=this.x,s=this.y),super.render(),this._drawId===null)if(a(this,fr)){const{lines:i,mustSmooth:r,areContours:o,description:l,uuid:c,heightInPage:d}=a(this,fr),{rawDims:{pageWidth:u,pageHeight:f},rotation:p}=this.parent.viewport,m=bi.processDrawnLines({lines:i,pageWidth:u,pageHeight:f,rotation:p,innerMargin:ss._INNER_MARGIN,mustSmooth:r,areContours:o});this.addSignature(m,d,l,c)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:a(this,wn)||""}));return n&&(this._isCopy=!0,this._moveAfterPaste(t,s)),this.div}setUuid(t){g(this,Ma,t),this.addEditToolbar()}getUuid(){return a(this,Ma)}get description(){return a(this,wn)}set description(t){g(this,wn,t),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(s=>{s==null||s.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:s,thickness:n,width:i,height:r}=a(this,fr),o=Math.max(i,r),l=bi.processDrawnLines({lines:{curves:t.map(c=>({points:c})),thickness:n,width:i,height:r},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:s});return{areContours:s,outline:l.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,s,n,i){const{x:r,y:o}=this,{outline:l}=g(this,fr,t);g(this,ur,l instanceof Mf),this.description=n;let c;a(this,ur)?c=ss.getDefaultDrawingOptions():(c=ss._defaultDrawnSignatureOptions.clone(),c.updateProperties({"stroke-width":l.thickness})),this._addOutlines({drawOutlines:l,drawingOptions:c});const[d,u]=this.parentDimensions,[,f]=this.pageDimensions;let p=s/f;p=p>=1?.5:p,this.width*=p/this.height,this.width>=1&&(p*=.9/this.width,this.width=.9),this.height=p,this.setDims(d*this.width,u*this.height),this.x=r,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(i),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!i,hasDescription:!!n}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:s,pageHeight:n},rotation:i}=this.parent.viewport;return bi.process(t,s,n,i,ss._INNER_MARGIN)}getFromText(t,s){const{rawDims:{pageWidth:n,pageHeight:i},rotation:r}=this.parent.viewport;return bi.extractContoursFromText(t,s,n,i,r,ss._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:s,pageHeight:n},rotation:i}=this.parent.viewport;return bi.processDrawnLines({lines:t,pageWidth:s,pageHeight:n,rotation:i,innerMargin:ss._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:s}){t?this._drawingOptions=ss.getDefaultDrawingOptions():(this._drawingOptions=ss._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":s}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:s,points:n,rect:i}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":r}}=this,o={annotationType:ht.SIGNATURE,isSignature:!0,areContours:a(this,ur),color:[0,0,0],thickness:a(this,ur)?0:r,pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(o),t?(o.paths={lines:s,points:n},o.uuid=a(this,Ma),o.isCopy=!0):o.lines=s,a(this,wn)&&(o.accessibilityData={type:"Figure",alt:a(this,wn)}),o}static deserializeDraw(t,s,n,i,r,o){return o.areContours?Mf.deserialize(t,s,n,i,r,o):kh.deserialize(t,s,n,i,r,o)}static async deserialize(t,s,n){var r;const i=await super.deserialize(t,s,n);return g(i,ur,t.areContours),i.description=((r=t.accessibilityData)==null?void 0:r.alt)||"",g(i,Ma,t.uuid),i}};ur=new WeakMap,wn=new WeakMap,fr=new WeakMap,Ma=new WeakMap,U(ss,"_type","signature"),U(ss,"_editorType",ht.SIGNATURE),U(ss,"_defaultDrawingOptions",null);let Nf=ss;var Xt,we,pr,pi,gr,gl,gi,La,Sn,ys,ml,Ct,Ul,jl,ud,fd,pd,Bf,gd,cv;class Ff extends Vt{constructor(t){super({...t,name:"stampEditor"});b(this,Ct);b(this,Xt,null);b(this,we,null);b(this,pr,null);b(this,pi,null);b(this,gr,null);b(this,gl,"");b(this,gi,null);b(this,La,!1);b(this,Sn,null);b(this,ys,!1);b(this,ml,!1);g(this,pi,t.bitmapUrl),g(this,gr,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,s){Vt.initialize(t,s)}static isHandlingMimeForPasting(t){return Iu.includes(t)}static paste(t,s){s.pasteEditor({mode:ht.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const s=t.get("hasAltText");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}async mlGuessAltText(t=null,s=!0){if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:i,width:r,height:o}=t||this.copyCanvas(null,null,!0).imageData,l=await n.guess({name:"altText",request:{data:i,width:r,height:o,channels:i.length/(r*o)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const c=l.output;return await this.setGuessedAltText(c),s&&!this.hasAltTextData()&&(this.altTextData={alt:c,decorative:!1}),c}remove(){var t;a(this,we)&&(g(this,Xt,null),this._uiManager.imageManager.deleteId(a(this,we)),(t=a(this,gi))==null||t.remove(),g(this,gi,null),a(this,Sn)&&(clearTimeout(a(this,Sn)),g(this,Sn,null))),super.remove()}rebuild(){if(!this.parent){a(this,we)&&w(this,Ct,ud).call(this);return}super.rebuild(),this.div!==null&&(a(this,we)&&a(this,gi)===null&&w(this,Ct,ud).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(a(this,pr)||a(this,Xt)||a(this,pi)||a(this,gr)||a(this,we)||a(this,La))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,s;return this._isCopy&&(t=this.x,s=this.y),super.render(),this.div.hidden=!0,this.createAltText(),a(this,La)||(a(this,Xt)?w(this,Ct,fd).call(this):w(this,Ct,ud).call(this)),this._isCopy&&this._moveAfterPaste(t,s),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,s){const{id:n,bitmap:i}=this._uiManager.imageManager.getFromCanvas(t,s);s.remove(),n&&this._uiManager.imageManager.isValidId(n)&&(g(this,we,n),i&&g(this,Xt,i),g(this,La,!1),w(this,Ct,fd).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;a(this,Sn)!==null&&clearTimeout(a(this,Sn)),g(this,Sn,setTimeout(()=>{g(this,Sn,null),w(this,Ct,Bf).call(this)},200))}copyCanvas(t,s,n=!1){var p;t||(t=224);const{width:i,height:r}=a(this,Xt),o=new Pn;let l=a(this,Xt),c=i,d=r,u=null;if(s){if(i>s||r>s){const k=Math.min(s/i,s/r);c=Math.floor(i*k),d=Math.floor(r*k)}u=document.createElement("canvas");const m=u.width=Math.ceil(c*o.sx),v=u.height=Math.ceil(d*o.sy);a(this,ys)||(l=w(this,Ct,pd).call(this,m,v));const y=u.getContext("2d");y.filter=this._uiManager.hcmFilter;let A="white",E="#cfcfd8";this._uiManager.hcmFilter!=="none"?E="black":(p=window.matchMedia)!=null&&p.call(window,"(prefers-color-scheme: dark)").matches&&(A="#8f8f9d",E="#42414d");const S=15,x=S*o.sx,T=S*o.sy,C=new OffscreenCanvas(x*2,T*2),P=C.getContext("2d");P.fillStyle=A,P.fillRect(0,0,x*2,T*2),P.fillStyle=E,P.fillRect(0,0,x,T),P.fillRect(x,T,x,T),y.fillStyle=y.createPattern(C,"repeat"),y.fillRect(0,0,m,v),y.drawImage(l,0,0,l.width,l.height,0,0,m,v)}let f=null;if(n){let m,v;if(o.symmetric&&l.width<t&&l.height<t)m=l.width,v=l.height;else if(l=a(this,Xt),i>t||r>t){const E=Math.min(t/i,t/r);m=Math.floor(i*E),v=Math.floor(r*E),a(this,ys)||(l=w(this,Ct,pd).call(this,m,v))}const A=new OffscreenCanvas(m,v).getContext("2d",{willReadFrequently:!0});A.drawImage(l,0,0,l.width,l.height,0,0,m,v),f={width:m,height:v,data:A.getImageData(0,0,m,v).data}}return{canvas:u,width:c,height:d,imageData:f}}static async deserialize(t,s,n){var y;let i=null,r=!1;if(t instanceof xm){const{data:{rect:A,rotation:E,id:S,structParent:x,popupRef:T,contentsObj:C},container:P,parent:{page:{pageNumber:k}},canvas:R}=t;let L,D;R?(delete t.canvas,{id:L,bitmap:D}=n.imageManager.getFromCanvas(P.id,R),R.remove()):(r=!0,t._hasNoCanvas=!0);const H=((y=await s._structTree.getAriaAttributes(`${tp}${S}`))==null?void 0:y.get("aria-label"))||"";i=t={annotationType:ht.STAMP,bitmapId:L,bitmap:D,pageIndex:k-1,rect:A.slice(0),rotation:E,annotationElementId:S,id:S,deleted:!1,accessibilityData:{decorative:!1,altText:H},isSvg:!1,structParent:x,popupRef:T,comment:(C==null?void 0:C.str)||null}}const o=await super.deserialize(t,s,n),{rect:l,bitmap:c,bitmapUrl:d,bitmapId:u,isSvg:f,accessibilityData:p}=t;r?(n.addMissingCanvas(t.id,o),g(o,La,!0)):u&&n.imageManager.isValidId(u)?(g(o,we,u),c&&g(o,Xt,c)):g(o,pi,d),g(o,ys,f);const[m,v]=o.pageDimensions;return o.width=(l[2]-l[0])/m,o.height=(l[3]-l[1])/v,p&&(o.altTextData=p),o._initialData=i,t.comment&&o.setCommentData(t.comment),g(o,ml,!!i),o}serialize(t=!1,s=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n={annotationType:ht.STAMP,bitmapId:a(this,we),pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,isSvg:a(this,ys),structTreeParentId:this._structTreeParentId};if(this.addComment(n),t)return n.bitmapUrl=w(this,Ct,gd).call(this,!0),n.accessibilityData=this.serializeAltText(!0),n.isCopy=!0,n;const{decorative:i,altText:r}=this.serializeAltText(!1);if(!i&&r&&(n.accessibilityData={type:"Figure",alt:r}),this.annotationElementId){const l=w(this,Ct,cv).call(this,n);if(l.isSame)return null;l.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1}if(n.id=this.annotationElementId,s===null)return n;s.stamps||(s.stamps=new Map);const o=a(this,ys)?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!s.stamps.has(a(this,we)))s.stamps.set(a(this,we),{area:o,serialized:n}),n.bitmap=w(this,Ct,gd).call(this,!1);else if(a(this,ys)){const l=s.stamps.get(a(this,we));o>l.area&&(l.area=o,l.serialized.bitmap.close(),l.serialized.bitmap=w(this,Ct,gd).call(this,!1))}return n}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const s={rect:this.getPDFRect()};return this.hasEditedComment&&(s.popup=this.comment),t.updateEdited(s),null}}Xt=new WeakMap,we=new WeakMap,pr=new WeakMap,pi=new WeakMap,gr=new WeakMap,gl=new WeakMap,gi=new WeakMap,La=new WeakMap,Sn=new WeakMap,ys=new WeakMap,ml=new WeakMap,Ct=new WeakSet,Ul=function(t,s=!1){if(!t){this.remove();return}g(this,Xt,t.bitmap),s||(g(this,we,t.id),g(this,ys,t.isSvg)),t.file&&g(this,gl,t.file.name),w(this,Ct,fd).call(this)},jl=function(){if(g(this,pr,null),this._uiManager.enableWaiting(!1),!!a(this,gi)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&a(this,Xt)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&a(this,Xt)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},ud=function(){if(a(this,we)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(a(this,we)).then(n=>w(this,Ct,Ul).call(this,n,!0)).finally(()=>w(this,Ct,jl).call(this));return}if(a(this,pi)){const n=a(this,pi);g(this,pi,null),this._uiManager.enableWaiting(!0),g(this,pr,this._uiManager.imageManager.getFromUrl(n).then(i=>w(this,Ct,Ul).call(this,i)).finally(()=>w(this,Ct,jl).call(this)));return}if(a(this,gr)){const n=a(this,gr);g(this,gr,null),this._uiManager.enableWaiting(!0),g(this,pr,this._uiManager.imageManager.getFromFile(n).then(i=>w(this,Ct,Ul).call(this,i)).finally(()=>w(this,Ct,jl).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=Iu.join(",");const s=this._uiManager._signal;g(this,pr,new Promise(n=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const i=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),w(this,Ct,Ul).call(this,i)}n()},{signal:s}),t.addEventListener("cancel",()=>{this.remove(),n()},{signal:s})}).finally(()=>w(this,Ct,jl).call(this))),t.click()},fd=function(){var u;const{div:t}=this;let{width:s,height:n}=a(this,Xt);const[i,r]=this.pageDimensions,o=.75;if(this.width)s=this.width*i,n=this.height*r;else if(s>o*i||n>o*r){const f=Math.min(o*i/s,o*r/n);s*=f,n*=f}const[l,c]=this.parentDimensions;this.setDims(s*l/i,n*c/r),this._uiManager.enableWaiting(!1);const d=g(this,gi,document.createElement("canvas"));d.setAttribute("role","img"),this.addContainer(d),this.width=s/i,this.height=n/r,(u=this._initialOptions)!=null&&u.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),w(this,Ct,Bf).call(this),a(this,ml)||(this.parent.addUndoableEditor(this),g(this,ml,!0)),this._reportTelemetry({action:"inserted_image"}),a(this,gl)&&this.div.setAttribute("aria-description",a(this,gl)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},pd=function(t,s){const{width:n,height:i}=a(this,Xt);let r=n,o=i,l=a(this,Xt);for(;r>2*t||o>2*s;){const c=r,d=o;r>2*t&&(r=r>=16384?Math.floor(r/2)-1:Math.ceil(r/2)),o>2*s&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const u=new OffscreenCanvas(r,o);u.getContext("2d").drawImage(l,0,0,c,d,0,0,r,o),l=u.transferToImageBitmap()}return l},Bf=function(){const[t,s]=this.parentDimensions,{width:n,height:i}=this,r=new Pn,o=Math.ceil(n*t*r.sx),l=Math.ceil(i*s*r.sy),c=a(this,gi);if(!c||c.width===o&&c.height===l)return;c.width=o,c.height=l;const d=a(this,ys)?a(this,Xt):w(this,Ct,pd).call(this,o,l),u=c.getContext("2d");u.filter=this._uiManager.hcmFilter,u.drawImage(d,0,0,d.width,d.height,0,0,o,l)},gd=function(t){if(t){if(a(this,ys)){const i=this._uiManager.imageManager.getSvgUrl(a(this,we));if(i)return i}const s=document.createElement("canvas");return{width:s.width,height:s.height}=a(this,Xt),s.getContext("2d").drawImage(a(this,Xt),0,0),s.toDataURL()}if(a(this,ys)){const[s,n]=this.pageDimensions,i=Math.round(this.width*s*Sr.PDF_TO_CSS_UNITS),r=Math.round(this.height*n*Sr.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(i,r);return o.getContext("2d").drawImage(a(this,Xt),0,0,a(this,Xt).width,a(this,Xt).height,0,0,i,r),o.transferToImageBitmap()}return structuredClone(a(this,Xt))},cv=function(t){var o;const{pageIndex:s,accessibilityData:{altText:n}}=this._initialData,i=t.pageIndex===s,r=(((o=t.accessibilityData)==null?void 0:o.alt)||"")===n;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&i&&r,isSameAltText:r}},U(Ff,"_type","stamp"),U(Ff,"_editorType",ht.STAMP);var Da,vl,En,mr,mi,bs,vr,yl,Oa,Ks,vi,Se,yi,yr,bl,et,br,Yt,hv,en,Hf,Vf,md;const Hs=class Hs{constructor({uiManager:e,pageIndex:t,div:s,structTreeLayer:n,accessibilityManager:i,annotationLayer:r,drawLayer:o,textLayer:l,viewport:c,l10n:d}){b(this,Yt);b(this,Da);b(this,vl,!1);b(this,En,null);b(this,mr,null);b(this,mi,null);b(this,bs,new Map);b(this,vr,!1);b(this,yl,!1);b(this,Oa,!1);b(this,Ks,null);b(this,vi,null);b(this,Se,null);b(this,yi,null);b(this,yr,null);b(this,bl,-1);b(this,et);const u=[...a(Hs,br).values()];if(!Hs._initialized){Hs._initialized=!0;for(const f of u)f.initialize(d,e)}e.registerEditorTypes(u),g(this,et,e),this.pageIndex=t,this.div=s,g(this,Da,i),g(this,En,r),this.viewport=c,g(this,Se,l),this.drawLayer=o,this._structTree=n,a(this,et).addLayer(this)}get isEmpty(){return a(this,bs).size===0}get isInvisible(){return this.isEmpty&&a(this,et).getMode()===ht.NONE}updateToolbar(e){a(this,et).updateToolbar(e)}updateMode(e=a(this,et).getMode()){switch(w(this,Yt,md).call(this),e){case ht.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case ht.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case ht.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const s of a(Hs,br).values())t.toggle(`${s._type}Editing`,e===s._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=a(this,Se))==null?void 0:t.div)}setEditingState(e){a(this,et).setEditingState(e)}addCommands(e){a(this,et).addCommands(e)}cleanUndoStack(e){a(this,et).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=a(this,En))==null||t.div.classList.toggle("disabled",!e)}async enable(){var s;g(this,Oa,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),(s=a(this,yr))==null||s.abort(),g(this,yr,null);const e=new Set;for(const n of a(this,bs).values())n.enableEditing(),n.show(!0),n.annotationElementId&&(a(this,et).removeChangedExistingAnnotation(n),e.add(n.annotationElementId));if(!a(this,En)){g(this,Oa,!1);return}const t=a(this,En).getEditableAnnotations();for(const n of t){if(n.hide(),a(this,et).isDeletedAnnotationElement(n.data.id)||e.has(n.data.id))continue;const i=await this.deserialize(n);i&&(this.addOrRebuild(i),i.enableEditing())}g(this,Oa,!1)}disable(){var n;if(g(this,yl,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),a(this,Se)&&!a(this,yr)){g(this,yr,new AbortController);const i=a(this,et).combinedSignal(a(this,yr));a(this,Se).div.addEventListener("pointerdown",r=>{const{clientX:l,clientY:c,timeStamp:d}=r,u=a(this,bl);if(d-u>500){g(this,bl,d);return}g(this,bl,-1);const{classList:f}=this.div;f.toggle("getElements",!0);const p=document.elementsFromPoint(l,c);if(f.toggle("getElements",!1),!this.div.contains(p[0]))return;let m;const v=new RegExp(`^${sg}[0-9]+$`);for(const A of p)if(v.test(A.id)){m=A.id;break}if(!m)return;const y=a(this,bs).get(m);(y==null?void 0:y.annotationElementId)===null&&(r.stopPropagation(),r.preventDefault(),y.dblclick())},{signal:i,capture:!0})}const e=new Map,t=new Map;for(const i of a(this,bs).values())if(i.disableEditing(),!!i.annotationElementId){if(i.serialize()!==null){e.set(i.annotationElementId,i);continue}else t.set(i.annotationElementId,i);(n=this.getEditableAnnotation(i.annotationElementId))==null||n.show(),i.remove()}if(a(this,En)){const i=a(this,En).getEditableAnnotations();for(const r of i){const{id:o}=r.data;if(a(this,et).isDeletedAnnotationElement(o)){r.updateEdited({deleted:!0});continue}let l=t.get(o);if(l){l.resetAnnotationElement(r),l.show(!1),r.show();continue}l=e.get(o),l&&(a(this,et).addChangedExistingAnnotation(l),l.renderAnnotationElement(r)&&l.show(!1)),r.show()}}w(this,Yt,md).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const i of a(Hs,br).values())s.remove(`${i._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),g(this,yl,!1)}getEditableAnnotation(e){var t;return((t=a(this,En))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){a(this,et).getActive()!==e&&a(this,et).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=a(this,Se))!=null&&e.div&&!a(this,yi)){g(this,yi,new AbortController);const t=a(this,et).combinedSignal(a(this,yi));a(this,Se).div.addEventListener("pointerdown",w(this,Yt,hv).bind(this),{signal:t}),a(this,Se).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=a(this,Se))!=null&&e.div&&a(this,yi)&&(a(this,yi).abort(),g(this,yi,null),a(this,Se).div.classList.remove("highlighting"))}enableClick(){if(a(this,mr))return;g(this,mr,new AbortController);const e=a(this,et).combinedSignal(a(this,mr));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=a(this,mr))==null||e.abort(),g(this,mr,null)}attach(e){a(this,bs).set(e.id,e);const{annotationElementId:t}=e;t&&a(this,et).isDeletedAnnotationElement(t)&&a(this,et).removeDeletedAnnotationElement(e)}detach(e){var t;a(this,bs).delete(e.id),(t=a(this,Da))==null||t.removePointerInTextLayer(e.contentDiv),!a(this,yl)&&e.annotationElementId&&a(this,et).addDeletedAnnotationElement(e)}remove(e){this.detach(e),a(this,et).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(a(this,et).addDeletedAnnotationElement(e.annotationElementId),Vt.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),a(this,et).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!a(this,Oa)),a(this,et).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var s;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!a(this,mi)&&(e._focusEventsAllowed=!1,g(this,mi,setTimeout(()=>{g(this,mi,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:a(this,et)._signal}),t.focus())},0))),e._structTreeParentId=(s=a(this,Da))==null?void 0:s.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),s=()=>{e.remove()};this.addCommands({cmd:t,undo:s,mustExec:!1})}getNextId(){return a(this,et).getId()}combinedSignal(e){return a(this,et).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=a(this,Yt,en))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await a(this,et).updateMode(e.mode);const{offsetX:s,offsetY:n}=w(this,Yt,Vf).call(this),i=this.getNextId(),r=w(this,Yt,Hf).call(this,{parent:this,id:i,x:s,y:n,uiManager:a(this,et),isCentered:!0,...t});r&&this.add(r)}async deserialize(e){var t;return await((t=a(Hs,br).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,a(this,et)))||null}createAndAddNewEditor(e,t,s={}){const n=this.getNextId(),i=w(this,Yt,Hf).call(this,{parent:this,id:n,x:e.offsetX,y:e.offsetY,uiManager:a(this,et),isCentered:t,...s});return i&&this.add(i),i}addNewEditor(e={}){this.createAndAddNewEditor(w(this,Yt,Vf).call(this),!0,e)}setSelected(e){a(this,et).setSelected(e)}toggleSelected(e){a(this,et).toggleSelected(e)}unselect(e){a(this,et).unselect(e)}pointerup(e){var n;const{isMac:t}=De.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!a(this,vr)||(g(this,vr,!1),(n=a(this,Yt,en))!=null&&n.isDrawer&&a(this,Yt,en).supportMultipleDrawings))return;if(!a(this,vl)){g(this,vl,!0);return}const s=a(this,et).getMode();if(s===ht.STAMP||s===ht.SIGNATURE){a(this,et).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var n;if(a(this,et).getMode()===ht.HIGHLIGHT&&this.enableTextSelection(),a(this,vr)){g(this,vr,!1);return}const{isMac:t}=De.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(g(this,vr,!0),(n=a(this,Yt,en))!=null&&n.isDrawer){this.startDrawingSession(e);return}const s=a(this,et).getActive();g(this,vl,!s||s.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),a(this,Ks)){a(this,Yt,en).startDrawing(this,a(this,et),!1,e);return}a(this,et).setCurrentDrawingSession(this),g(this,Ks,new AbortController);const t=a(this,et).combinedSignal(a(this,Ks));this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(g(this,vi,null),this.commitOrRemove())},{signal:t}),a(this,Yt,en).startDrawing(this,a(this,et),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&g(this,vi,t);return}a(this,vi)&&setTimeout(()=>{var t;(t=a(this,vi))==null||t.focus(),g(this,vi,null)},0)}endDrawingSession(e=!1){return a(this,Ks)?(a(this,et).setCurrentDrawingSession(null),a(this,Ks).abort(),g(this,Ks,null),g(this,vi,null),a(this,Yt,en).endDrawing(e)):null}findNewParent(e,t,s){const n=a(this,et).findParent(t,s);return n===null||n===this?!1:(n.changeParent(e),!0)}commitOrRemove(){return a(this,Ks)?(this.endDrawingSession(),!0):!1}onScaleChanging(){a(this,Ks)&&a(this,Yt,en).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=a(this,et).getActive())==null?void 0:e.parent)===this&&(a(this,et).commitOrRemove(),a(this,et).setActiveEditor(null)),a(this,mi)&&(clearTimeout(a(this,mi)),g(this,mi,null));for(const s of a(this,bs).values())(t=a(this,Da))==null||t.removePointerInTextLayer(s.contentDiv),s.setParent(null),s.isAttachedToDOM=!1,s.div.remove();this.div=null,a(this,bs).clear(),a(this,et).removeLayer(this)}render({viewport:e}){this.viewport=e,Fa(this.div,e);for(const t of a(this,et).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){a(this,et).commitOrRemove(),w(this,Yt,md).call(this);const t=this.viewport.rotation,s=e.rotation;if(this.viewport=e,Fa(this.div,{rotation:s}),t!==s)for(const n of a(this,bs).values())n.rotate(s)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return a(this,et).viewParameters.realScale}};Da=new WeakMap,vl=new WeakMap,En=new WeakMap,mr=new WeakMap,mi=new WeakMap,bs=new WeakMap,vr=new WeakMap,yl=new WeakMap,Oa=new WeakMap,Ks=new WeakMap,vi=new WeakMap,Se=new WeakMap,yi=new WeakMap,yr=new WeakMap,bl=new WeakMap,et=new WeakMap,br=new WeakMap,Yt=new WeakSet,hv=function(e){a(this,et).unselectAll();const{target:t}=e;if(t===a(this,Se).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&a(this,Se).div.contains(t)){const{isMac:s}=De.platform;if(e.button!==0||e.ctrlKey&&s)return;a(this,et).showAllEditors("highlight",!0,!0),a(this,Se).div.classList.add("free"),this.toggleDrawing(),Pd.startHighlighting(this,a(this,et).direction==="ltr",{target:a(this,Se).div,x:e.x,y:e.y}),a(this,Se).div.addEventListener("pointerup",()=>{a(this,Se).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:a(this,et)._signal}),e.preventDefault()}},en=function(){return a(Hs,br).get(a(this,et).getMode())},Hf=function(e){const t=a(this,Yt,en);return t?new t.prototype.constructor(e):null},Vf=function(){const{x:e,y:t,width:s,height:n}=this.div.getBoundingClientRect(),i=Math.max(0,e),r=Math.max(0,t),o=Math.min(window.innerWidth,e+s),l=Math.min(window.innerHeight,t+n),c=(i+o)/2-e,d=(r+l)/2-t,[u,f]=this.viewport.rotation%180===0?[c,d]:[d,c];return{offsetX:u,offsetY:f}},md=function(){for(const e of a(this,bs).values())e.isEmpty()&&e.remove()},U(Hs,"_initialized",!1),b(Hs,br,new Map([Af,kf,Ff,Pd,Nf].map(e=>[e._editorType,e])));let $f=Hs;var Js,ze,_a,Eh,Xd,dv,In,jf,uv,Gf;const de=class de{constructor({pageIndex:e}){b(this,In);b(this,Js,null);b(this,ze,new Map);b(this,_a,new Map);this.pageIndex=e}setParent(e){if(!a(this,Js)){g(this,Js,e);return}if(a(this,Js)!==e){if(a(this,ze).size>0)for(const t of a(this,ze).values())t.remove(),e.append(t);g(this,Js,e)}}static get _svgFactory(){return At(this,"_svgFactory",new xd)}draw(e,t=!1,s=!1){const n=ce(de,Eh)._++,i=w(this,In,jf).call(this),r=de._svgFactory.createElement("defs");i.append(r);const o=de._svgFactory.createElement("path");r.append(o);const l=`path_p${this.pageIndex}_${n}`;o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke"),t&&a(this,_a).set(n,o);const c=s?w(this,In,uv).call(this,r,l):null,d=de._svgFactory.createElement("use");return i.append(d),d.setAttribute("href",`#${l}`),this.updateProperties(i,e),a(this,ze).set(n,i),{id:n,clipPathId:`url(#${c})`}}drawOutline(e,t){const s=ce(de,Eh)._++,n=w(this,In,jf).call(this),i=de._svgFactory.createElement("defs");n.append(i);const r=de._svgFactory.createElement("path");i.append(r);const o=`path_p${this.pageIndex}_${s}`;r.setAttribute("id",o),r.setAttribute("vector-effect","non-scaling-stroke");let l;if(t){const u=de._svgFactory.createElement("mask");i.append(u),l=`mask_p${this.pageIndex}_${s}`,u.setAttribute("id",l),u.setAttribute("maskUnits","objectBoundingBox");const f=de._svgFactory.createElement("rect");u.append(f),f.setAttribute("width","1"),f.setAttribute("height","1"),f.setAttribute("fill","white");const p=de._svgFactory.createElement("use");u.append(p),p.setAttribute("href",`#${o}`),p.setAttribute("stroke","none"),p.setAttribute("fill","black"),p.setAttribute("fill-rule","nonzero"),p.classList.add("mask")}const c=de._svgFactory.createElement("use");n.append(c),c.setAttribute("href",`#${o}`),l&&c.setAttribute("mask",`url(#${l})`);const d=c.cloneNode();return n.append(d),c.classList.add("mainOutline"),d.classList.add("secondaryOutline"),this.updateProperties(n,e),a(this,ze).set(s,n),s}finalizeDraw(e,t){a(this,_a).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var l;if(!t)return;const{root:s,bbox:n,rootClass:i,path:r}=t,o=typeof e=="number"?a(this,ze).get(e):e;if(o){if(s&&w(this,In,Gf).call(this,o,s),n&&w(l=de,Xd,dv).call(l,o,n),i){const{classList:c}=o;for(const[d,u]of Object.entries(i))c.toggle(d,u)}if(r){const d=o.firstChild.firstChild;w(this,In,Gf).call(this,d,r)}}}updateParent(e,t){if(t===this)return;const s=a(this,ze).get(e);s&&(a(t,Js).append(s),a(this,ze).delete(e),a(t,ze).set(e,s))}remove(e){a(this,_a).delete(e),a(this,Js)!==null&&(a(this,ze).get(e).remove(),a(this,ze).delete(e))}destroy(){g(this,Js,null);for(const e of a(this,ze).values())e.remove();a(this,ze).clear(),a(this,_a).clear()}};Js=new WeakMap,ze=new WeakMap,_a=new WeakMap,Eh=new WeakMap,Xd=new WeakSet,dv=function(e,[t,s,n,i]){const{style:r}=e;r.top=`${100*s}%`,r.left=`${100*t}%`,r.width=`${100*n}%`,r.height=`${100*i}%`},In=new WeakSet,jf=function(){const e=de._svgFactory.create(1,1,!0);return a(this,Js).append(e),e.setAttribute("aria-hidden",!0),e},uv=function(e,t){const s=de._svgFactory.createElement("clipPath");e.append(s);const n=`clip_${t}`;s.setAttribute("id",n),s.setAttribute("clipPathUnits","objectBoundingBox");const i=de._svgFactory.createElement("use");return s.append(i),i.setAttribute("href",`#${t}`),i.classList.add("clip"),n},Gf=function(e,t){for(const[s,n]of Object.entries(t))n===null?e.removeAttribute(s):e.setAttribute(s,n)},b(de,Xd),b(de,Eh,0);let Uf=de;globalThis._pdfjsTestingUtils={HighlightOutliner:Sf};globalThis.pdfjsLib={AbortException:wr,AnnotationEditorLayer:$f,AnnotationEditorParamsType:Et,AnnotationEditorType:ht,AnnotationEditorUIManager:Ba,AnnotationLayer:vf,AnnotationMode:Pi,AnnotationType:re,build:JS,ColorPicker:Ed,createValidAbsoluteUrl:ng,DOMSVGFactory:xd,DrawLayer:Uf,FeatureTest:De,fetchData:Ch,getDocument:am,getFilenameFromUrl:Vw,getPdfFilenameFromUrl:Uw,getRGB:au,getUuid:ag,getXfaPageViewport:Gw,GlobalWorkerOptions:Tn,ImageKind:Vh,InvalidPDFException:Cu,isDataScheme:ru,isPdfFile:sp,isValidExplicitDest:eS,MathClamp:Xe,noContextMenu:$s,normalizeUnicode:Bw,OPS:Gl,OutputScale:Pn,PasswordResponses:Rw,PDFDataRangeTransport:om,PDFDateString:bd,PDFWorker:Xl,PermissionFlag:Iw,PixelsPerInch:Sr,RenderingCancelledException:ep,ResponseException:yd,setLayerDimensions:Fa,shadow:At,SignatureExtractor:bi,stopEvent:ae,SupportedImageMimeTypes:Iu,TextLayer:zl,TouchManager:wd,updateUrlHash:ig,Util:Z,VerbosityLevel:su,version:KS,XfaLayer:dm};const bE={class:"pdf-viewer"},AE={key:0},wE={key:1,class:"error"},SE={key:3,class:"controls"},EE=["disabled"],TE=["disabled"],xE=tt({__name:"PdfViewer",props:{url:{type:String,required:!0},scale:{type:[Number,String],default:1},pdfjsVersion:{type:String,default:"5.4.149"}},setup(h){const e=h,t=wt(null),s=wt(null),n=wt(1),i=wt(0),r=wt(null),o=typeof e.scale=="string"?parseFloat(e.scale):e.scale;async function l(f){if(!s.value||!t.value){r.value="PDF document or canvas is not available";return}try{const p=await s.value.getPage(f),m=p.getViewport({scale:o}),v=t.value,y=v.getContext("2d");if(!y){r.value="Failed to get 2D context for canvas";return}v.height=m.height,v.width=m.width,await p.render({canvasContext:y,viewport:m}).promise,r.value=null}catch(p){r.value="Error rendering page: "+p.message,console.error("Error in renderPage:",p)}}async function c(){try{if(!e.url){r.value="PDF URL is empty or invalid";return}console.log("Loading PDF from:",e.url),Tn.workerSrc="/pdfjs/pdf.worker.min.mjs",s.value=await am(e.url).promise,i.value=s.value.numPages,n.value=1,r.value=null,await l(n.value)}catch(f){r.value="Error loading PDF: "+f.message,console.error("Error in loadPdf:",f)}}function d(){n.value>=i.value||(n.value++,l(n.value))}function u(){n.value<=1||(n.value--,l(n.value))}return Rn(async()=>{await Yf(),await c()}),Cn(()=>e.url,async(f,p)=>{f!==p&&(s.value&&(s.value.destroy(),s.value=null),await c())}),(f,p)=>(I(),O("div",bE,[!s.value&&!r.value?(I(),O("div",AE,"加载 PDF 中...")):r.value?(I(),O("div",wE,"加载 PDF 失败: "+Tt(r.value),1)):(I(),O("canvas",{key:2,ref_key:"canvasRef",ref:t},null,512)),s.value?(I(),O("div",SE,[N("button",{onClick:u,disabled:n.value<=1},"上一页",8,EE),N("span",null,"第 "+Tt(n.value)+"/"+Tt(i.value)+" 页",1),N("button",{onClick:d,disabled:n.value>=i.value},"下一页",8,TE)])):Y("",!0)]))}}),CE=at(xE,[["__scopeId","data-v-10666ae8"]]),kE={extends:bp,Layout:()=>vp(bp.Layout,null,{"layout-bottom":()=>vp(Cw)}),enhanceApp({app:h}){h.component("PdfViewer",CE)}};export{kE as R,RE as V,WA as c,yt as u};
